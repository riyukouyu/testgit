<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<flowtran id="cpcltn" longname="ChinaPay代扣代收对账、手续费记账" kind="account" package="cn.sunline.ltts.busi.intran.trans" xsi:noNamespaceSchemaLocation="ltts-model.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <description><![CDATA[ChinaPay代扣代收对账、手续费记账交易]]></description>
    <interface package="cn.sunline.ltts.busi.intran.trans.intf">
        <input packMode="true">
            <field id="tranam" type="BaseType.U_TRANAM" required="true" multi="false" array="false" longname="代扣金额" desc="交易金额"/>
            <field id="feeaam" type="BaseType.U_TRANAM" required="true" multi="false" array="false" longname="手续费用"/>
        </input>
        <output asParm="true" packMode="true"/>
        <property packMode="true">
            <field id="crcycd" type="BaseType.U_CRCYCD" required="false" fixed="'CNY'" multi="false" array="false" longname="币种" desc="固定值，人民币"/>
            <field id="cpbsno" type="BaseType.U_BUSINO" required="false" fixed="'CP3001'" multi="false" array="false" longname="CP业务编码" desc="固定值，ChinaPay待清算户"/>
			<field id="febsno" type="BaseType.U_BUSINO" required="false" fixed="'6021'" multi="false" array="false" longname="手续费业务编码" desc="固定值"/>
            <field id="dlbsno" type="BaseType.U_BUSINO" required="false" fixed="'B3002'" multi="false" array="false" longname="备付金业务编码" desc="固定值"/>
            <field id="pfbsno" type="BaseType.U_BUSINO" required="false" fixed="'3001'" multi="false" array="false" longname="手续费清算业务编码" desc="固定值"/>
            <field id="brchno" type="BaseType.U_BRCHNO" required="false" multi="false" array="false" longname="所属部门"/>
            <field id="cptoac" type="BaseType.U_ACCTNO" required="false" multi="false" array="false" longname="CP内部户账号"/>
            <field id="cptocn" type="BaseType.U_ACCTNA" required="false" multi="false" array="false" longname="CP内部户账户名"/>
            <field id="cptosa" type="BaseType.U_CUACNO" required="false" multi="false" array="false" longname="CP内部户子户号"/>
            <field id="dltoac" type="BaseType.U_ACCTNO" required="false" multi="false" array="false" longname="总行备付金内部户账号"/>
            <field id="dltocn" type="BaseType.U_ACCTNA" required="false" multi="false" array="false" longname="总行备付金内部户账户名"/>
            <field id="dltosa" type="BaseType.U_CUACNO" required="false" multi="false" array="false" longname="总行备付金内部户子户号"/>
        </property>
        <printer packMode="false"/>
    </interface>
    <flow>
        <method method="chkTransfBefore" id="chkTransfBefore" longname="交易前检查" desc="交易前检查"/>
        <service serviceName="IoInAccount.IoInAccr" id="ioInAccrUp" test="tranam!=@java.math.BigDecimal@ZERO" longname="chinapay待清算户记账" desc="ChinaPay待清算户记账，代收为入金交易形成，待清算户为借，需平账则需记贷方服务">
            <in_mappings by_interface="true">
                <mapping src="cpbsno" dest="input.busino" desc="业务编码" by_interface="true" on_top="true"/>
                <mapping src="crcycd" dest="input.crcycd" desc="币种" by_interface="true" on_top="true"/>
                <mapping src="tranam" dest="input.tranam" desc="代收金额" by_interface="true" on_top="true"/>
                <mapping src="brchno" dest="input.acbrch" desc="账户机构" by_interface="true" on_top="true"/>
            </in_mappings>
            <out_mappings by_interface="true"/>
        </service>
        <service serviceName="IoInAccount.IoInAcdr" id="ioInAcdrFE" test="feeaam!=@java.math.BigDecimal@ZERO" longname="代理手续费支出账户记账" desc="代理手续费支出账户记账，代收、代付都需手续费，手续费借贷方向为借，则记账为内部户借方服务">
            <in_mappings by_interface="true">
                <mapping src="febsno" dest="input.busino" desc="业务编码" by_interface="true" on_top="true"/>
                <mapping src="crcycd" dest="input.crcycd" desc="币种" by_interface="true" on_top="true"/>
                <mapping src="feeaam" dest="input.tranam" desc="手续费" by_interface="true" on_top="true"/>
                <mapping src="brchno" dest="input.acbrch" desc="账户机构" by_interface="true" on_top="true"/>
            </in_mappings>
            <out_mappings by_interface="true"/>
        </service>
        <service serviceName="IoInAccount.IoInAcdr" id="ioInAcdrDL" test="liquam!=@java.math.BigDecimal@ZERO" longname="上存总行备付金账户记账" desc="上存总行备付金账户记账，代收后，备付金账户需要记账借方服务">
            <in_mappings by_interface="true">
                <mapping src="dlbsno" dest="input.busino" desc="业务编码" by_interface="true" on_top="true"/>
                <mapping src="crcycd" dest="input.crcycd" desc="币种" by_interface="true" on_top="true"/>
                <mapping src="tranam" dest="input.tranam" desc="清算金额" by_interface="true" on_top="true"/>
                <mapping src="brchno" dest="input.acbrch" desc="账户机构" by_interface="true" on_top="true"/>
            </in_mappings>
            <out_mappings by_interface="true"/>
        </service>
        <service serviceName="IoInAccount.IoInAccr" id="ioInAccrFE" test="liquam!=@java.math.BigDecimal@ZERO" longname="手续费清算记账" desc="手续费清算记账">
            <in_mappings by_interface="true">
                <mapping src="pfbsno" dest="input.busino" desc="业务编码" by_interface="true" on_top="true"/>
                <mapping src="crcycd" dest="input.crcycd" desc="币种" by_interface="true" on_top="true"/>
                <mapping src="feeaam" dest="input.tranam" desc="清算金额" by_interface="true" on_top="true"/>
                <mapping src="brchno" dest="input.acbrch" desc="账户机构" by_interface="true" on_top="true"/>
            </in_mappings>
            <out_mappings by_interface="true"/>
        </service>
        <method method="CheckTransfAfter" id="checkTransfAfter" longname="交易后处理" desc="交易后处理"/>
    </flow>
</flowtran>
