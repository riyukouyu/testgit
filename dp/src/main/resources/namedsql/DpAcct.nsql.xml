<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<sqls xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="DpAcct" longname="存款负债账户查询" package="cn.sunline.ltts.busi.dp.namedsql" xsi:noNamespaceSchemaLocation="ltts-model.xsd">
    <description><![CDATA[存款负债账户查询]]></description>
    <select cache="none" method="selectOne" type="sql" id="selCurrAcctBlncByCustac" longname="根据电子账号查询活期账户余额">
        <sql type="oracle"><![CDATA[select sum(onlnbl) total from kna_acct where custac = #custac#]]></sql>
        <sql type="mysql"><![CDATA[select sum(onlnbl) total from kna_acct where custac = #custac#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CHAR35" mode="in" longname="电子账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.util.Map">
            <result property="total" javaType="BaseType.U_TRANAM" jdbcType="NUMERIC" column="onlnbl" longname="活期账户总计余额"/>
        </resultMap>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selCurrAcctBlncByEcctCrcycd" longname="电子账号币种查询活期账户余额">
        <sql type="oracle"><![CDATA[select sum(onlnbl) total from kna_acct where custac = #custac# and  crcycd=#crcycd#]]></sql>
        <sql type="mysql"><![CDATA[select sum(onlnbl) total from kna_acct where custac = #custac# and  crcycd=#crcycd#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CHAR35" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="crcycd" jdbcType="VARCHAR" javaType="BaseType.U_CRCYCD" mode="in" longname="基础货币代码" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.math.BigDecimal">
            <result property="total" javaType="BaseType.U_TRANAM" jdbcType="NUMERIC" column="onlnbl" longname="活期账户总计余额"/>
        </resultMap>
    </select>
    <update method="update" id="updKnaAcctAcctstByCustac" longname="根据电子账号更新活期账户状态">
        <sql type="oracle"><![CDATA[update kna_acct set acctst = #acctst#,closdt = #closdt#,clossq = #clossq#,tmstmp=#tmstmp# 
where custac = #custac# and ACCTST <> '2' ]]></sql>
        <sql type="mysql"><![CDATA[update kna_acct set acctst = #acctst#,closdt = #closdt#,clossq = #clossq#,tmstmp=#tmstmp# 
where custac = #custac# and ACCTST <> '2' ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="acctst" jdbcType="VARCHAR" javaType="BaseEnumType.E_DPACST" mode="in" longname="子户状态" parameterType="condition"/>
            <parameter property="closdt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="销户日期" parameterType="condition"/>
            <parameter property="clossq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="销户流水" parameterType="condition"/>
            <parameter property="tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <update method="update" id="updKnaFxacAcctstByCustac" longname="根据电子账号更新定期账户状态">
        <sql type="oracle"><![CDATA[update kna_fxac set acctst = #acctst#,closdt = #closdt#,clossq = #closdt#,tmstmp=#tmstmp# 
where custac = #custac# and ACCTST <> '2' ]]></sql>
        <sql type="mysql"><![CDATA[update kna_fxac set acctst = #acctst#,closdt = #closdt#,clossq = #closdt#,tmstmp=#tmstmp# 
where custac = #custac# and ACCTST <> '2' ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="acctst" jdbcType="VARCHAR" javaType="BaseEnumType.E_DPACST" mode="in" longname="子户状态" parameterType="condition"/>
            <parameter property="closdt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="销户日期" parameterType="condition"/>
            <parameter property="clossq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="销户流水" parameterType="condition"/>
            <parameter property="tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <update method="update" id="updKnaAcctAcctstByCustacStrik" longname="根据电子账号更新活期账户状态">
        <sql type="oracle"><![CDATA[update kna_acct set acctst = #acctst#,closdt = '',clossq = '',tmstmp=#tmstmp# 
where custac = #custac# and closdt = #closdt# and clossq = #clossq#]]></sql>
        <sql type="mysql"><![CDATA[update kna_acct set acctst = #acctst#,closdt = '',clossq = '',tmstmp=#tmstmp# 
where custac = #custac# and closdt = #closdt# and clossq = #clossq#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="acctst" jdbcType="VARCHAR" javaType="BaseEnumType.E_DPACST" mode="in" longname="子户状态" parameterType="condition"/>
            <parameter property="closdt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="销户日期" parameterType="condition"/>
            <parameter property="clossq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="销户流水" parameterType="condition"/>
            <parameter property="tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <update method="update" id="updKnaFxacAcctstByCustacStrik" longname="根据电子账号更新定期账户状态">
        <sql type="oracle"><![CDATA[update kna_fxac set acctst = #acctst#,closdt = '',clossq = '',tmstmp=#tmstmp# 
where custac = #custac# and closdt = #closdt# and clossq = #clossq#]]></sql>
        <sql type="mysql"><![CDATA[update kna_fxac set acctst = #acctst#,closdt = '',clossq = '',tmstmp=#tmstmp# 
where custac = #custac# and closdt = #closdt# and clossq = #clossq#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="acctst" jdbcType="VARCHAR" javaType="BaseEnumType.E_DPACST" mode="in" longname="子户状态" parameterType="condition"/>
            <parameter property="closdt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="销户日期" parameterType="condition"/>
            <parameter property="clossq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="销户流水" parameterType="condition"/>
            <parameter property="tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <update method="update" id="updKnaCacdAcctstByCustac" longname="根据电子账号更新电子账户与负债账户关联状态">
        <sql type="oracle"><![CDATA[update kna_cacd set status= #acctst#,tmstmp=#tmstmp# where custac = #custac#]]></sql>
        <sql type="mysql"><![CDATA[update kna_cacd set status= #acctst#,tmstmp=#tmstmp# where custac = #custac#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="acctst" jdbcType="VARCHAR" javaType="BaseEnumType.E_DPACST" mode="in" longname="状态" parameterType="condition"/>
            <parameter property="tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <update method="update" id="updKnaCacdAcctstByClossq" longname="根据销户流水更新电子账户与负债账户关联状态">
        <sql type="oracle"><![CDATA[update kna_cacd a set a.status= #acctst#, a., a.tmstmp=#tmstmp# 
where EXISTS
(select 1 from knb_cacq where a.CUSTAC = knb_cacq.CUSTAC and a.CARDNO = knb_cacq.ODOPAC 
and KNB_CACQ.CLOSSQ=#clossq#)
]]></sql>
        <sql type="mysql"><![CDATA[update kna_cacd a set a.status= #acctst#, a., a.tmstmp=#tmstmp# 
where EXISTS
(select 1 from knb_cacq where a.CUSTAC = knb_cacq.CUSTAC and a.CARDNO = knb_cacq.ODOPAC 
and KNB_CACQ.CLOSSQ=#clossq#)
]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="clossq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="销户流水" parameterType="condition"/>
            <parameter property="acctst" jdbcType="VARCHAR" javaType="BaseEnumType.E_DPACST" mode="in" longname="状态" parameterType="condition"/>
            <parameter property="tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <update method="update" id="updKnaAcdcAcctstByCustac" longname="根据电子账号更新卡帐关联状态">
        <sql type="oracle"><![CDATA[update kna_acdc set status = #status#,tmstmp=#tmstmp# where custac = #custac#]]></sql>
        <sql type="mysql"><![CDATA[update kna_acdc set status = #status#,tmstmp=#tmstmp# where custac = #custac#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="status" jdbcType="VARCHAR" javaType="BaseEnumType.E_DPACST" mode="in" longname="状态" parameterType="condition"/>
            <parameter property="tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <select cache="none" method="selectAll" type="sql" id="selKnaFxacDetlByAcctDesc" longname="按照后进先出规则查询明细">
        <sql type="mysql"><![CDATA[
    	select
    	    	* 
    	from
    	    	kna_fxac_detl 
    	where
    	    	acctno = #acctno# and acctst = '1' 
    	order by
    	    	opendt desc
    	]]></sql>
        <sql type="oracle"><![CDATA[
    	select
    	    	* 
    	from
    	    	kna_fxac_detl 
    	where
    	    	acctno = #acctno# and acctst = '1' 
    	order by
    	    	opendt desc
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" jdbcType="VARCHAR" javaType="string" mode="in" longname="负债账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDepoBusiMain.KnaFxacDetl"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selOnlnByAcctno" longname="根据负债账号取联机余额">
        <sql type="oracle"><![CDATA[select * from kna_acct where acctno=#acctno#]]></sql>
        <sql type="mysql"><![CDATA[select * from kna_acct where acctno=#acctno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" ref="DpDict.Acct.acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="负债账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDepoBusiMain.KnaAcct"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selFdaFundByCustac" longname="根据电子账号查询基金账户信息">
        <sql type="oracle"><![CDATA[select a.acctno from fda_fund a,kna_accs b
where a.acctno = b.acctno and b.prodtp = '1'
and b.custac = #custac# and a.acctst = #acctst#]]></sql>
        <sql type="mysql"><![CDATA[select a.acctno from fda_fund a,kna_accs b
where a.acctno = b.acctno and b.prodtp = '1'
and b.custac = #custac# and a.acctst = #acctst#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="acctst" jdbcType="VARCHAR" javaType="BaseEnumType.E_ACCTST" mode="in" longname="账户状态" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.lang.String">
            <result property="acctno" javaType="BaseType.U_ACCTNO" jdbcType="VARCHAR" column="acctno" longname="基金内部账号"/>
        </resultMap>
    </select>
    <update method="update" id="updFdaFundAcctstByCustac" longname="根据电子账号更新基金账户状态">
        <sql type="oracle"><![CDATA[update fda_fund a set a.acctst = #acctst#,a.tmstmp=#tmstmp#
where exists (select 1
from kna_accs b,fda_acct c
where a.acctno = b.acctno and c.ecctno = b.custac and b.prodtp = '1'
and b.custac = #custac#)]]></sql>
        <sql type="mysql"><![CDATA[update fda_fund a set a.acctst = #acctst#,a.tmstmp=#tmstmp#
where exists (select 1
from kna_accs b,fda_acct c
where a.acctno = b.acctno and c.ecctno = b.custac and b.prodtp = '1'
and b.custac = #custac#)]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="acctst" jdbcType="VARCHAR" javaType="BaseEnumType.E_ACCTST" mode="in" longname="账户状态" parameterType="condition"/>
            <parameter property="tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <select cache="none" method="selectOne" type="sql" id="selFdaFundOnlnblByAcctno" longname="根据账号查询基金账户份额">
        <sql type="oracle"><![CDATA[select onlnbl,frozbl from fda_fund where acctno = #acctno# and acctst = #acctst#]]></sql>
        <sql type="mysql"><![CDATA[select onlnbl,frozbl from fda_fund where acctno = #acctno# and acctst = #acctst#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="基金账号" parameterType="condition"/>
            <parameter property="acctst" jdbcType="VARCHAR" javaType="BaseEnumType.E_ACCTST" mode="in" longname="账户状态" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpAcctType.FundAcctOnlnbl"/>
    </select>
    <update method="update" id="updKnaAccsAcctstByCustac" longname="根据电子账号更新电子账号与子账户关联状态">
        <sql type="oracle"><![CDATA[update kna_accs set acctst = #acctst#, tmstmp=#tmstmp# where custac = #custac#]]></sql>
        <sql type="mysql"><![CDATA[update kna_accs set acctst = #acctst#, tmstmp=#tmstmp# where custac = #custac#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="acctst" jdbcType="VARCHAR" javaType="BaseEnumType.E_DPACST" mode="in" longname="账户状态" parameterType="condition"/>
            <parameter property="tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <select cache="none" method="selectAll" type="sql" id="selKnaAcct" longname="查询活期存款主信息">
        <sql type="oracle"><![CDATA[SELECT * FROM Kna_Acct ORDER BY Acctno]]></sql>
        <sql type="oracle"><![CDATA[SELECT * FROM kna_acct ORDER BY Acctno]]></sql>
        <sql type="mysql"><![CDATA[SELECT * FROM Kna_Acct ORDER BY Acctno]]></sql>
        <parameterMap class="java.util.Map"/>
        <resultMap class="DpDepoBusiMain.KnaAcct"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selKnaAcctByOpendt" longname="根据开户日期查询活期存款主信息">
        <sql type="oracle"><![CDATA[ SELECT * FROM kna_acct WHERE Opendt = #opendt# ORDER BY Acctno]]></sql>
        <sql type="oracle"><![CDATA[ SELECT * FROM kna_acct WHERE Opendt = #opendt# ORDER BY Acctno]]></sql>
        <sql type="mysql"><![CDATA[ SELECT * FROM kna_acct WHERE Opendt = #opendt# ORDER BY Acctno]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="opendt" jdbcType="VARCHAR" javaType="string" mode="in" longname="opendt" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDepoBusiMain.KnaAcct"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selKnaFxac" longname="查询定期存款主信息">
        <sql type="oracle"><![CDATA[SELECT * FROM kna_fxac ORDER BY Acctno]]></sql>
        <sql type="oracle"><![CDATA[SELECT * FROM kna_fxac ORDER BY Acctno]]></sql>
        <sql type="mysql"><![CDATA[SELECT * FROM kna_fxac ORDER BY Acctno]]></sql>
        <parameterMap class="java.util.Map"/>
        <resultMap class="DpDepoBusiMain.KnaFxac"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selKnaFxacByOpendt" longname="根据开户日期查询定期存款主信息">
        <sql type="oracle"><![CDATA[ SELECT * FROM kna_fxac WHERE Opendt = #opendt# ORDER BY Acctno]]></sql>
        <sql type="mysql"><![CDATA[ SELECT * FROM kna_fxac WHERE Opendt = #opendt# ORDER BY Acctno]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="opendt" jdbcType="VARCHAR" javaType="string" mode="in" longname="opendt" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDepoBusiMain.KnaFxac"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selKnlBill" longname="查询所有账户余额发生明细">
        <sql type="oracle"><![CDATA[SELECT * FROM h_knl_bill ORDER BY Detlsq]]></sql>
        <sql type="oracle"><![CDATA[SELECT * FROM h_knl_bill ORDER BY Detlsq]]></sql>
        <sql type="mysql"><![CDATA[SELECT * FROM h_knl_bill ORDER BY Detlsq]]></sql>
        <parameterMap class="java.util.Map"/>
        <resultMap class="DpDepoBusiMain.KnlBill"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selKnlBillByDateForYitong" longname="根据日期查询所有账户余额发生明细">
        <sql type="oracle"><![CDATA[SELECT * FROM h_knl_bill WHERE Trandt > #startDate# and Trandt <= #datetm# and ussqno is not null ORDER BY Detlsq]]></sql>
        <sql type="oracle"><![CDATA[SELECT * FROM h_knl_bill WHERE Trandt > #startDate# and Trandt <= #datetm# and ussqno is not null ORDER BY Detlsq]]></sql>
        <sql type="mysql"><![CDATA[SELECT * FROM h_knl_bill WHERE Trandt > #startDate# and Trandt <= #datetm# and ussqno is not null ORDER BY Detlsq]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="startDate" jdbcType="VARCHAR" javaType="string" mode="in" longname="起始日期" parameterType="condition"/>
            <parameter property="datetm" jdbcType="VARCHAR" javaType="string" mode="in" longname="datetm" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDepoBusiMain.KnlBill"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selKnlBillByDate" longname="根据日期查询所有账户余额发生明细">
        <sql type="oracle"><![CDATA[SELECT * FROM h_knl_bill WHERE Trandt = #datetm#  ORDER BY Detlsq]]></sql>
        <sql type="oracle"><![CDATA[SELECT * FROM h_knl_bill WHERE Trandt = #datetm#  ORDER BY Detlsq]]></sql>
        <sql type="mysql"><![CDATA[SELECT * FROM h_knl_bill WHERE Trandt = #datetm#  ORDER BY Detlsq]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="datetm" jdbcType="VARCHAR" javaType="string" mode="in" longname="datetm" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDepoBusiMain.KnlBill"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selCbdlInfo" longname="查询负债账号计提明细">
        <sql type="oracle"><![CDATA[select * from knb_cbdl]]></sql>
        <sql type="mysql"><![CDATA[select * from knb_cbdl]]></sql>
        <parameterMap class="java.util.Map"/>
        <resultMap class="DpDepoInst.KnbCbdl"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selAcinInfo" longname="查询负债账户计息信息">
        <sql type="oracle"><![CDATA[select * from knb_acin]]></sql>
        <sql type="mysql"><![CDATA[select * from knb_acin]]></sql>
        <parameterMap class="java.util.Map"/>
        <resultMap class="DpDepoInst.KnbAcin"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnsAcsqCountByCuacno" longname="按账号查询会计记账流水总数">
        <sql type="oracle"><![CDATA[select count(*) as cnt
from kns_acsq a,kns_tran b,kapp_jioyxx c
where a.mntrsq = b.zjyilush and b.jiaoyima = c.jiaoyima
and a.trandt >= #bgindt# and a.trandt <= #endddt# and a.cuacno = #cuacno#]]></sql>
        <sql type="mysql"><![CDATA[select count(*) as cnt
from kns_acsq a,kns_tran b,kapp_jioyxx c
where a.mntrsq = b.zjyilush and b.jiaoyima = c.jiaoyima
and a.trandt >= #bgindt# and a.trandt <= #endddt# and a.cuacno = #cuacno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="bgindt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="起始交易日期" parameterType="condition"/>
            <parameter property="endddt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="终止交易日期" parameterType="condition"/>
            <parameter property="cuacno" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="记账账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="int"/>
    </select>
    <select cache="none" method="selectPage" type="sql" id="selKnsAcsqInfosByCuacno" longname="按记账账号查询会计记账流水信息">
        <sql type="oracle"><![CDATA[select a.trandt,a.mntrsq,c.prcscd as prcscd,c.tranna as prcsna,a.cuacno as acctno ,a.crcycd,a.amntcd,a.tranam
from kns_acsq a,kns_tran b,knp_txns c
where a.mntrsq = b.mntrsq and b.prcscd = c.prcscd
and a.trandt >= #bgindt# and a.trandt <= #endddt# and a.cuacno = #cuacno#]]></sql>
        <sql type="mysql"><![CDATA[select a.trandt,a.mntrsq,c.prcscd as prcscd,c.tranna as prcsna,a.cuacno as acctno ,a.crcycd,a.amntcd,a.tranam
from kns_acsq a,kns_tran b,knp_txns c
where a.mntrsq = b.mntrsq and b.prcscd = c.prcscd
and a.trandt >= #bgindt# and a.trandt <= #endddt# and a.cuacno = #cuacno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="bgindt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="起始交易日期" parameterType="condition"/>
            <parameter property="endddt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="终止交易日期" parameterType="condition"/>
            <parameter property="cuacno" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="记账账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoAccountComplexType.IoKnsAcsqInfo"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selPidlInfo" longname="查询负债账户付息明细">
        <sql type="oracle"><![CDATA[select * from knb_pidl]]></sql>
        <sql type="mysql"><![CDATA[select * from knb_pidl]]></sql>
        <parameterMap class="java.util.Map"/>
        <resultMap class="DpDepoInst.KnbPidl"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selAcinInrtInfo" longname="查询存款执行利率信息">
        <sql type="oracle"><![CDATA[select a.acctno,a.crcycd,a.prodcd,i.cuusin
from  kna_acct a, kub_inrt i
where
      a.acctno = i.acctno]]></sql>
        <sql type="mysql"><![CDATA[select a.acctno,a.crcycd,a.prodcd,i.cuusin
from  kna_acct a, kub_inrt i
where
      a.acctno = i.acctno]]></sql>
        <parameterMap class="java.util.Map"/>
        <resultMap class="DpProdSvc.selAcinInrtOut"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selRfirInfo" longname="查询基准利率信息">
        <sql type="oracle"><![CDATA[select * from kup_rfir]]></sql>
        <sql type="mysql"><![CDATA[select * from kup_rfir]]></sql>
        <parameterMap class="java.util.Map"/>
        <resultMap class="IoIntrComplexType.KupRfirInfo"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selDppbInfo" longname="查询产品基础属性">
        <sql type="oracle"><![CDATA[SELECT * FROM kup_dppb ORDER BY Prodcd]]></sql>
        <sql type="mysql"><![CDATA[SELECT * FROM kup_dppb ORDER BY Prodcd]]></sql>
        <parameterMap class="java.util.Map"/>
        <resultMap class="DpProduct.KupDppb"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selHKnaAcctByUpldt" longname="查询负债账户增量信息">
        <sql type="oracle"><![CDATA[SELECT a.acctno,a.onlnbl,a.acctdt,a.opendt
  FROM h_kna_acct a
  FROM h_kna_acct a
 WHERE a.Acctdt = #acctdt#
   AND a.Upbldt = a.Acctdt
UNION ALL
SELECT b.acctno,b.onlnbl,b.acctdt,b.opendt
  FROM h_Kna_fxac b
  FROM h_kna_fxac b
 WHERE b.Acctdt = #acctdt#
   AND b.Upbldt = b.Acctdt order by Acctdt, Acctno]]></sql>
        <sql type="mysql"><![CDATA[SELECT a.acctno,a.onlnbl,a.acctdt,a.opendt
  FROM h_kna_acct a
  FROM h_kna_acct a
 WHERE a.Acctdt = #acctdt#
   AND a.Upbldt = a.Acctdt
UNION ALL
SELECT b.acctno,b.onlnbl,b.acctdt,b.opendt
  FROM h_Kna_fxac b
  FROM h_kna_fxac b
 WHERE b.Acctdt = #acctdt#
   AND b.Upbldt = b.Acctdt order by Acctdt, Acctno]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctdt" jdbcType="VARCHAR" javaType="string" mode="in" longname="acctdt" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpHisDepo.HKnaAcct"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selHKnaAcct" longname="查询负债账户所有信息">
        <sql type="oracle"><![CDATA[SELECT a.acctno,(CASE WHEN a.upbldt <= #acctdt# THEN a.onlnbl ELSE a.lastbl end) onlnbl,a.acctdt,a.opendt
  FROM h_kna_acct a
  FROM h_kna_acct a
 WHERE a.Acctdt = #acctdt#
UNION ALL
SELECT b.acctno,(CASE WHEN b.Upbldt <= #acctdt# THEN b.Onlnbl ELSE b.Lastbl END) onlnbl,b.acctdt,b.opendt
  FROM h_Kna_fxac b
  FROM h_kna_fxac b
 WHERE b.Acctdt =  #acctdt#
  order by Acctdt, Acctno]]></sql>
        <sql type="mysql"><![CDATA[SELECT a.acctno,(CASE WHEN a.upbldt <= #acctdt# THEN a.onlnbl ELSE a.lastbl end) onlnbl,a.acctdt,a.opendt
  FROM h_kna_acct a
  FROM h_kna_acct a
 WHERE a.Acctdt = #acctdt#
UNION ALL
SELECT b.acctno,(CASE WHEN b.Upbldt <= #acctdt# THEN b.Onlnbl ELSE b.Lastbl END) onlnbl,b.acctdt,b.opendt
  FROM h_Kna_fxac b
  FROM h_kna_fxac b
 WHERE b.Acctdt =  #acctdt#
  order by Acctdt, Acctno]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctdt" jdbcType="VARCHAR" javaType="string" mode="in" longname="acctdt" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpHisDepo.HKnaAcct"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selHFxacInfo" longname="查询负债定期账户信息">
        <sql type="oracle"><![CDATA[select * from h_kna_fxac]]></sql>
        <sql type="mysql"><![CDATA[select * from h_kna_fxac]]></sql>
        <parameterMap class="java.util.Map"/>
        <resultMap class="DpHisDepo.HKnaFxac"/>
    </select>
    <insert id="insAcctToKnbEpcb" longname="插入活期计提信息到临时表">
        <sql type="oracle"><![CDATA[insert into knb_epcb(corpno,custac,acctno,indxno,cabrdt,crcycd,onlnbl,cabrin,matudt ,remark,intrvl,pddpfg,tmstmp)
select a.corpno,a.custac,b.acctno,1,c.cabrdt,b.crcycd,b.onlnbl,nvl(c.cabrin,0),'20991231' ,'0' as remark,c.intrvl,'0',#tmstmp#
from kna_accs a join kna_acct b on (a.acctno = b.acctno)
left join knb_cbdl c on (a.acctno = c.acctno and c.cabrdt = #cabrdt#)
where a.custac = #custac#  and a.fcflag = '0']]></sql>
        <sql type="mysql"><![CDATA[insert into knb_epcb(corpno,custac,acctno,indxno,cabrdt,crcycd,onlnbl,cabrin,matudt ,remark,intrvl,pddpfg,tmstmp)
select a.corpno,a.custac,b.acctno,1,c.cabrdt,b.crcycd,b.onlnbl,ifnull(c.cabrin,0),'20991231' ,'0' as remark,c.intrvl,'0',#tmstmp#
from kna_accs a join kna_acct b on (a.acctno = b.acctno)
left join knb_cbdl c on (a.acctno = c.acctno and c.cabrdt = #cabrdt#)
where a.custac = #custac#  and a.fcflag = '0']]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="cabrdt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="计提日期" parameterType="condition"/>
            <parameter property="tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </insert>
    <insert id="insFxacDetlToKnbEpcd" longname="插入智能储蓄未支取计提信息到临时表">
        <sql type="oracle"><![CDATA[insert into knb_epcb(corpno,custac,acctno,indxno,cabrdt,crcycd,onlnbl,cabrin,matudt ,remark,intrvl,pddpfg,issave,bgindt,tmstmp)
select a.corpno,a.custac,b.acctno,b.indxno,b.cabrdt,b.crcycd,d.onlnbl,b.cabrin,d.matudt,b.remark,b.intrvl,'1','1',d.bgindt,#tmstmp#
from kna_accs a join knb_cbdp b on (a.acctno = b.acctno)
join kna_fxac_detl d on (b.acctno = d.acctno and b.indxno = d.detlsq)
where a.custac = #custac# and b.cabrdt = #cabrdt# and a.fcflag = '1']]></sql>
        <sql type="mysql"><![CDATA[insert into knb_epcb(corpno,custac,acctno,indxno,cabrdt,crcycd,onlnbl,cabrin,matudt ,remark,intrvl,pddpfg,issave,bgindt,tmstmp)
select a.corpno,a.custac,b.acctno,b.indxno,b.cabrdt,b.crcycd,d.onlnbl,b.cabrin,d.matudt,b.remark,b.intrvl,'1','1',d.bgindt,#tmstmp#
from kna_accs a join knb_cbdp b on (a.acctno = b.acctno)
join kna_fxac_detl d on (b.acctno = d.acctno and b.indxno = d.detlsq)
where a.custac = #custac# and b.cabrdt = #cabrdt# and a.fcflag = '1']]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账户" parameterType="condition"/>
            <parameter property="cabrdt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="计提日期" parameterType="condition"/>
            <parameter property="tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </insert>
    <insert id="insFxacDrdlToKnbEpcd" longname="插入智能储蓄支取计提信息到临时表">
        <sql type="oracle"><![CDATA[insert into knb_epcb(corpno,custac,acctno,indxno,crcycd,onlnbl,cabrin,matudt ,remark,intrvl,pddpfg,issave,bgindt,tmstmp)
select a.corpno,a.custac,b.acctno,b.detlsq,b.crcycd,0,b.intram,edindt,b.remark,b.cuusin,'1','0',b.bgindt,#tmstmp#
from kna_accs a join kna_fxac_drdl b on (a.acctno = b.acctno)
where a.custac = #custac# and b.transt = '1']]></sql>
        <sql type="mysql"><![CDATA[insert into knb_epcb(corpno,custac,acctno,indxno,crcycd,onlnbl,cabrin,matudt ,remark,intrvl,pddpfg,issave,bgindt,tmstmp)
select a.corpno,a.custac,b.acctno,b.detlsq,b.crcycd,0,b.intram,edindt,b.remark,b.cuusin,'1','0',b.bgindt,#tmstmp#
from kna_accs a join kna_fxac_drdl b on (a.acctno = b.acctno)
where a.custac = #custac# and b.transt = '1']]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </insert>
    <select cache="none" method="selectAll" type="sql" id="selKnbEpcb" longname="查询智能储蓄预期收益表">
        <sql type="oracle"><![CDATA[select remark,sum(onlnbl) as acblam,sum(cabrin) as cabrin 
from knb_epcb where custac = #custac# 
group by remark
order by cast(remark as signed)]]></sql>
        <sql type="mysql"><![CDATA[select remark,sum(onlnbl) as acblam,sum(cabrin) as cabrin 
from knb_epcb where custac = #custac# 
group by remark
order by cast(remark as signed)]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpProdSvc.AcctCabrInfo"/>
    </select>
    <delete method="delete" id="delKnbEpcb" longname="清除智能储蓄预期收益表">
        <sql type="oracle"><![CDATA[delete from knb_epcb where custac = #custac#]]></sql>
        <sql type="mysql"><![CDATA[delete from knb_epcb where custac = #custac#]]></sql>
        <parameterMap class="string">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
        </parameterMap>
    </delete>
    <select cache="none" method="selectOne" type="sql" id="selTotalCabrByCustac" longname="查询预期收益总额">
        <sql type="oracle"><![CDATA[select sum(cabrin) as cabrin 
from knb_epcb where custac = #custac#]]></sql>
        <sql type="mysql"><![CDATA[select sum(cabrin) as cabrin 
from knb_epcb where custac = #custac#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.math.BigDecimal"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selChinaPayCnt" longname="统计Chinapay对账明细记录">
        <sql type="oracle"><![CDATA[select count(*) 
from knl_iobl 
where fromtp = '1' 
and keepdt=#bftrndt#]]></sql>
        <sql type="mysql"><![CDATA[select count(*) 
from knl_iobl 
where fromtp = '1' 
and keepdt=#bftrndt#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="bftrndt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="上次交易日期" parameterType="condition"/>
        </parameterMap>
        <resultMap class="int"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selChinaPay" longname="查询Chinapay对账明细记录">
        <sql type="oracle"><![CDATA[select servsq, servdt, fromtp, cardno, tranam, crcycd, cuacno, ioflag, prcscd, transq, trandt, trantm, status, remark, corpno, datetm, tmstmp 
from knl_iobl 
where 
fromtp = '1' 
and keepdt=#bftrndt#
order by servsq]]></sql>
        <sql type="mysql"><![CDATA[select servsq, servdt, fromtp, cardno, tranam, crcycd, cuacno, ioflag, prcscd, transq, trandt, trantm, status, remark, corpno, datetm, tmstmp 
from knl_iobl 
where 
fromtp = '1' 
and keepdt=#bftrndt#
order by servsq]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="bftrndt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="上次交易日期" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDepoBusiMain.KnlIobl"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selUnionPayCnt" longname="统计银联对账明细记录">
        <sql type="oracle"><![CDATA[select count(1) from knl_iobl where keepdt= #trandt# and fromtp = '0'   and prcscd  in ('sealou','sealin') 

]]></sql>
        <sql type="mysql"><![CDATA[select count(1) from knl_iobl where keepdt= #trandt# and fromtp = '0'   and prcscd  in ('sealou','sealin') 

]]></sql>
        <parameterMap class="string">
            <parameter property="trandt" jdbcType="VARCHAR" javaType="string" mode="in" longname="交易日期" parameterType="condition"/>
        </parameterMap>
        <resultMap class="int"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selUnionPay" longname="查询银联对账明细记录">
        <sql type="oracle"><![CDATA[select servsq, servdt, fromtp, cardno, tranam, crcycd, cuacno, ioflag, prcscd, transq, trandt, trantm, status, remark, corpno, datetm, tmstmp 
from knl_iobl where keepdt= #trandt# and fromtp = '0' and prcscd  in ('sealou','sealin') order by servsq]]></sql>
        <sql type="mysql"><![CDATA[select servsq, servdt, fromtp, cardno, tranam, crcycd, cuacno, ioflag, prcscd, transq, trandt, trantm, status, remark, corpno, datetm, tmstmp 
from knl_iobl where keepdt= #trandt# and fromtp = '0' and prcscd  in ('sealou','sealin') order by servsq]]></sql>
        <parameterMap class="string">
            <parameter property="trandt" jdbcType="VARCHAR" javaType="string" mode="in" longname="交易日期" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDepoBusiMain.KnlIobl"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selAcctCabrByCabrdt" longname="根据计提日期查询电子账户计提信息">
        <sql type="oracle"><![CDATA[select a.custac,c.cabrdt,sum(c.cabrin) as cabrin
from kna_accs a join knb_cbdl c on (a.acctno = c.acctno)
where a.custac = #custac# and a.fcflag in ('0','1')
and c.cabrdt >= #bigndt# and c.cabrdt <= #endddt#
group by a.custac,c.cabrdt]]></sql>
        <sql type="mysql"><![CDATA[select a.custac,c.cabrdt,sum(c.cabrin) as cabrin
from kna_accs a join knb_cbdl c on (a.acctno = c.acctno)
where a.custac = #custac# and a.fcflag in ('0','1')
and c.cabrdt >= #bigndt# and c.cabrdt <= #endddt#
group by a.custac,c.cabrdt]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="bigndt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="起始日期" parameterType="condition"/>
            <parameter property="endddt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="结束日期" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpProdSvc.AcctCabrForCabrdt"/>
    </select>
    <insert id="insAcctCabrToCain" longname="插入计提利息到临时表">
        <sql type="oracle"><![CDATA[insert into knb_cbin(corpno,custac,cabrdt,cabrin,lscbin,prcbin,tmstmp)
select a.corpno,a.custac,c.cabrdt,sum(c.cabrin) as cabrin,0,0,#tmstmp#
from kna_accs a join knb_cbdl c on (a.acctno = c.acctno)
where a.custac = #custac# and a.fcflag in ('0','1')
and c.cabrdt >= #bigndt# and c.cabrdt <= #endddt#
group by a.corpno,a.custac,c.cabrdt
]]></sql>
        <sql type="mysql"><![CDATA[insert into knb_cbin(corpno,custac,cabrdt,cabrin,lscbin,prcbin,tmstmp)
select a.corpno,a.custac,c.cabrdt,sum(c.cabrin) as cabrin,0,0,#tmstmp#
from kna_accs a join knb_cbdl c on (a.acctno = c.acctno)
where a.custac = #custac# and a.fcflag in ('0','1')
and c.cabrdt >= #bigndt# and c.cabrdt <= #endddt#
group by a.corpno,a.custac,c.cabrdt
]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="bigndt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="起始日期" parameterType="condition"/>
            <parameter property="endddt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="结束日期" parameterType="condition"/>
            <parameter property="tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </insert>
    <delete method="delete" id="delCainCabrinByCustac" longname="根据电子账号删除计提信息">
        <sql type="oracle"><![CDATA[delete from knb_cbin where custac = #custac#]]></sql>
        <sql type="mysql"><![CDATA[delete from knb_cbin where custac = #custac#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
        </parameterMap>
    </delete>
    <update method="update" id="updKnbCbinPrcbin" longname="更新计提信息临时表每日收益">
        <sql type="oracle"><![CDATA[update knb_cbin set prcbin = cabrin - lscbin ,tmstmp=#tmstmp# where custac = #custac#]]></sql>
        <sql type="mysql"><![CDATA[update knb_cbin set prcbin = cabrin - lscbin ,tmstmp=#tmstmp# where custac = #custac#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <select cache="none" method="selectAll" type="sql" id="selKnbCbinByCustac" longname="根据电子账号查询计提信息临时表">
        <sql type="oracle"><![CDATA[select cabrdt,case when prcbin < 0 then cabrin else prcbin end as  cabrin 
from knb_cbin where custac = #custac#
and cabrdt >= #bigndt# and cabrdt <= #endddt#]]></sql>
        <sql type="mysql"><![CDATA[select cabrdt,case when prcbin < 0 then cabrin else prcbin end as  cabrin 
from knb_cbin where custac = #custac#
and cabrdt >= #bigndt# and cabrdt <= #endddt#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="bigndt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="起始日期" parameterType="condition"/>
            <parameter property="endddt" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="结束日期" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpProdSvc.AcctPredCabrInfo"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selCustacAcctstByAll" longname="查询电子帐号和账号状态">
        <sql type="oracle"><![CDATA[SELECT custac,acctst FROM kna_cust]]></sql>
        <sql type="mysql"><![CDATA[SELECT custac,acctst FROM kna_cust]]></sql>
        <parameterMap class="java.util.Map"/>
        <resultMap class="IoCaTable.IoCaKnaCust"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selKnbEpcbForFixSave" longname="查询电子账户定期未支取部分计提信息">
        <sql type="oracle"><![CDATA[select * from knb_epcb where custac = #custac# and (pddpfg = '1' and issave = '1' or (pddpfg = '0'))]]></sql>
        <sql type="mysql"><![CDATA[select * from knb_epcb where custac = #custac# and (pddpfg = '1' and issave = '1' or (pddpfg = '0'))]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDepoInst.KnbEpcb"/>
    </select>
    <insert id="insKnbEpcbNxtm" longname="插入智能储蓄预下一档信息">
        <sql type="oracle"><![CDATA[insert into knb_epcb_nxtm(custac,remark,diffdy,intram)
select a.custac,a.remark,a.diffdy,sum(a.onlnbl) as intram 
from knb_epcb a join 
(select custac,remark,min(diffdy) as diffdy from knb_epcb
where custac = #custac# and pddpfg = '1' and issave = '1' and nxfdtm <> '0'
group by custac,remark) b 
on (a.custac = b.custac and a.remark = b.remark and a.diffdy = b.diffdy)
where a.custac = #custac# and a.pddpfg = '1' and a.issave = '1' and a.nxfdtm <> '0'
group by a.custac,a.remark,a.diffdy]]></sql>
        <sql type="mysql"><![CDATA[insert into knb_epcb_nxtm(custac,remark,diffdy,intram)
select a.custac,a.remark,a.diffdy,sum(a.onlnbl) as intram 
from knb_epcb a join 
(select custac,remark,min(diffdy) as diffdy from knb_epcb
where custac = #custac# and pddpfg = '1' and issave = '1' and nxfdtm <> '0'
group by custac,remark) b 
on (a.custac = b.custac and a.remark = b.remark and a.diffdy = b.diffdy)
where a.custac = #custac# and a.pddpfg = '1' and a.issave = '1' and a.nxfdtm <> '0'
group by a.custac,a.remark,a.diffdy]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
        </parameterMap>
    </insert>
    <delete method="delete" id="delKnbEpcbNxtm" longname="删除智能储蓄预下一档临时表">
        <sql type="oracle"><![CDATA[delete from knb_epcb_nxtm where custac = #custac#]]></sql>
        <sql type="mysql"><![CDATA[delete from knb_epcb_nxtm where custac = #custac#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
        </parameterMap>
    </delete>
    <select cache="none" method="selectOne" type="sql" id="selMaxDayllmForKnbEpcb" longname="查询智能储蓄目前最高档期">
        <sql type="oracle"><![CDATA[select max(cast(remark as signed)) as remark 
from knb_epcb where custac = #custac#]]></sql>
        <sql type="mysql"><![CDATA[select max(cast(remark as signed)) as remark 
from knb_epcb where custac = #custac#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.lang.String"/>
    </select>
    <select cache="none" method="selectPageWithCount" type="sql" id="selCurrTranInfoByAcctnoForSump" longname="查询交易信息管理平台用">
        <sql type="oracle"><![CDATA[SELECT a.Acctdt, a.Cuacno, a.Tranam, a.crcycd,a.amntcd,a.Transq, b.Jiaoyima AS Prcsid, b.Jiaoyimc AS trnnam, lPad(c.jiaoyisj,9,'0') as trantm
  FROM kns_acsq a, kapp_jioyxx b, kns_tran c
  FROM kns_acsq a, kapp_jioyxx b, kns_tran c
 WHERE a.Transq = c.Zjyilush
   AND c.Jiaoyima = b.Jiaoyima
   AND b.Jiaoyima <> 'api111'
   AND a.trandt>=#trandt#
   AND a.Cuacno = #acctno#
 ORDER BY Acctdt DESC, Trantm DESC]]></sql>
        <sql type="mysql"><![CDATA[SELECT a.Acctdt, a.Cuacno, a.Tranam, a.crcycd,a.amntcd,a.Transq, b.Jiaoyima AS Prcsid, b.Jiaoyimc AS trnnam, lPad(c.jiaoyisj,9,'0') as trantm
  FROM kns_acsq a, kapp_jioyxx b, kns_tran c
  FROM kns_acsq a, kapp_jioyxx b, kns_tran c
 WHERE a.Transq = c.Zjyilush
   AND c.Jiaoyima = b.Jiaoyima
   AND b.Jiaoyima <> 'api111'
   AND a.trandt>=#trandt#
   AND a.Cuacno = #acctno#
 ORDER BY Acctdt DESC, Trantm DESC]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="trandt" jdbcType="VARCHAR" javaType="PbBaseType.U_DATE08" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpAcctType.AcctTransInfoForSump"/>
    </select>
    <select cache="none" method="selectPageWithCount" type="sql" id="selAllTranInfoByAcctnoForSump" longname="查询交易信息管理平台用">
        <sql type="oracle"><![CDATA[SELECT distinct *
  FROM (SELECT a.Acctdt, a.Cuacno, a.Tranam, a.Crcycd, a.Amntcd, a.Transq,
                b.Jiaoyima AS Prcsid,b.Jiaoyimc AS trnnam, Lpad(c.Jiaoyisj, 9, '0') AS Trantm
           FROM kns_acsq a, kapp_jioyxx b, kns_tran c
           FROM kns_acsq a, kapp_jioyxx b, kns_tran c
          WHERE a.Transq = c.Zjyilush
            AND c.Jiaoyima = b.Jiaoyima
            AND b.Jiaoyima <> 'api111'
            AND a.trandt>=#stardt#
			AND a.trandt <=#endxdt#
			AND a.Cuacno = #acctno#
         UNION ALL
         SELECT a.Acctdt, a.Cuacno, a.Tranam, a.Crcycd, a.Amntcd, a.Transq,
                b.Jiaoyima AS Prcsid, b.Jiaoyimc AS trnnam,Lpad(c.Jiaoyisj, 9, '0') AS Trantm
           FROM h_Kns_Acsq a, Kapp_Jioyxx b, kns_tran c
           FROM h_kns_acsq a, kapp_jioyxx b, kns_tran c
          WHERE a.Transq = c.Zjyilush
            AND c.Jiaoyima = b.Jiaoyima
            AND b.Jiaoyima <> 'api111'
            AND a.trandt>=#stardt#
		    AND a.trandt <=#endxdt#
		    AND a.Cuacno = #acctno#)
 ORDER BY Acctdt DESC, Trantm DESC
  ]]></sql>
        <sql type="mysql"><![CDATA[SELECT distinct *
  FROM (SELECT a.Acctdt, a.Cuacno, a.Tranam, a.Crcycd, a.Amntcd, a.Transq,
                b.Jiaoyima AS Prcsid,b.Jiaoyimc AS trnnam, Lpad(c.Jiaoyisj, 9, '0') AS Trantm
           FROM kns_acsq a, kapp_jioyxx b, kns_tran c
           FROM kns_acsq a, kapp_jioyxx b, kns_tran c
          WHERE a.Transq = c.Zjyilush
            AND c.Jiaoyima = b.Jiaoyima
            AND b.Jiaoyima <> 'api111'
            AND a.trandt>=#stardt#
			AND a.trandt <=#endxdt#
			AND a.Cuacno = #acctno#
         UNION ALL
         SELECT a.Acctdt, a.Cuacno, a.Tranam, a.Crcycd, a.Amntcd, a.Transq,
                b.Jiaoyima AS Prcsid, b.Jiaoyimc AS trnnam,Lpad(c.Jiaoyisj, 9, '0') AS Trantm
           FROM h_Kns_Acsq a, Kapp_Jioyxx b, kns_tran c
           FROM h_kns_acsq a, kapp_jioyxx b, kns_tran c
          WHERE a.Transq = c.Zjyilush
            AND c.Jiaoyima = b.Jiaoyima
            AND b.Jiaoyima <> 'api111'
            AND a.trandt>=#stardt#
		    AND a.trandt <=#endxdt#
		    AND a.Cuacno = #acctno#)
 ORDER BY Acctdt DESC, Trantm DESC
  ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="stardt" jdbcType="VARCHAR" javaType="PbBaseType.U_DATE08" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="endxdt" jdbcType="VARCHAR" javaType="PbBaseType.U_DATE08" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpAcctType.AcctTransInfoForSump"/>
    </select>
    <select cache="none" method="selectPageWithCount" type="sql" id="selHistTranInfoByAcctnoForSump" longname="查询交易信息管理平台用">
        <sql type="oracle"><![CDATA[SELECT a.Acctdt, a.Cuacno, a.Tranam, a.Crcycd, a.Amntcd, a.Transq,
                b.Jiaoyima AS Prcsid,b.Jiaoyimc AS trnnam, Lpad(c.Jiaoyisj, 9, '0') AS Trantm 
           FROM h_kns_acsq a, kapp_jioyxx b, kns_tran c
           FROM h_kns_acsq a, kapp_jioyxx b, kns_tran c
          WHERE a.Transq = c.Zjyilush
            AND c.Jiaoyima = b.Jiaoyima
            AND b.Jiaoyima <> 'api111'
            AND a.trandt>=#stardt#
			AND a.trandt <=#endxdt#
			AND a.Cuacno = #acctno#
 		  ORDER BY Acctdt DESC, Trantm DESC
  ]]></sql>
        <sql type="mysql"><![CDATA[SELECT a.Acctdt, a.Cuacno, a.Tranam, a.Crcycd, a.Amntcd, a.Transq,
                b.Jiaoyima AS Prcsid,b.Jiaoyimc AS trnnam, Lpad(c.Jiaoyisj, 9, '0') AS Trantm 
           FROM h_kns_acsq a, kapp_jioyxx b, kns_tran c
           FROM h_kns_acsq a, kapp_jioyxx b, kns_tran c
          WHERE a.Transq = c.Zjyilush
            AND c.Jiaoyima = b.Jiaoyima
            AND b.Jiaoyima <> 'api111'
            AND a.trandt>=#stardt#
			AND a.trandt <=#endxdt#
			AND a.Cuacno = #acctno#
 		  ORDER BY Acctdt DESC, Trantm DESC
  ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="stardt" jdbcType="VARCHAR" javaType="PbBaseType.U_DATE08" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="endxdt" jdbcType="VARCHAR" javaType="PbBaseType.U_DATE08" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpAcctType.AcctTransInfoForSump"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selDfaHoldOnlnblByAcctno" longname="根据保险账号查询保险账户余额">
        <sql type="oracle"><![CDATA[select nvl(onlnbl,0) from dfa_hold where acctno = #acctno# and acctst = #acctst#]]></sql>
        <sql type="mysql"><![CDATA[select ifnull(onlnbl,0) from dfa_hold where acctno = #acctno# and acctst = #acctst#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="保险账号" parameterType="condition"/>
            <parameter property="acctst" jdbcType="VARCHAR" javaType="BaseEnumType.E_ACCTST" mode="in" longname="账户状态" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.math.BigDecimal"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selDfaHoldByCustacAndAcctst" longname="根据电子账号及账户状态查询保险账号">
        <sql type="oracle"><![CDATA[select a.acctno from kna_accs a join dfa_hold b on (a.acctno = b.acctno)
where a.custac = #custac# and b.acctst = #acctst#]]></sql>
        <sql type="mysql"><![CDATA[select a.acctno from kna_accs a join dfa_hold b on (a.acctno = b.acctno)
where a.custac = #custac# and b.acctst = #acctst#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="acctst" jdbcType="VARCHAR" javaType="BaseEnumType.E_ACCTST" mode="in" longname="账户状态" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.lang.String"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selDfaHoldDetlByCustacForNorm" longname="根据电子账号查询保单保单状态正常的保险账号">
        <sql type="oracle"><![CDATA[select a.acctno from kna_accs a join dfa_hold b on (a.acctno = b.acctno)
join dfa_hold_detl c on (b.acctno = c.acctno)
where a.custac = #custac# and b.acctst = '1' and c.status not in ('1','5','6','7')]]></sql>
        <sql type="mysql"><![CDATA[select a.acctno from kna_accs a join dfa_hold b on (a.acctno = b.acctno)
join dfa_hold_detl c on (b.acctno = c.acctno)
where a.custac = #custac# and b.acctst = '1' and c.status not in ('1','5','6','7')]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.lang.String"/>
    </select>
    <update method="update" id="updDfaHoldAcctstByCustac" longname="根据电子账号更新保险账户状态">
        <sql type="oracle"><![CDATA[update dfa_hold a set a.acctst = #acctst#
where exists (select 1
from kna_accs b
where a.acctno = b.acctno and b.prodtp = #prodtp#
and b.custac = #custac#)]]></sql>
        <sql type="mysql"><![CDATA[update dfa_hold a set a.acctst = #acctst#
where exists (select 1
from kna_accs b
where a.acctno = b.acctno and b.prodtp = #prodtp#
and b.custac = #custac#)]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账户" parameterType="condition"/>
            <parameter property="acctst" jdbcType="VARCHAR" javaType="BaseEnumType.E_ACCTST" mode="in" longname="账户状态" parameterType="condition"/>
            <parameter property="prodtp" jdbcType="VARCHAR" javaType="DpEnumType.E_PRODTP" mode="in" longname="产品类型" parameterType="condition"/>
        </parameterMap>
    </update>
    <select cache="none" method="selectAll" type="sql" id="selKnlBillAndKnaCustByTrandt" longname="生成监管上报之交易流水文件数据(增量)">
        <sql type="oracle"><![CDATA[SELECT a.*,b.custno,c.prodcd,d.brchna FROM h_knl_bill a,kna_cust b ,kna_accs c ,kna_cacd d
        <sql type="oracle"><![CDATA[SELECT a.*,b.custno,c.prodcd,d.brchna FROM h_knl_bill a,kna_cust b ,kna_accs c ,kna_cacd d
WHERE a.Trandt =#datetm# and a.custac=b.custac  and c.acctno = a.acctno and a.custac = d.custac and d.status='1'
ORDER BY a.Detlsq ]]></sql>
        <sql type="mysql"><![CDATA[SELECT a.*,b.custno,c.prodcd,d.brchna FROM h_knl_bill a,kna_cust b ,kna_accs c ,kna_cacd d
        <sql type="oracle"><![CDATA[SELECT a.*,b.custno,c.prodcd,d.brchna FROM h_knl_bill a,kna_cust b ,kna_accs c ,kna_cacd d
WHERE a.Trandt =#datetm# and a.custac=b.custac  and c.acctno = a.acctno and a.custac = d.custac and d.status='1'
ORDER BY a.Detlsq ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="datetm" jdbcType="VARCHAR" javaType="string" mode="in" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDayEndType.KnlBillCustType"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selKnlBillAndKnaCust" longname="生成监管上报之交易流水文件数据(全量)">
        <sql type="oracle"><![CDATA[SELECT a.*,b.custno,c.prodcd,d.brchna FROM H_Knl_Bill a,kna_cust b ,kna_accs c ,kna_cacd d
        <sql type="oracle"><![CDATA[SELECT a.*,b.custno,c.prodcd,d.brchna FROM h_knl_bill a,kna_cust b ,kna_accs c ,kna_cacd d
WHERE a.custac=b.custac  and c.acctno = a.acctno and a.custac = d.custac and d.status='1'
ORDER BY a.Detlsq ]]></sql>
        <sql type="mysql"><![CDATA[SELECT a.*,b.custno,c.prodcd,d.brchna FROM H_Knl_Bill a,kna_cust b ,kna_accs c ,kna_cacd d
        <sql type="oracle"><![CDATA[SELECT a.*,b.custno,c.prodcd,d.brchna FROM h_knl_bill a,kna_cust b ,kna_accs c ,kna_cacd d
WHERE a.custac=b.custac  and c.acctno = a.acctno and a.custac = d.custac and d.status='1'
ORDER BY a.Detlsq ]]></sql>
        <parameterMap class="java.util.Map"/>
        <resultMap class="DpDayEndType.KnlBillCustType"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selKnaAcctForMDS" longname="生成监管上报之对私活期文件数据(全量)">
        <sql type="oracle"><![CDATA[ SELECT a.*, b.inbefg, c.bsintr, c.cuusin, c.irflby, c.inflpo, c.inflrt
   FROM kna_acct a, knb_acin b, kub_inrt c
   FROM kna_acct a, knb_acin b, kub_inrt c
  where a.acctno = b.acctno
    and a.acctno = c.acctno
  order by a.acctno]]></sql>
        <sql type="mysql"><![CDATA[ SELECT a.*, b.inbefg, c.bsintr, c.cuusin, c.irflby, c.inflpo, c.inflrt
   FROM kna_acct a, knb_acin b, kub_inrt c
   FROM kna_acct a, knb_acin b, kub_inrt c
  where a.acctno = b.acctno
    and a.acctno = c.acctno
  order by a.acctno]]></sql>
        <parameterMap class="java.util.Map"/>
        <resultMap class="DpDayEndType.KnaAcctType"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selKnaAcctForMDSByDate" longname="生成监管上报之对私活期文件数据(增量)">
        <sql type="oracle"><![CDATA[ SELECT a.*, b.inbefg, c.bsintr, c.cuusin, c.irflby, c.inflpo, c.inflrt
   FROM kna_acct a, knb_acin b, kub_inrt c
   FROM kna_acct a, knb_acin b, kub_inrt c
  where a.acctno = b.acctno
    and a.acctno = c.acctno
    and a.opendt = #datetm#
  order by a.acctno]]></sql>
        <sql type="mysql"><![CDATA[ SELECT a.*, b.inbefg, c.bsintr, c.cuusin, c.irflby, c.inflpo, c.inflrt
   FROM kna_acct a, knb_acin b, kub_inrt c
   FROM kna_acct a, knb_acin b, kub_inrt c
  where a.acctno = b.acctno
    and a.acctno = c.acctno
    and a.opendt = #datetm#
  order by a.acctno]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="datetm" jdbcType="VARCHAR" javaType="string" mode="in" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDayEndType.KnaAcctType"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selKnaFxacForMDS" longname="生成监管上报之对私定期文件数据(全量)">
        <sql type="oracle"><![CDATA[ SELECT a.*, b.inbefg, c.bsintr, c.cuusin, c.irflby, c.inflpo, c.inflrt
   FROM kna_fxac a, knb_acin b, kub_inrt c
   FROM kna_fxac a, knb_acin b, kub_inrt c
  where a.acctno = b.acctno
    and a.acctno = c.acctno
  order by a.acctno]]></sql>
        <sql type="mysql"><![CDATA[ SELECT a.*, b.inbefg, c.bsintr, c.cuusin, c.irflby, c.inflpo, c.inflrt
   FROM kna_fxac a, knb_acin b, kub_inrt c
   FROM kna_fxac a, knb_acin b, kub_inrt c
  where a.acctno = b.acctno
    and a.acctno = c.acctno
  order by a.acctno]]></sql>
        <parameterMap class="java.util.Map"/>
        <resultMap class="DpDayEndType.KnaFxacType"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selKnaFxacForMDSByDate" longname="生成监管上报之对私定期文件数据(增量)">
        <sql type="oracle"><![CDATA[ SELECT a.*, b.inbefg, c.bsintr, c.cuusin, c.irflby, c.inflpo, c.inflrt
   FROM kna_fxac a, knb_acin b, kub_inrt c
   FROM kna_fxac a, knb_acin b, kub_inrt c
  where a.acctno = b.acctno
    and a.acctno = c.acctno
    and a.opendt = #datetm#
  order by a.acctno ]]></sql>
        <sql type="mysql"><![CDATA[ SELECT a.*, b.inbefg, c.bsintr, c.cuusin, c.irflby, c.inflpo, c.inflrt
   FROM kna_fxac a, knb_acin b, kub_inrt c
   FROM kna_fxac a, knb_acin b, kub_inrt c
  where a.acctno = b.acctno
    and a.acctno = c.acctno
    and a.opendt = #datetm#
  order by a.acctno ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="datetm" jdbcType="VARCHAR" javaType="string" mode="in" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDayEndType.KnaFxacType"/>
    </select>
    <update method="update" id="updKnbIndlAcmltnByAcctno" longname="根据负债账号更新分段积数">
        <sql type="oracle"><![CDATA[update knb_indl set indlst = '0'  ,tmstmp=#tmstmp# where acctno = #acctno# and indlst = '1']]></sql>
        <sql type="mysql"><![CDATA[update knb_indl set indlst = '0'  ,tmstmp=#tmstmp# where acctno = #acctno# and indlst = '1']]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" ref="DpDict.Acct.acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="负债账号" parameterType="condition"/>
            <parameter property="tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <insert id="insKnbIndlAcmltnByAcctno" longname="根据负债账号插入分段积数信息到日志表">
        <sql type="oracle"><![CDATA[insert into knb_amtn (corpno,trandt,transq,acctno,detlsq,cutmam,cuusin,tmstmp)
select corpno,#trandt#,#transq#,acctno,detlsq,acmltn,cuusin,tmstmp
from knb_indl where acctno = #acctno# and indlst = '1'  and acmltn > 0]]></sql>
        <sql type="mysql"><![CDATA[insert into knb_amtn (corpno,trandt,transq,acctno,detlsq,cutmam,cuusin,tmstmp)
select corpno,#trandt#,#transq#,acctno,detlsq,acmltn,cuusin,tmstmp
from knb_indl where acctno = #acctno# and indlst = '1'  and acmltn > 0]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" ref="DpDict.Acct.acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="负债账号" parameterType="condition"/>
            <parameter property="trandt" ref="DpDict.Acct.trandt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="transq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="交易流水" parameterType="condition"/>
            <parameter property="tmstmp" ref="ApDict.Aplt.tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </insert>
    <update method="update" id="updKnaFxacDrdlToClose" longname="把指定电子账户下所有定期账户支取明细记录状态改为失效">
        <sql type="oracle"><![CDATA[UPDATE kna_fxac_drdl a SET a.Transt='2',a.tmstmp=#tmstmp# WHERE  a.acctno=#acctno# ]]></sql>
        <sql type="mysql"><![CDATA[UPDATE kna_fxac_drdl a SET a.Transt='2',a.tmstmp=#tmstmp# WHERE  a.acctno=#acctno# ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" ref="DpDict.Acct.acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="负债账号" parameterType="condition"/>
            <parameter property="tmstmp" ref="ApDict.Aplt.tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <update method="update" id="updKnaFxacDetlToClose" longname="把指定电子账户下所有负债定期账户明细记录状态改为关闭">
        <sql type="oracle"><![CDATA[UPDATE kna_fxac_detl a SET a.acctst='2',a.onlnbl=0,closdt=#closdt#,clossq=#clossq#,tmstmp=#tmstmp# WHERE a.acctno=#acctno# ]]></sql>
        <sql type="mysql"><![CDATA[UPDATE kna_fxac_detl a SET a.acctst='2',a.onlnbl=0,closdt=#closdt#,clossq=#clossq#,tmstmp=#tmstmp# WHERE a.acctno=#acctno# ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="closdt" ref="DpDict.Acct.closdt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="销户日期" parameterType="condition"/>
            <parameter property="clossq" ref="DpDict.Acct.clossq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="销户流水" parameterType="condition"/>
            <parameter property="acctno" ref="DpDict.Acct.acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="负债账号" parameterType="condition"/>
            <parameter property="tmstmp" ref="ApDict.Aplt.tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <update method="update" id="updknbIndlToClose" longname="把指定电子账户下所有负债账户利息明细记录状态改为关闭">
        <sql type="oracle"><![CDATA[UPDATE knb_indl a SET a.indlst='0',a.acmltn=0 ,a.tmstmp=#tmstmp# WHERE a.acctno=#acctno# ]]></sql>
        <sql type="mysql"><![CDATA[UPDATE knb_indl a SET a.indlst='0',a.acmltn=0 ,a.tmstmp=#tmstmp# WHERE a.acctno=#acctno# ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" ref="DpDict.Acct.acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="负债账号" parameterType="condition"/>
            <parameter property="tmstmp" ref="ApDict.Aplt.tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <select cache="none" method="selectAll" type="sql" id="selOxygenInfoForYitong" longname="屹通导出基金账户总价值">
        <sql type="oracle"><![CDATA[SELECT  b.custac, a.acctst,a.onlnbl,a.frozbl  FROM fda_fund a,kna_accs b where a.acctno = b.acctno]]></sql>
        <sql type="mysql"><![CDATA[SELECT  b.custac, a.acctst,a.onlnbl,a.frozbl  FROM fda_fund a,kna_accs b where a.acctno = b.acctno]]></sql>
        <parameterMap class="java.util.Map"/>
        <resultMap class="DpProdSvc.FdaFundType"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selInsurancefoForYitong" longname="屹通导出保险账户总价值">
        <sql type="oracle"><![CDATA[SELECT  b.custac, a.acctst,a.onlnbl FROM dfa_hold a,kna_accs b where a.acctno = b.acctno]]></sql>
        <sql type="mysql"><![CDATA[SELECT  b.custac, a.acctst,a.onlnbl FROM dfa_hold a,kna_accs b where a.acctno = b.acctno]]></sql>
        <parameterMap class="java.util.Map"/>
        <resultMap class="DpProdSvc.DfaHoldType"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selDincinfoForYitong" longname="屹通导出传统定期到期支取交易记录">
        <sql type="oracle"><![CDATA[select a.custac, a.pmcrac, a.transq, a.tranam, a.trandt, a.trantm, b.prodcd,b.deptdy
  from knl_bill a, kna_fxac b
 where a.acctno = b.acctno
   and a.trandt = #trandt#
   and a.intrcd = 'fxactr'
   and a.pmcrac in ('0', '1')
union all
select a.custac, a.pmcrac, a.transq, a.tranam, a.trandt, a.trantm, b.prodcd,b.deptdy
  from h_knl_bill a, kna_fxac b
 where a.acctno = b.acctno
   and a.trandt = #trandt#
   and a.intrcd = 'fxactr'
   and a.pmcrac in ('0', '1')]]></sql>
        <sql type="mysql"><![CDATA[select a.custac, a.pmcrac, a.transq, a.tranam, a.trandt, a.trantm, b.prodcd,b.deptdy
  from knl_bill a, kna_fxac b
 where a.acctno = b.acctno
   and a.trandt = #trandt#
   and a.intrcd = 'fxactr'
   and a.pmcrac in ('0', '1')
union all
select a.custac, a.pmcrac, a.transq, a.tranam, a.trandt, a.trantm, b.prodcd,b.deptdy
  from h_knl_bill a, kna_fxac b
 where a.acctno = b.acctno
   and a.trandt = #trandt#
   and a.intrcd = 'fxactr'
   and a.pmcrac in ('0', '1')]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="trandt" jdbcType="VARCHAR" javaType="string" mode="in" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpProdSvc.DincinfoType"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selfnacOnlnblAndNdrcin" longname="查询小马理财账户余额和代收利息">
        <sql type="oracle"><![CDATA[SELECT  onlnbl,ndrcin FROM fca_acct a where a.acctno = #acctno#]]></sql>
        <sql type="mysql"><![CDATA[SELECT  onlnbl,ndrcin FROM fca_acct a where a.acctno = #acctno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" ref="DpDict.Acct.acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="负债账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpProdSvc.FnacInfo"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selHKnaAcctByTrandt" longname="根据账务日期查找负债账户历史信息表(增量)">
        <sql type="oracle"><![CDATA[select * from h_kna_acct where acctdt = #acctdt#
]]></sql>
        <sql type="mysql"><![CDATA[select * from h_kna_acct where acctdt = #acctdt#
]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctdt" ref="DpDict.Acct.acctdt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="账务日期" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpHisDepo.HKnaAcct"/>
    </select>
    <select cache="none" method="selectFirst" type="sql" id="selTotalValueForAccount" longname="查询存款账户总价值">
        <sql type="oracle" desc="zoukun"><![CDATA[select sum(A.tranam) tranam
  from(
    select sum(case when a.upbldt = #trandt# then a.lastbl else a.onlnbl end) as tranam
    from kna_acct a,kup_dptd b where a.crcycd = #crcycd# and a.custac = #custac# and a.prodcd = b.prodcd
    union
    select sum(case when a.upbldt = #trandt# then a.lastbl else a.onlnbl end) as tranam
    from kna_fxac a,kup_dptd b where a.crcycd = #crcycd# and a.custac = #custac# and a.prodcd = b.prodcd) A]]></sql>
        <sql type="mysql"><![CDATA[select sum(A.tranam) tranam
  from(
    select sum(case when a.upbldt = #trandt# then a.lastbl else a.onlnbl end) as tranam
    from kna_acct a,kup_dptd b where a.crcycd = #crcycd# and a.custac = #custac# and a.prodcd = b.prodcd
    union
    select sum(case when a.upbldt = #trandt# then a.lastbl else a.onlnbl end) as tranam
    from kna_fxac a,kup_dptd b where a.crcycd = #crcycd# and a.custac = #custac# and a.prodcd = b.prodcd) A]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="crcycd" ref="DpDict.Acct.crcycd" jdbcType="VARCHAR" javaType="BaseType.U_CRCYCD" mode="in" longname="货币代号" parameterType="condition"/>
            <parameter property="trandt" ref="DpDict.Acct.trandt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="custac" ref="DpDict.Acct.custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="客户账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.math.BigDecimal">
            <result property="tranam" javaType="BaseType.U_ACBLTP" jdbcType="NUMERIC" column="tranam" longname="账户余额"/>
        </resultMap>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selXmChinaPayCnt" longname="统计Chinapay对账明细记录">
        <sql type="oracle"><![CDATA[select count(*) 
from lnb_xmzd_iobl 
where fromtp = '1' 
and keepdt=#bftrndt#]]></sql>
        <sql type="mysql"><![CDATA[select count(*) 
from lnb_xmzd_iobl 
where fromtp = '1' 
and keepdt=#bftrndt#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="bftrndt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="上次交易日期" parameterType="condition"/>
        </parameterMap>
        <resultMap class="int"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selXmChinaPay" longname="查询小马Chinapay对账明细记录">
        <sql type="oracle"><![CDATA[select servsq, servdt, fromtp, cardno, tranam, crcycd, acctno, ioflag, prcscd, transq, trandt, trantm, status, remark, corpno, datetm, tmstmp 
from lnb_xmzd_iobl 
where 
fromtp = '1' 
and keepdt=#bftrndt#
order by servsq]]></sql>
        <sql type="mysql"><![CDATA[select servsq, servdt, fromtp, cardno, tranam, crcycd, acctno, ioflag, prcscd, transq, trandt, trantm, status, remark, corpno, datetm, tmstmp 
from lnb_xmzd_iobl 
where 
fromtp = '1' 
and keepdt=#bftrndt#
order by servsq]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="bftrndt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="上次交易日期" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoLnQryComplex.IoXmCpIoBill"/>
    </select>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selKnsAcsqInfos" longname="查询会计流水表详细信息">
        <parameterMap class="java.util.Map">
            <parameter property="trandt" ref="DpDict.Acct.trandt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="transq" ref="DpDict.Acct.transq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="主交易流水" parameterType="condition"/>
            <parameter property="bgindt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="起始日期" parameterType="condition"/>
            <parameter property="endddt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="截止日期" parameterType="condition"/>
            <parameter property="corpno" ref="LnDict.LNF.corpno" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
            <parameter property="acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoAccountComplexType.IoKnsAcsqInfo"/>
        <dynamicSql type="db2">
            <str type="Str"><![CDATA[
			select a.cuacno, a.trandt,a.mntrsq,c.prcscd,c.tranna as prcsna,a.cuacno as acctno,a.dtitcd ,a.crcycd,a.amntcd,
			a.tranam,a.atowtp,a.bltype,b.tranus,b.rvfxst status,b.cstrfg trantp,c.sacotg
			from kns_acsq a,kns_tran b,knp_txns c]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[a.mntrsq = b.mntrsq and b.prcscd = c.prcscd ]]></str>
                    <if test="bgindt!=null &amp;&amp;bgindt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt>=#bgindt#]]></str>
                    </if>
                    <if test="endddt !=null &amp;&amp;endddt !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt <= #endddt#]]></str>
                    </if>
                    <if test="transq !=null &amp;&amp; transq !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.transq =#transq#]]></str>
                    </if>
                    <if test="corpno !=null &amp;&amp;corpno !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.corpno =#corpno#]]></str>
                    </if>
                    <if test="acctno!=null&amp;&amp;acctno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[acctno=#acctno#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by  a.tmstmp  ]]></str>
        </dynamicSql>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[
            select a.cuacno, a.trandt,a.mntrsq,c.prcscd,c.tranna as prcsna,a.cuacno as acctno,a.dtitcd ,a.crcycd,a.amntcd,
            a.tranam,a.atowtp,a.bltype,b.tranus,b.rvfxst status,b.cstrfg trantp,c.sacotg
            from kns_acsq a,kns_tran b,knp_txns c]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[a.mntrsq = b.mntrsq and b.prcscd = c.prcscd ]]></str>
                    <if test="bgindt!=null &amp;&amp;bgindt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt>=#bgindt#]]></str>
                    </if>
                    <if test="endddt !=null &amp;&amp;endddt !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt <= #endddt#]]></str>
                    </if>
                    <if test="transq !=null &amp;&amp; transq !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.transq =#transq#]]></str>
                    </if>
                    <if test="corpno !=null &amp;&amp;corpno !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.corpno =#corpno#]]></str>
                    </if>
                    <if test="acctno!=null&amp;&amp;acctno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[acctno=#acctno#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by  a.tmstmp  ]]></str>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[
            select a.cuacno, a.trandt,a.mntrsq,c.prcscd,c.tranna as prcsna,a.cuacno as acctno,a.dtitcd ,a.crcycd,a.amntcd,
            a.tranam,a.atowtp,a.bltype,b.tranus,b.rvfxst status,b.cstrfg trantp,c.sacotg
            from kns_acsq a,kns_tran b,knp_txns c]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[a.mntrsq = b.mntrsq and b.prcscd = c.prcscd ]]></str>
                    <if test="bgindt!=null &amp;&amp;bgindt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt>=#bgindt#]]></str>
                    </if>
                    <if test="endddt !=null &amp;&amp;endddt !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt <= #endddt#]]></str>
                    </if>
                    <if test="transq !=null &amp;&amp; transq !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.transq =#transq#]]></str>
                    </if>
                    <if test="corpno !=null &amp;&amp;corpno !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.corpno =#corpno#]]></str>
                    </if>
                    <if test="acctno!=null&amp;&amp;acctno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[acctno=#acctno#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by  a.tmstmp  ]]></str>
        </dynamicSql>
    </dynamicSelect>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selKnsAcsqInfosByAcctOrSq" longname="查询会计流水表详细信息">
        <parameterMap class="java.util.Map">
            <parameter property="trandt" ref="DpDict.Acct.trandt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="mntrsq" ref="DpDict.Froz.mntrsq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="主交易流水" parameterType="condition"/>
            <parameter property="bgindt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="起始日期" parameterType="condition"/>
            <parameter property="endddt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="截止日期" parameterType="condition"/>
            <parameter property="acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="账号" parameterType="condition"/>
            <parameter property="sortno" jdbcType="VARCHAR" javaType="string" mode="in" longname="序号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoAccountComplexType.IoKnsAcsqInfo"/>
        <dynamicSql type="db2">
            <str type="Str"><![CDATA[
            select a.trandt,a.mntrsq,a.acctno,a.crcycd,a.amntcd,
            a.tranam,a.atowtp,a.bltype,a.transq,a.cuacno,a.acctbr,a.sortno from kns_acsq a]]></str>
            <where type="Where">
                <and type="And">
                    <if test="bgindt!=null &amp;&amp;bgindt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt>=#bgindt#]]></str>
                    </if>
                    <if test="endddt !=null &amp;&amp;endddt !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt <= #endddt#]]></str>
                    </if>
                    <if test="mntrsq !=null &amp;&amp; mntrsq !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.mntrsq =#mntrsq#]]></str>
                    </if>
                    <if test="acctno!=null&amp;&amp;acctno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.acctno=#acctno#]]></str>
                    </if>
                    <if test="sortno!=null&amp;&amp;sortno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.sortno=#sortno#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by  a.tmstmp  ]]></str>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[
            select a.trandt,a.mntrsq,a.acctno,a.crcycd,a.amntcd,
            a.tranam,a.atowtp,a.bltype,a.transq,a.cuacno,a.acctbr 
            from kns_acsq a]]></str>
            <where type="Where">
                <and type="And">
                    <if test="bgindt!=null &amp;&amp;bgindt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt>=#bgindt#]]></str>
                    </if>
                    <if test="endddt !=null &amp;&amp;endddt !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt <= #endddt#]]></str>
                    </if>
                    <if test="mntrsq !=null &amp;&amp; mntrsq !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.mntrsq =#mntrsq#]]></str>
                    </if>
                    <if test="acctno!=null&amp;&amp;acctno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.acctno=#acctno#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by  a.tmstmp  ]]></str>
        </dynamicSql>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[
            select a.trandt,a.mntrsq,a.acctno,a.crcycd,a.amntcd,
            a.tranam,a.atowtp,a.bltype,a.transq,a.cuacno,a.acctbr ,
            a.sortno from kns_acsq a]]></str>
            <where type="Where">
                <and type="And">
                    <if test="bgindt!=null &amp;&amp;bgindt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt>=#bgindt#]]></str>
                    </if>
                    <if test="endddt !=null &amp;&amp;endddt !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt <= #endddt#]]></str>
                    </if>
                    <if test="mntrsq !=null &amp;&amp; mntrsq !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.mntrsq =#mntrsq#]]></str>
                    </if>
                    <if test="acctno!=null&amp;&amp;acctno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.acctno=#acctno#]]></str>
                    </if>
                    <if test="sortno!=null&amp;&amp;sortno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.sortno=#sortno#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by  a.tmstmp  ]]></str>
        </dynamicSql>
    </dynamicSelect>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selKnbInrtAdjtInfos" longname="查询利息调整登记簿">
        <parameterMap class="java.util.Map">
            <parameter property="cardno" ref="DpDict.Acct.cardno" jdbcType="VARCHAR" javaType="BaseType.U_CARDNO" mode="in" longname="客户账号" parameterType="condition"/>
            <parameter property="adjttp" ref="DpDict.Acct.adjttp" jdbcType="VARCHAR" javaType="DpEnumType.E_ADJTTP" mode="in" longname="利息调整方式" parameterType="condition"/>
            <parameter property="bgdate" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="起始日期" parameterType="condition"/>
            <parameter property="endate" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="截止日期" parameterType="condition"/>
            <parameter property="acctbr" jdbcType="VARCHAR" javaType="BaseType.U_BRCHNO" mode="in" longname="记账机构" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoDpTable.IoDpKnbInrtAdjt"/>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[select a.* from knb_inrt_adjt a ]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[a.acctbr =#acctbr# and a.trandt between #bgdate# and #endate# and a.status ='1']]></str>
                    <if test="cardno!=&quot;&quot;&amp;&amp;cardno!=null " type="If">
                        <str type="Str"><![CDATA[a.adacno =#cardno#]]></str>
                    </if>
                    <if test="adjttp!=9" type="If">
                        <str type="Str"><![CDATA[a.adjttp=#adjttp#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by  tmstmp ]]></str>
        </dynamicSql>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select a.* from knb_inrt_adjt a ]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[a.acctbr =#acctbr# and a.trandt between #bgdate# and #endate# and a.status ='1']]></str>
                    <if test="cardno!=&quot;&quot;&amp;&amp;cardno!=null " type="If">
                        <str type="Str"><![CDATA[a.adacno =#cardno#]]></str>
                    </if>
                    <if test="adjttp!=9" type="If">
                        <str type="Str"><![CDATA[a.adjttp=#adjttp#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by  tmstmp ]]></str>
        </dynamicSql>
        <dynamicSql type="db2">
            <str type="Str"><![CDATA[select a.* from knb_inrt_adjt a ]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[a.acctbr =#acctbr# and a.trandt between #bgdate# and #endate# and a.status ='1']]></str>
                    <if test="cardno!=&quot;&quot;&amp;&amp;cardno!=null " type="If">
                        <str type="Str"><![CDATA[a.adacno =#cardno#]]></str>
                    </if>
                    <if test="adjttp!=9" type="If">
                        <str type="Str"><![CDATA[a.adjttp=#adjttp#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by  tmstmp ]]></str>
        </dynamicSql>
    </dynamicSelect>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selAcctblList" longname="查询电子账户存款类账户交易明细(柜面)(当前库)">
        <parameterMap class="java.util.Map">
            <parameter property="acctno" ref="DpDict.Acct.acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="负债账号" parameterType="condition"/>
            <parameter property="amntcd" ref="BaseDict.Comm.amntcd" jdbcType="VARCHAR" javaType="BaseEnumType.E_AMNTCD" mode="in" longname="借贷标志" parameterType="condition"/>
            <parameter property="bgindt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="开始日期" parameterType="condition"/>
            <parameter property="endddt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="终止日期" parameterType="condition"/>
            <parameter property="smrycd" ref="BaseDict.Comm.smrycd" jdbcType="VARCHAR" javaType="BaseType.U_SMRYCD" mode="in" longname="摘要代码" parameterType="condition"/>
            <parameter property="opcuac" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="对方账号" parameterType="condition"/>
            <parameter property="opcuna" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNA" mode="in" longname="对方户名" parameterType="condition"/>
            <parameter property="mxtram" jdbcType="VARCHAR" javaType="BaseType.U_TRANAM" mode="in" longname="最大交易金额" parameterType="condition"/>
            <parameter property="mntram" jdbcType="VARCHAR" javaType="BaseType.U_TRANAM" mode="in" longname="最小交易金额" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoDpTable.IoDpAcctblList"/>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select trandt, trantm,tranam,acctbl,trancy crcycd,csextg,amntcd,opcuac,opacna opcuna,tranbr,servtp,smrycd,smryds,remark,procsq,intrcd,userid,ussqno,authus,authsq
from knl_bill
				
]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[acctno=#acctno# and trandt between #bgindt# and #endddt#]]></str>
                    <if test="amntcd!=null" type="If">
                        <str type="Str"><![CDATA[amntcd = #amntcd#]]></str>
                    </if>
                    <if test="mxtram!=null" type="If">
                        <str type="Str"><![CDATA[tranam <= #mxtram#]]></str>
                    </if>
                    <if test="smrycd!=null&amp;smrycd!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[smrycd = #smrycd#]]></str>
                    </if>
                    <if test="opcuac!=null&amp;opcuac!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[opcuac = #opcuac#]]></str>
                    </if>
                    <if test="opcuna!=null&amp;opcuna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[opacna = #opcuna#]]></str>
                    </if>
                    <if test="mntram!=null" type="If">
                        <str type="Str"><![CDATA[tranam >= #mntram#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by trandt asc, trantm asc]]></str>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[select trandt, trantm,tranam,acctbl,trancy crcycd,csextg,amntcd,opcuac,opacna opcuna,tranbr,servtp,smrycd,smryds,remark,procsq,intrcd,userid,ussqno,authus,authsq
from knl_bill
                
]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[acctno=#acctno# and trandt between #bgindt# and #endddt#]]></str>
                    <if test="amntcd!=null" type="If">
                        <str type="Str"><![CDATA[amntcd = #amntcd#]]></str>
                    </if>
                    <if test="mxtram!=null" type="If">
                        <str type="Str"><![CDATA[tranam <= #mxtram#]]></str>
                    </if>
                    <if test="smrycd!=null&amp;smrycd!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[smrycd = #smrycd#]]></str>
                    </if>
                    <if test="opcuac!=null&amp;opcuac!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[opcuac = #opcuac#]]></str>
                    </if>
                    <if test="opcuna!=null&amp;opcuna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[opacna = #opcuna#]]></str>
                    </if>
                    <if test="mntram!=null" type="If">
                        <str type="Str"><![CDATA[tranam >= #mntram#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by trandt asc, trantm asc]]></str>
        </dynamicSql>
    </dynamicSelect>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selHisAcctblList" longname="查询电子账户存款类账户交易明细(柜面)(历史库)">
        <parameterMap class="java.util.Map">
            <parameter property="acctno" ref="DpDict.Acct.acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="负债账号" parameterType="condition"/>
            <parameter property="amntcd" ref="BaseDict.Comm.amntcd" jdbcType="VARCHAR" javaType="BaseEnumType.E_AMNTCD" mode="in" longname="借贷标志" parameterType="condition"/>
            <parameter property="bgindt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" parameterType="condition"/>
            <parameter property="endddt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="终止日期" parameterType="condition"/>
            <parameter property="smrycd" ref="BaseDict.Comm.smrycd" jdbcType="VARCHAR" javaType="BaseType.U_SMRYCD" mode="in" longname="摘要代码" parameterType="condition"/>
            <parameter property="opcuac" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="对方账号" parameterType="condition"/>
            <parameter property="opcuna" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNA" mode="in" longname="对方户名" parameterType="condition"/>
            <parameter property="mxtram" jdbcType="VARCHAR" javaType="BaseType.U_TRANAM" mode="in" longname="最大交易金额" parameterType="condition"/>
            <parameter property="mntram" jdbcType="VARCHAR" javaType="BaseType.U_TRANAM" mode="in" longname="最小交易金额" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoDpTable.IoDpAcctblList"/>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select trandt,trantm,tranam,acctbl,trancy crcycd,csextg,amntcd,opcuac,opacna opcuna,tranbr,servtp,smrycd,smryds,remark,procsq,intrcd,userid,ussqno,authus,authsq
from h_knl_bill 
]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[acctno=#acctno# and trandt between #bgindt# and #endddt#]]></str>
                    <if test="amntcd!=null" type="If">
                        <str type="Str"><![CDATA[amntcd = #amntcd#]]></str>
                    </if>
                    <if test="mntram!=null&amp;mntram!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[tranam >= #mntram#]]></str>
                    </if>
                    <if test="mxtram!=null&amp;mxtram!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[tranam < #mxtram#]]></str>
                    </if>
                    <if test="smrycd!=null" type="If">
                        <str type="Str"><![CDATA[smrycd = #smrycd#]]></str>
                    </if>
                    <if test="opcuac!=null&amp;opcuac!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[opcuac = #opcuac#]]></str>
                    </if>
                    <if test="opcuna!=null&amp;opcuna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[opacna = #opcuna#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by trandt desc, tmstmp desc]]></str>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[select trandt,trantm,tranam,acctbl,trancy crcycd,csextg,amntcd,opcuac,opacna opcuna,tranbr,servtp,smrycd,smryds,remark,procsq,intrcd,userid,ussqno,authus,authsq
from h_knl_bill 
]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[acctno=#acctno# and trandt between #bgindt# and #endddt#]]></str>
                    <if test="amntcd!=null" type="If">
                        <str type="Str"><![CDATA[amntcd = #amntcd#]]></str>
                    </if>
                    <if test="mntram!=null&amp;mntram!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[tranam >= #mntram#]]></str>
                    </if>
                    <if test="mxtram!=null&amp;mxtram!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[tranam < #mxtram#]]></str>
                    </if>
                    <if test="smrycd!=null" type="If">
                        <str type="Str"><![CDATA[smrycd = #smrycd#]]></str>
                    </if>
                    <if test="opcuac!=null&amp;opcuac!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[opcuac = #opcuac#]]></str>
                    </if>
                    <if test="opcuna!=null&amp;opcuna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[opacna = #opcuna#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by trandt desc, tmstmp desc]]></str>
        </dynamicSql>
    </dynamicSelect>
    <select cache="none" method="selectOne" type="sql" id="seltoAcctInfo" longname="根据卡号查询付款方账户信息">
        <sql type="db2"><![CDATA[select cifc.idtftp otidtp ,cifc.idtfno otidno,acal.acalno otphno,cust.corpno tocorp,
cust.brchno tobrch,acdc.cardno toacct,cust.custac toscac 
from kna_acdc acdc 
inner join kna_cust cust on (acdc.custac = cust.custac)
inner join cif_cust cifc on(cust.custno = cifc.custno)
inner join kna_acal acal on(acdc.custac = acal.custac)
where acal.acaltp = '1' and acal.ACALST='1' and cust.acctst='1'
and acdc.cardno =#cardno#]]></sql>
        <sql type="oracle"><![CDATA[select cifc.idtftp otidtp ,cifc.idtfno otidno,acal.acalno otphno,cust.corpno tocorp,
cust.brchno tobrch,acdc.cardno toacct,cust.custac toscac 
from kna_acdc acdc 
inner join kna_cust cust on (acdc.custac = cust.custac)
inner join cif_cust cifc on(cust.custno = cifc.custno)
inner join kna_acal acal on(acdc.custac = acal.custac)
where acal.acaltp = '1' and acal.ACALST='1' and cust.acctst='1'
and acdc.cardno =#cardno#]]></sql>
        <sql type="mysql"><![CDATA[select cifc.idtftp otidtp ,cifc.idtfno otidno,acal.acalno otphno,cust.corpno tocorp,
cust.brchno tobrch,acdc.cardno toacct,cust.custac toscac 
from kna_acdc acdc 
inner join kna_cust cust on (acdc.custac = cust.custac)
inner join cif_cust cifc on(cust.custno = cifc.custno)
inner join kna_acal acal on(acdc.custac = acal.custac)
where acal.acaltp = '1' and acal.ACALST='1' and cust.acctst='1'
and acdc.cardno =#cardno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="cardno" ref="ClDict.CL.cardno" jdbcType="VARCHAR" javaType="BaseType.U_CHAR10" mode="in" longname="卡号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoDpProdQuery.IoDpToAcctInfoQry"/>
    </select>
    <update method="update" id="updKubInrtToClose" longname="修改账户利率信息表的积数和利息为0">
        <sql><![CDATA[Update kub_inrt set clvsmt=0, clvamt=0, lastbl=0, lastdt=#trandt#, clvudt=#trandt# , tmstmp=#tmstmp#
where acctno=#acctno#]]></sql>
        <sql type="oracle"><![CDATA[Update kub_inrt set clvsmt=0, clvamt=0, lastbl=0, lastdt=#trandt#, clvudt=#trandt# , tmstmp=#tmstmp#
where acctno=#acctno#]]></sql>
        <sql type="mysql"><![CDATA[Update kub_inrt set clvsmt=0, clvamt=0, lastbl=0, lastdt=#trandt#, clvudt=#trandt# , tmstmp=#tmstmp#
where acctno=#acctno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="trandt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="负债账号" parameterType="condition"/>
            <parameter property="tmstmp" ref="ApDict.Aplt.tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selHqTranDetl" longname="查询电子账户活期账户交易明细（客户端）">
        <parameterMap class="java.util.Map">
            <parameter property="acctno" ref="DpDict.Acct.acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="负债账号" parameterType="condition"/>
            <parameter property="crcycd" jdbcType="VARCHAR" javaType="BaseType.U_CRCYCD" mode="in" longname="币种" parameterType="condition"/>
            <parameter property="bgindt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="起始日期" parameterType="condition"/>
            <parameter property="endddt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="终止日期" parameterType="condition"/>
            <parameter property="smrycd" ref="BaseDict.Comm.smrycd" jdbcType="VARCHAR" javaType="BaseType.U_SMRYCD" mode="in" longname="摘要代码" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoDpTable.IoDpTranDetlHqQryAcct"/>
        <dynamicSql type="db2">
            <str type="Str"><![CDATA[select trandt,trantm,tranam,acctbl,trancy crcycd,csextg,amntcd,opcuac,opacna opcuna,tranbr,servtp,smrycd,smryds,remark,tmstmp,machdt from knl_bill
]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[acctno = #acctno# and trancy = #crcycd#]]></str>
                    <if test="bgindt!=null&amp;&amp;bgindt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[trandt between #bgindt# and #endddt#]]></str>
                    </if>
                    <if test="smrycd!=null&amp;&amp;smrycd!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[smrycd = #smrycd#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by trandt desc, detlsq desc]]></str>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[select trandt,trantm,tranam,acctbl,trancy crcycd,csextg,amntcd,opcuac,opacna opcuna,tranbr,servtp,smrycd,smryds,remark,tmstmp,machdt from knl_bill
]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[acctno = #acctno# and trancy = #crcycd#]]></str>
                    <if test="bgindt!=null&amp;&amp;bgindt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[trandt between #bgindt# and #endddt#]]></str>
                    </if>
                    <if test="smrycd!=null&amp;&amp;smrycd!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[smrycd = #smrycd#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by trandt desc, detlsq desc]]></str>
        </dynamicSql>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select trandt,trantm,tranam,acctbl,trancy crcycd,csextg,amntcd,opcuac,opacna opcuna,tranbr,servtp,smrycd,smryds,remark,tmstmp,machdt,transq,intrcd from knl_bill
]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[acctno = #acctno# and trancy = #crcycd#]]></str>
                    <if test="bgindt!=null&amp;&amp;bgindt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[trandt between #bgindt# and #endddt#]]></str>
                    </if>
                    <if test="smrycd!=null&amp;&amp;smrycd!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[smrycd = #smrycd#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by trandt desc, detlsq desc]]></str>
        </dynamicSql>
    </dynamicSelect>
    <update method="update" id="updKnbClac" longname="更新销户登记簿记录">
        <sql><![CDATA[update knb_clac set status=#clstat#, closam=#closam#,crcycd=#crcycd#,tmstmp=#tmstmp# where custac=#custac# and status=#oldtat#]]></sql>
        <sql type="oracle"><![CDATA[update knb_clac set status=#clstat#, closam=#closam#,crcycd=#crcycd#,tmstmp=#tmstmp# where custac=#custac# and status=#oldtat#]]></sql>
        <sql type="mysql"><![CDATA[update knb_clac set status=#clstat#, closam=#closam#,crcycd=#crcycd#,tmstmp=#tmstmp# where custac=#custac# and status=#oldtat#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="clstat" jdbcType="VARCHAR" javaType="DpEnumType.E_CLSTAT" mode="in" longname="状态" parameterType="condition"/>
            <parameter property="oldtat" jdbcType="VARCHAR" javaType="DpEnumType.E_CLSTAT" mode="in" longname="旧状态" parameterType="condition"/>
            <parameter property="closam" jdbcType="VARCHAR" javaType="BaseType.U_TRANAM" mode="in" longname="销户金额" parameterType="condition"/>
            <parameter property="crcycd" jdbcType="VARCHAR" javaType="BaseType.U_CRCYCD" mode="in" longname="币种" parameterType="condition"/>
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="tmstmp" ref="ApDict.Aplt.tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <select cache="none" method="selectOne" type="sql" id="selKnbClacByClossq" longname="查询销户登记簿">
        <sql><![CDATA[select a.* from knb_clac a where a.clossq=#clossq#]]></sql>
        <sql type="oracle"><![CDATA[select a.* from knb_clac a where a.clossq=#clossq#]]></sql>
        <sql type="mysql"><![CDATA[select a.* from knb_clac a where a.clossq=#clossq#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="clossq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="销户流水" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTable.IoCaKnbClac"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnbClacBySignleStat" longname="查询销户登记簿">
        <sql><![CDATA[select a.* from knb_clac a where a.custac=#custac# and a.status = #status#]]></sql>
        <sql type="oracle"><![CDATA[select a.* from knb_clac a where a.custac=#custac# and a.status = #status#]]></sql>
        <sql type="mysql"><![CDATA[select a.* from knb_clac a where a.custac=#custac# and a.status = #status#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUSTAC" mode="in" longname="负债账号" parameterType="condition"/>
            <parameter property="status" jdbcType="VARCHAR" javaType="DpEnumType.E_CLSTAT" mode="in" longname="销户状态" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTable.IoCaKnbClac"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnbClacByDoubleStat" longname="查询未完成的销户登记记录">
        <sql><![CDATA[select a.* from knb_clac a where a.custac=#custac# and (a.status = #status#  or a.status=#status2#)]]></sql>
        <sql type="oracle"><![CDATA[select a.* from knb_clac a where a.custac=#custac# and (a.status = #status#  or a.status=#status2#)]]></sql>
        <sql type="mysql"><![CDATA[select a.* from knb_clac a where a.custac=#custac# and (a.status = #status#  or a.status=#status2#)]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUSTAC" mode="in" longname="负债账号" parameterType="condition"/>
            <parameter property="status" jdbcType="VARCHAR" javaType="DpEnumType.E_CLSTAT" mode="in" longname="销户状态" parameterType="condition"/>
            <parameter property="status2" jdbcType="VARCHAR" javaType="DpEnumType.E_CLSTAT" mode="in" longname="销户状态2" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTable.IoCaKnbClac"/>
    </select>
    <update method="update" id="updKnbClacStat" longname="更新销户登记簿状态">
        <sql><![CDATA[update knb_clac set status=#clstat#,tmstmp=#tmstmp# where custac=#custac# and status=#oldtat#]]></sql>
        <sql type="oracle"><![CDATA[update knb_clac set status=#clstat#,tmstmp=#tmstmp# where custac=#custac# and status=#oldtat#]]></sql>
        <sql type="mysql"><![CDATA[update knb_clac set status=#clstat#,tmstmp=#tmstmp# where custac=#custac# and status=#oldtat#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="clstat" jdbcType="VARCHAR" javaType="DpEnumType.E_CLSTAT" mode="in" longname="状态" parameterType="condition"/>
            <parameter property="oldtat" jdbcType="VARCHAR" javaType="DpEnumType.E_CLSTAT" mode="in" longname="旧状态" parameterType="condition"/>
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="tmstmp" ref="ApDict.Aplt.tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <update method="update" id="updKnbClacStatBySeq" longname="更新销户登记簿状态">
        <sql><![CDATA[update knb_clac set status=#clstat#,tmstmp=#tmstmp# where clossq=#clossq#]]></sql>
        <sql type="oracle"><![CDATA[update knb_clac set status=#clstat#,tmstmp=#tmstmp# where clossq=#clossq#]]></sql>
        <sql type="mysql"><![CDATA[update knb_clac set status=#clstat#,tmstmp=#tmstmp# where clossq=#clossq#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="clstat" jdbcType="VARCHAR" javaType="DpEnumType.E_CLSTAT" mode="in" longname="状态" parameterType="condition"/>
            <parameter property="clossq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="销户流水" parameterType="condition"/>
            <parameter property="tmstmp" ref="ApDict.Aplt.tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <update method="update" id="updKnaAcctClose" longname="更新负债活期账户表的销户状态">
        <sql><![CDATA[update kna_acct set 
clossq = #clossq#, 
closdt=#closdt#,
onlnbl=#onlnbl#,
lastbl=#lastbl#,
upbldt=#upbldt#,
acctst=#acctst#,
lstrdt=#closdt#,
tmstmp=#tmstmp#
where acctno=#acctno# and corpno=#corpno# ]]></sql>
        <sql type="oracle"><![CDATA[update kna_acct set 
clossq = #clossq#, 
closdt=#closdt#,
onlnbl=#onlnbl#,
lastbl=#lastbl#,
upbldt=#upbldt#,
acctst=#acctst#,
lstrdt=#closdt#,
tmstmp=#tmstmp#
where acctno=#acctno# and corpno=#corpno# ]]></sql>
        <sql type="mysql"><![CDATA[update kna_acct set 
clossq = #clossq#, 
closdt=#closdt#,
onlnbl=#onlnbl#,
lastbl=#lastbl#,
upbldt=#upbldt#,
acctst=#acctst#,
lstrdt=#closdt#,
tmstmp=#tmstmp#
where acctno=#acctno# and corpno=#corpno# ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="clossq" jdbcType="VARCHAR" javaType="PbBaseType.U_TRNSEQ" mode="in" longname="销户流水" parameterType="condition"/>
            <parameter property="closdt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="销户日期" parameterType="condition"/>
            <parameter property="acctst" jdbcType="VARCHAR" javaType="BaseEnumType.E_DPACST" mode="in" longname="子账户状态" parameterType="condition"/>
            <parameter property="onlnbl" jdbcType="VARCHAR" javaType="BaseType.U_TRANAM" mode="in" longname="余额" parameterType="condition"/>
            <parameter property="lastbl" jdbcType="VARCHAR" javaType="BaseType.U_TRANAM" mode="in" longname="上日余额" parameterType="condition"/>
            <parameter property="upbldt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="余额更新日期" parameterType="condition"/>
            <parameter property="acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="子账号" parameterType="condition"/>
            <parameter property="corpno" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
            <parameter property="tmstmp" ref="ApDict.Aplt.tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <update method="update" id="updKnaFxacClose" longname="更新负债定期账户表中的销户状态">
        <sql><![CDATA[update kna_fxac set 
clossq = #clossq#, 
closdt=#closdt#,
onlnbl=#onlnbl#,
lastbl=#lastbl#,
upbldt=#upbldt#,
acctst=#acctst#,
lstrdt=#closdt#,
tmstmp=#tmstmp#
where acctno=#acctno# and corpno=#corpno# ]]></sql>
        <sql type="oracle"><![CDATA[update kna_fxac set 
clossq = #clossq#, 
closdt=#closdt#,
onlnbl=#onlnbl#,
lastbl=#lastbl#,
upbldt=#upbldt#,
acctst=#acctst#,
lstrdt=#closdt#,
tmstmp=#tmstmp#
where acctno=#acctno# and corpno=#corpno# ]]></sql>
        <sql type="mysql"><![CDATA[update kna_fxac set 
clossq = #clossq#, 
closdt=#closdt#,
onlnbl=#onlnbl#,
lastbl=#lastbl#,
upbldt=#upbldt#,
acctst=#acctst#,
lstrdt=#closdt#,
tmstmp=#tmstmp#
where acctno=#acctno# and corpno=#corpno# ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="clossq" jdbcType="VARCHAR" javaType="PbBaseType.U_TRNSEQ" mode="in" longname="销户流水" parameterType="condition"/>
            <parameter property="closdt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="销户日期" parameterType="condition"/>
            <parameter property="acctst" jdbcType="VARCHAR" javaType="BaseEnumType.E_DPACST" mode="in" longname="子账户状态" parameterType="condition"/>
            <parameter property="onlnbl" jdbcType="VARCHAR" javaType="BaseType.U_TRANAM" mode="in" longname="余额" parameterType="condition"/>
            <parameter property="lastbl" jdbcType="VARCHAR" javaType="BaseType.U_TRANAM" mode="in" longname="上日余额" parameterType="condition"/>
            <parameter property="upbldt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="余额更新日期" parameterType="condition"/>
            <parameter property="acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="子账号" parameterType="condition"/>
            <parameter property="corpno" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
            <parameter property="tmstmp" ref="ApDict.Aplt.tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <select cache="none" method="selectOne" type="sql" id="selCustInfoByCustid" longname="根据用户ID获取电子账号信息">
        <sql type="db2"><![CDATA[select acdc.cardno, cust.custac, cust.custna, cust.brchno from cif_cust_accs accs 
inner join kna_cust cust on(accs.custno = cust.custno and cust.acctst <> '2')
inner join kna_acdc acdc on(cust.custac = acdc.custac)
inner join kna_cuad e on(acdc.CUSTAC = e.CUSTAC and accs.custid = e.custid)
inner join knp_acst f on(e.dime01=f.dime01
and e.dime02=f.dime02 and e.dime03=f.dime03 and e.dime04=f.dime04
and e.dime05=f.dime05 and e.dime06=f.dime06 and e.prcscd=f.prcscd and f.corpno=#corpno#)
where f.CUACST  != '2' and f.CUACST !='9' and f.CUACST !='8' and f.CUACST !='7'
and accs.custid = #custid#
and accs.STATUS = '1']]></sql>
        <sql type="oracle"><![CDATA[select acdc.cardno, cust.custac, cust.custna, cust.brchno from cif_cust_accs accs 
inner join kna_cust cust on(accs.custno = cust.custno and cust.acctst <> '2')
inner join kna_acdc acdc on(cust.custac = acdc.custac)
inner join kna_cuad e on(acdc.CUSTAC = e.CUSTAC and accs.custid = e.custid)
inner join knp_acst f on(e.dime01=f.dime01
and e.dime02=f.dime02 and e.dime03=f.dime03 and e.dime04=f.dime04
and e.dime05=f.dime05 and e.dime06=f.dime06 and e.prcscd=f.prcscd and f.corpno=#corpno#)
where f.CUACST  != '2' and f.CUACST !='9' and f.CUACST !='8' and f.CUACST !='7'
and accs.custid = #custid#
and accs.STATUS = '1']]></sql>
        <sql type="mysql"><![CDATA[select acdc.cardno, cust.custac, cust.custna, cust.brchno from cif_cust_accs accs 
inner join kna_cust cust on(accs.custno = cust.custno and cust.acctst <> '2')
inner join kna_acdc acdc on(cust.custac = acdc.custac)
inner join kna_cuad e on(acdc.CUSTAC = e.CUSTAC and accs.custid = e.custid)
inner join knp_acst f on(e.dime01=f.dime01
and e.dime02=f.dime02 and e.dime03=f.dime03 and e.dime04=f.dime04
and e.dime05=f.dime05 and e.dime06=f.dime06 and e.prcscd=f.prcscd and f.corpno=#corpno#)
where f.CUACST  != '2' and f.CUACST !='9' and f.CUACST !='8' and f.CUACST !='7'
and accs.custid = #custid#
and accs.STATUS = '1']]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custid" ref="BaseDict.Comm.custid" jdbcType="VARCHAR" javaType="BaseType.U_CUSTID" mode="in" longname="用户ID" parameterType="condition"/>
            <parameter property="corpno" ref="BaseDict.Comm.corpno" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.util.Map">
            <result property="custac" javaType="BaseType.U_CUACNO" jdbcType="VARCHAR" column="custac"/>
            <result property="custna" javaType="BaseType.U_ACCTNA" jdbcType="VARCHAR" column="custna"/>
            <result property="cardno" javaType="BaseType.U_CARDNO" jdbcType="VARCHAR" column="cardno"/>
            <result property="brchno" javaType="BaseType.U_BRCHNO" jdbcType="VARCHAR" column="brchno"/>
        </resultMap>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnaWactByAcctno" longname="根据负债账号查询亲情钱包账户信息">
        <sql><![CDATA[select acct.* from kna_acct acct where acct.acctno = #acctno# and acct.acsetp = '03']]></sql>
        <sql type="oracle"><![CDATA[select acct.* from kna_acct acct where acct.acctno = #acctno# and acct.acsetp = '03']]></sql>
        <sql type="mysql"><![CDATA[select acct.* from kna_acct acct where acct.acctno = #acctno# and acct.acsetp = '03']]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" ref="WaDict.WaAcc.acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="负债账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="WaAcctType.IoWaKnaWact"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnlSpndInfo" longname="查询消费登记薄信息">
        <sql><![CDATA[select * from knl_spnd spnd where spnd.servsq = #servsq#  and spnd.servdt = #servdt#]]></sql>
        <sql type="oracle"><![CDATA[select * from knl_spnd spnd where spnd.servsq = #servsq#  and spnd.servdt = #servdt#]]></sql>
        <sql type="mysql"><![CDATA[select * from knl_spnd spnd where spnd.servsq = #servsq#  and spnd.servdt = #servdt#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="servsq" ref="DpDict.Acct.servsq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="渠道流水" parameterType="condition"/>
            <parameter property="servdt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="渠道日期" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDepoBusiMain.KnlSpnd"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnaAcdcByCardno" longname="根据卡号查询卡客户账号对照表信息信息">
        <sql desc="查询状态为正常的卡客户账号对照表"><![CDATA[select a.* from kna_acdc a where a.STATUS ='1' 
and a.cardno = #cardno#]]></sql>
        <sql type="oracle"><![CDATA[select a.* from kna_acdc a where a.STATUS ='1' 
and a.cardno = #cardno#]]></sql>
        <sql type="mysql"><![CDATA[select a.* from kna_acdc a where a.STATUS ='1' 
and a.cardno = #cardno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="cardno" ref="BaseDict.Comm.cardno" jdbcType="VARCHAR" javaType="BaseType.U_CARDNO" mode="in" longname="交易卡号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTable.IoCaKnaAcdc"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnaAccsByAcctNo" longname="根据负债子账号查询电子账号">
        <sql><![CDATA[select a.custac from kna_accs a where a.acctno = #acctno#]]></sql>
        <sql type="oracle"><![CDATA[select a.custac from kna_accs a where a.acctno = #acctno#]]></sql>
        <sql type="mysql"><![CDATA[select a.custac from kna_accs a where a.acctno = #acctno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" ref="DpDict.Acct.acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="负债账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.lang.String"/>
    </select>
    <update method="update" id="updKnaAcalStatusByCustac" longname="根据电子账号更新账户别名状态">
        <sql type="db2"><![CDATA[update kna_acal a set a.ACALST = #acalst#  ,a.tmstmp =#tmstmp# where a.custac = #custac#]]></sql>
        <sql type="oracle"><![CDATA[update kna_acal a set a.ACALST = #acalst#  ,a.tmstmp =#tmstmp# where a.custac = #custac#]]></sql>
        <sql type="mysql"><![CDATA[update kna_acal a set a.ACALST = #acalst#  ,a.tmstmp =#tmstmp# where a.custac = #custac#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acalst" ref="CaDict.Eacct.acalst" jdbcType="VARCHAR" javaType="CaEnumType.E_ACALST" mode="in" longname="关联状态" parameterType="condition"/>
            <parameter property="custac" ref="CaDict.Eacct.custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="tmstmp" ref="ApDict.Aplt.tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <update method="update" id="updCifCustAccsStatusByCustac" longname="根据电子账号更新客户信息关联状态">
        <sql type="db2"><![CDATA[update cif_cust_accs a set a.status = #status#
		where a.custno = #custno#
		and a.status = '1']]></sql>
        <sql type="oracle"><![CDATA[update cif_cust_accs a set a.status = #status#
		where a.custno = #custno#
		and a.status = '1']]></sql>
        <sql type="mysql"><![CDATA[update cif_cust_accs a set a.status = #status#
		where a.custno = #custno#
		and a.status = '1']]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="status" jdbcType="VARCHAR" javaType="BaseEnumType.E_STATUS" mode="in" longname="关联状态" parameterType="condition"/>
            <parameter property="custno" ref="BaseDict.Comm.custno" jdbcType="VARCHAR" javaType="BaseType.U_CUSTNO" mode="in" longname="客户号" parameterType="condition"/>
        </parameterMap>
    </update>
    <select cache="none" method="selectOne" type="sql" id="selIdtfnoByCardno" longname="根据虚拟卡号查询证件号码">
        <sql type="db2"><![CDATA[select a.IDTFNO from cif_cust a 
inner join kna_cust b on(a.CUSTNO = b.CUSTNO)
inner join kna_acdc c on(b.CUSTAC = c.CUSTAC)
where c.cardno = #cardno#]]></sql>
        <sql type="oracle"><![CDATA[select a.IDTFNO from cif_cust a 
inner join kna_cust b on(a.CUSTNO = b.CUSTNO)
inner join kna_acdc c on(b.CUSTAC = c.CUSTAC)
where c.cardno = #cardno#]]></sql>
        <sql type="mysql"><![CDATA[select a.IDTFNO from cif_cust a 
inner join kna_cust b on(a.CUSTNO = b.CUSTNO)
inner join kna_acdc c on(b.CUSTAC = c.CUSTAC)
where c.cardno = #cardno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="cardno" ref="BaseDict.Comm.cardno" jdbcType="VARCHAR" javaType="BaseType.U_CARDNO" mode="in" longname="交易卡号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.lang.String">
            <result property="idtfno" javaType="BaseType.U_IDTFNO" jdbcType="VARCHAR" column="idtfno"/>
        </resultMap>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selKnsAcsqCler" longname="查询会计流水清算信息">
        <sql><![CDATA[
		   
			select a.*
			from kns_acsq_cler a
			where 	a.trandt=#trandt# and a.mntrsq=#mntrsq# ]]></sql>
        <sql type="oracle"><![CDATA[
		   
			select a.*
			from kns_acsq_cler a
			where 	a.trandt=#trandt# and a.mntrsq=#mntrsq# ]]></sql>
        <sql type="mysql"><![CDATA[
		   
			select a.*
			from kns_acsq_cler a
			where 	a.trandt=#trandt# and a.mntrsq=#mntrsq# ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="trandt" ref="BaseDict.Comm.trandt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="mntrsq" ref="DpDict.Froz.mntrsq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="主交易流水" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoAccountComplexType.IoAccountClearInfo"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selKnaFxacDetlByAcctEsc" longname="按照先进先出规则查询明细">
        <sql><![CDATA[select * from kna_fxac_detl where acctno = #acctno# and acctst = '1' order by opendt]]></sql>
        <sql type="db2"><![CDATA[select * from kna_fxac_detl where acctno = #acctno# and acctst = '1' order by opendt]]></sql>
        <sql type="oracle"><![CDATA[select * from kna_fxac_detl where acctno = #acctno# and acctst = '1' order by opendt]]></sql>
        <sql type="mysql"><![CDATA[select * from kna_fxac_detl where acctno = #acctno# and acctst = '1' order by opendt]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" ref="DpDict.Acct.acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="负债账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDepoBusiMain.KnaFxacDetl"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selAcctBachTransferCount" longname="查询电子账户批量转账总笔数">
        <sql type="db2"><![CDATA[select count(1) from knb_acct_bach where filesq = #filesq#]]></sql>
        <sql type="oracle"><![CDATA[select count(1) from knb_acct_bach where filesq = #filesq#]]></sql>
        <sql type="mysql"><![CDATA[select count(1) from knb_acct_bach where filesq = #filesq#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="filesq" jdbcType="VARCHAR" javaType="BaseType.U_CHAR40" mode="in" longname="文件批次号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="long"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selDataidByFilesq" longname="查询批次作业号">
        <sql type="db2"><![CDATA[select distinct dataid from knb_acct_bach where filesq=#filesq#  and sourdt=#sourdt#]]></sql>
        <sql type="oracle"><![CDATA[select distinct dataid from knb_acct_bach where filesq=#filesq#  and sourdt=#sourdt#]]></sql>
        <sql type="mysql"><![CDATA[select distinct dataid from knb_acct_bach where filesq=#filesq#  and sourdt=#sourdt#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="filesq" jdbcType="VARCHAR" javaType="BaseType.U_CHAR40" mode="in" longname="文件批次号" parameterType="condition"/>
            <parameter property="sourdt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="来源方日期" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.lang.String"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selAcctTranferInfo" longname="查询电子账户批量转账信息">
        <sql type="db2"><![CDATA[select * from knb_acct_bach where filesq=#filesq# and dataid=#dataid# and sourdt=#sourdt# and transt <> '9']]></sql>
        <sql type="mysql"><![CDATA[select * from knb_acct_bach where filesq=#filesq# and dataid=#dataid# and sourdt=#sourdt# and transt <> '9']]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="filesq" jdbcType="VARCHAR" javaType="BaseType.U_CHAR40" mode="in" longname="文件批次号" parameterType="condition"/>
            <parameter property="sourdt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="来源方日期" parameterType="condition"/>
            <parameter property="dataid" jdbcType="VARCHAR" javaType="BaseType.U_CHAR16" mode="in" longname="作业id" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDepoBusiMain.KnbAcctBach"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selGroupCountByFilesqAndSourdt" longname="查询电子账户处理笔数和处理状态">
        <sql type="db2"><![CDATA[select transt,count(1) record from knb_acct_bach where filesq=#filesq# and sourdt=#sourdt# group by transt]]></sql>
        <sql type="oracle"><![CDATA[select transt,count(1) record from knb_acct_bach where filesq=#filesq# and sourdt=#sourdt# group by transt]]></sql>
        <sql type="mysql"><![CDATA[select transt,count(1) record from knb_acct_bach where filesq=#filesq# and sourdt=#sourdt# group by transt]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="filesq" jdbcType="VARCHAR" javaType="BaseType.U_CHAR40" mode="in" longname="文件批次号" parameterType="condition"/>
            <parameter property="sourdt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="来源方日期" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.util.Map">
            <result property="transt" javaType="BaseEnumType.E_TRANST" column="transt"/>
            <result property="record" javaType="BaseType.U_LONGIN" column="record"/>
        </resultMap>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selBatchWriteData" longname="查询电子账户批量转账写文集数据">
        <sql type="db2"><![CDATA[select * from knb_acct_bach where filesq=#filesq# and sourdt=#sourdt#]]></sql>
        <sql type="oracle"><![CDATA[select * from knb_acct_bach where filesq=#filesq# and sourdt=#sourdt#]]></sql>
        <sql type="mysql"><![CDATA[select * from knb_acct_bach where filesq=#filesq# and sourdt=#sourdt#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="filesq" jdbcType="VARCHAR" javaType="BaseType.U_CHAR40" mode="in" longname="文件批次号" parameterType="condition"/>
            <parameter property="sourdt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="来源方交易日期" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDepoBusiMain.KnbAcctBach"/>
    </select>
    <update method="update" id="updKnaRelt" longname="亲情钱包销户更新信息">
        <sql><![CDATA[update kna_relt a set  a.reltst = '2', a.clostx = '1' , a.closfg = '1'  ,a.tmstmp =#tmstmp# where a.acctno = #acctno#]]></sql>
        <sql type="oracle"><![CDATA[update kna_relt a set  a.reltst = '2', a.clostx = '1' , a.closfg = '1'  ,a.tmstmp =#tmstmp# where a.acctno = #acctno#]]></sql>
        <sql type="mysql"><![CDATA[update kna_relt a set  a.reltst = '2', a.clostx = '1' , a.closfg = '1'  ,a.tmstmp =#tmstmp# where a.acctno = #acctno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="亲情钱包负债账号" parameterType="condition"/>
            <parameter property="tmstmp" ref="ApDict.Aplt.tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <select cache="none" method="selectOne" type="sql" id="selknaReltId" longname="根据负债账号查询亲情关系ID">
        <sql><![CDATA[select * from kna_relt a where a.acctno = #acctno#]]></sql>
        <sql type="oracle"><![CDATA[select * from kna_relt a where a.acctno = #acctno#]]></sql>
        <sql type="mysql"><![CDATA[select * from kna_relt a where a.acctno = #acctno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="亲情钱包负债账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="WaAcctType.IoWaKnaRelt"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selCUPSCountByTrandt" longname="查询清算对账文件记录条数">
        <sql><![CDATA[select count(1) from knl_iobl_cups where unkpdt = #trandt# and transt='1']]></sql>
        <sql type="oracle"><![CDATA[select count(1) from knl_iobl_cups where unkpdt = #trandt# and transt='1']]></sql>
        <sql type="mysql"><![CDATA[select count(1) from knl_iobl_cups where unkpdt = #trandt# and transt='1']]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="trandt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" parameterType="condition"/>
        </parameterMap>
        <resultMap class="long"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selCUPSCheckDetail" longname="查询清算对账文件明细记录">
        <sql><![CDATA[select * from knl_iobl_cups where unkpdt = #trandt# and transt = '1']]></sql>
        <sql type="oracle"><![CDATA[select * from knl_iobl_cups where unkpdt = #trandt# and transt = '1']]></sql>
        <sql type="mysql"><![CDATA[select * from knl_iobl_cups where unkpdt = #trandt# and transt = '1']]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="trandt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDepoBusiMain.KnlIoblCups"/>
    </select>
    <dynamicSelect cache="none" method="selectAll" type="sql" id="selKnsProdCler" longname="查询产品核算信息">
        <parameterMap class="java.util.Map">
            <parameter property="corpno" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
            <parameter property="prodcd" ref="PbDict.Dcmt.prodcd" jdbcType="VARCHAR" javaType="BaseType.U_CHAR32" mode="in" longname="产品代码" parameterType="condition"/>
            <parameter property="eventp" jdbcType="VARCHAR" javaType="BaseType.U_CHAR08" mode="in" longname="交易类型" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoAccountComplexType.IoKnsProdClerInfo"/>
        <dynamicSql type="db2">
            <str type="Str"><![CDATA[select a.* from kns_prod_cler a ]]></str>
            <where type="Where">
                <and type="And">
                    <if test="prodcd !=null&amp;&amp;prodcd !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[prodcd =#prodcd#]]></str>
                    </if>
                    <if test="eventp!=null&amp;&amp;eventp!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[eventp=#eventp#]]></str>
                    </if>
                    <if test="corpno != null" type="If">
                        <str type="Str"><![CDATA[a.corpno = #corpno#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select a.* from kns_prod_cler a ]]></str>
            <where type="Where">
                <and type="And">
                    <if test="prodcd !=null&amp;&amp;prodcd !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[prodcd =#prodcd#]]></str>
                    </if>
                    <if test="eventp!=null&amp;&amp;eventp!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[eventp=#eventp#]]></str>
                    </if>
                    <if test="corpno != null" type="If">
                        <str type="Str"><![CDATA[a.corpno = #corpno#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[select a.* from kns_prod_cler a ]]></str>
            <where type="Where">
                <and type="And">
                    <if test="prodcd !=null&amp;&amp;prodcd !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[prodcd =#prodcd#]]></str>
                    </if>
                    <if test="eventp!=null&amp;&amp;eventp!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[eventp=#eventp#]]></str>
                    </if>
                    <if test="corpno != null" type="If">
                        <str type="Str"><![CDATA[a.corpno = #corpno#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
    </dynamicSelect>
    <select cache="none" method="selectOne" type="sql" id="selKnbParaMenuBusino" longname="产品内部户产品名称">
        <sql type="db2"><![CDATA[select busina as valuna from gl_knp_busi where busino =#codevl# and corpno = #corpno#]]></sql>
        <sql type="oracle"><![CDATA[select busina as valuna from gl_knp_busi where busino =#codevl# and corpno = #corpno#]]></sql>
        <sql type="mysql"><![CDATA[select busina as valuna from gl_knp_busi where busino =#codevl# and corpno = #corpno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="codevl" jdbcType="VARCHAR" javaType="BaseType.U_CHAR100" mode="in" longname="值代码" parameterType="condition"/>
            <parameter property="corpno" jdbcType="VARCHAR" javaType="string" mode="in" longname="法人号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.lang.String">
            <result property="valuna" javaType="BaseType.U_CHAR80" column="valuna"/>
        </resultMap>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnaAcdcInfoByCardno" longname="根据电子账号查询电子账户Id信息">
        <sql type="db2"><![CDATA[select a.* from kna_acdc a where a.cardno = #cardno#]]></sql>
        <sql type="oracle"><![CDATA[select a.* from kna_acdc a where a.cardno = #cardno#]]></sql>
        <sql type="mysql"><![CDATA[select a.* from kna_acdc a where a.cardno = #cardno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="cardno" ref="DpDict.Acct.cardno" jdbcType="VARCHAR" javaType="BaseType.U_CARDNO" mode="in" longname="卡号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoDpProdQuery.IoDpAcdcOut"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selKnaCacdInfoByCustac" longname="根据电子账号查询外部卡与客户账户对照表">
        <sql type="db2"><![CDATA[select * from kna_cacd a where a.custac = #custac# and a.status = #status#]]></sql>
        <sql type="oracle"><![CDATA[select * from kna_cacd a where a.custac = #custac# and a.status = #status#]]></sql>
        <sql type="mysql"><![CDATA[select * from kna_cacd a where a.custac = #custac# and a.status = #status#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" ref="CaDict.Eacct.custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="status" jdbcType="VARCHAR" javaType="BaseEnumType.E_DPACST" mode="in" longname="账户状态" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTable.IoCaKnaCacd"/>
    </select>
    <update method="update" id="updKnaAccsClose" longname="更新负债账户客户账户对照表销户状态">
        <sql type="db2"><![CDATA[update kna_accs set 
acctst=#acctst#,
tmstmp=#tmstmp#
where acctno=#acctno# and corpno=#corpno# ]]></sql>
        <sql type="oracle"><![CDATA[update kna_accs set 
acctst=#acctst#,
tmstmp=#tmstmp#
where acctno=#acctno# and corpno=#corpno# ]]></sql>
        <sql type="mysql"><![CDATA[update kna_accs set 
acctst=#acctst#,
tmstmp=#tmstmp#
where acctno=#acctno# and corpno=#corpno# ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctst" jdbcType="VARCHAR" javaType="BaseEnumType.E_DPACST" mode="in" longname="子账户状态" parameterType="condition"/>
            <parameter property="acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="负债账号" parameterType="condition"/>
            <parameter property="corpno" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
            <parameter property="tmstmp" ref="ApDict.Aplt.tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <select cache="none" method="selectOne" type="sql" id="selKnlbillHisacctbl" longname="查询电子账户结算户历史余额">
        <sql type="db2"><![CDATA[select sum(a.acctbl) as  tranam from knl_bill a inner join 
(select u.acctno,max(u.detlsq) as detlsq from knl_bill u where u.custac = #custac# and u.trandt <=#trandt# group by u.acctno) b 
on(a.acctno = b.acctno and a.detlsq = b.detlsq)]]></sql>
        <sql type="oracle"><![CDATA[select sum(a.acctbl) as  tranam from knl_bill a inner join 
(select u.acctno,max(u.detlsq) as detlsq from knl_bill u where u.custac = #custac# and u.trandt <=#trandt# group by u.acctno) b 
on(a.acctno = b.acctno and a.detlsq = b.detlsq)]]></sql>
        <sql type="mysql"><![CDATA[select sum(a.acctbl) as  tranam from knl_bill a inner join 
(select u.acctno,max(u.detlsq) as detlsq from knl_bill u where u.custac = #custac# and u.trandt <=#trandt# group by u.acctno) b 
on(a.acctno = b.acctno and a.detlsq = b.detlsq)]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="trandt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" parameterType="condition"/>
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUSTAC" mode="in" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoDpFrozComplexType.IofrozInfo"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selKnlBillByTransq" longname="通过交易流水查询账户余额发生明细">
        <sql type="db2"><![CDATA[select a.* from knl_bill a where a.transq = #transq#  and a.trandt= #trandt#]]></sql>
        <sql type="oracle"><![CDATA[select a.* from knl_bill a where a.transq = #transq#  and a.trandt= #trandt#]]></sql>
        <sql type="mysql"><![CDATA[select a.* from knl_bill a where a.transq = #transq#  and a.trandt= #trandt#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="transq" ref="DpDict.Acct.transq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="主交易流水" parameterType="condition"/>
            <parameter property="trandt" ref="DpDict.Froz.trandt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="交易日期" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoDpTable.IoDpKnlBill"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selHknlBillByTransq" longname="通过交易流水查询账户余额明细历史表">
        <sql type="db2"><![CDATA[select a.* from h_knl_bill a where a.transq = #transq#  and a.trandt= #trandt#]]></sql>
        <sql type="oracle"><![CDATA[select a.* from h_knl_bill a where a.transq = #transq#  and a.trandt= #trandt#]]></sql>
        <sql type="mysql"><![CDATA[select a.* from h_knl_bill a where a.transq = #transq#  and a.trandt= #trandt#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="transq" ref="DpDict.Acct.transq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="主交易流水" parameterType="condition"/>
            <parameter property="trandt" ref="DpDict.Froz.trandt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="交易日期" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoDpTable.IoDpHKnlBill"/>
    </select>
    <select cache="none" method="selectPageWithCount" type="sql" id="selAcctno" longname="查询电子账号关联负债账号">
        <sql type="db2"><![CDATA[select d.* from( select b.acctno,b.pddpfg faflag,b.crcycd,b.prodcd,b.closdt,b.tmstmp from kna_acdc a, kna_acct b where a.cardno=#cardno# and a.custac = b.custac and b.acctst='2' and b.acsetp in ('04','05','07')
union all 
select c.acctno,c.pddpfg faflag,c.crcycd,c.prodcd,c.closdt,c.tmstmp from kna_acdc a, kna_fxac c where a.cardno=#cardno# and a.custac = c.custac and c.acctst='2' and c.acsetp in ('04','05','07')) 
d order by d.closdt desc,d.tmstmp desc
]]></sql>
        <sql type="oracle"><![CDATA[select d.* from( select b.acctno,b.pddpfg faflag,b.crcycd,b.prodcd,b.closdt,b.tmstmp from kna_acdc a, kna_acct b where a.cardno=#cardno# and a.custac = b.custac and b.acctst='2' and b.acsetp in ('04','05','07')
union all 
select c.acctno,c.pddpfg faflag,c.crcycd,c.prodcd,c.closdt,c.tmstmp from kna_acdc a, kna_fxac c where a.cardno=#cardno# and a.custac = c.custac and c.acctst='2' and c.acsetp in ('04','05','07')) 
d order by d.closdt desc,d.tmstmp desc
]]></sql>
        <sql type="mysql"><![CDATA[select d.* from( select b.acctno,b.pddpfg faflag,b.crcycd,b.prodcd,b.closdt,b.tmstmp from kna_acdc a, kna_acct b where a.cardno=#cardno# and a.custac = b.custac and b.acctst='2' and b.acsetp in ('04','05','07')
union all 
select c.acctno,c.pddpfg faflag,c.crcycd,c.prodcd,c.closdt,c.tmstmp from kna_acdc a, kna_fxac c where a.cardno=#cardno# and a.custac = c.custac and c.acctst='2' and c.acsetp in ('04','05','07')) 
d order by d.closdt desc,d.tmstmp desc
]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="cardno" jdbcType="VARCHAR" javaType="BaseType.U_CARDNO" mode="in" longname="电子账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTable.IoCaSelAcctno"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selCifcustbyCardno" longname="根据电子账号查询客户信息">
        <sql type="db2"><![CDATA[select a.* from cif_cust a where custno = 
(select custno from kna_cust where custac =
 (select custac from kna_acdc  where cardno = #cardno#))]]></sql>
        <sql type="oracle"><![CDATA[select a.* from cif_cust a where custno = 
(select custno from kna_cust where custac =
 (select custac from kna_acdc  where cardno = #cardno#))]]></sql>
        <sql type="mysql"><![CDATA[select a.* from cif_cust a where custno = 
(select custno from kna_cust where custac =
 (select custac from kna_acdc  where cardno = #cardno#))]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="cardno" jdbcType="VARCHAR" javaType="BaseType.U_CARDNO" mode="in" longname="电子账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCuTable.IoCucifCust"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnlSpndByTransq" longname="通过交易流水查询电子账户消费登记簿">
        <sql type="db2"><![CDATA[select a.* from knl_spnd a where a.transq = #transq#]]></sql>
        <sql type="oracle"><![CDATA[select a.* from knl_spnd a where a.transq = #transq#]]></sql>
        <sql type="mysql"><![CDATA[select a.* from knl_spnd a where a.transq = #transq#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="transq" ref="DpDict.Acct.transq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="主交易流水" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoDpTable.ioKnlSpnd"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selCifCustAccsByCustid" longname="根据用户ID查询客户关联关系">
        <sql type="db2"><![CDATA[select accs.*,cust.custac from cif_cust_accs accs 
     left join kna_cust cust on(accs.custno = cust.custno and cust.acctst <> '2')
     where accs.status = '1'  and accs.custid = #custid#]]></sql>
        <sql type="oracle"><![CDATA[select accs.*,cust.custac from cif_cust_accs accs 
     left join kna_cust cust on(accs.custno = cust.custno and cust.acctst <> '2')
     where accs.status = '1'  and accs.custid = #custid#]]></sql>
        <sql type="mysql"><![CDATA[select accs.*,cust.custac from cif_cust_accs accs 
     left join kna_cust cust on(accs.custno = cust.custno and cust.acctst <> '2')
     where accs.status = '1'  and accs.custid = #custid#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custid" jdbcType="VARCHAR" javaType="BaseType.U_CUSTID" mode="in" longname="用户ID" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCuTable.IoCifCustAccs"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selFxacAcctBlncByCustac" longname="根据电子账号查询定期账户余额">
        <sql type="db2"><![CDATA[select sum(onlnbl) total from kna_fxac where custac = #custac#]]></sql>
        <sql type="oracle"><![CDATA[select sum(onlnbl) total from kna_fxac where custac = #custac#]]></sql>
        <sql type="mysql"><![CDATA[select sum(onlnbl) total from kna_fxac where custac = #custac#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" ref="CaDict.Eacct.custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.math.BigDecimal"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selKnbPidlByPyinsq" longname="根据流水查询负债账户付息明细">
        <sql type="db2"><![CDATA[select a.* from knb_pidl a where a.acctno=#acctno# and a.intrsq=#transq#]]></sql>
        <sql type="oracle"><![CDATA[select a.* from knb_pidl a where a.acctno=#acctno# and a.intrsq=#transq#]]></sql>
        <sql type="mysql"><![CDATA[select a.* from knb_pidl a where a.acctno=#acctno# and a.intrsq=#transq#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" ref="DpDict.Acct.acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="负债账号" parameterType="condition"/>
            <parameter property="transq" ref="DpDict.Acct.transq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="主交易流水" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDepoInst.KnbPidl"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnlCaryByTransq" longname="通过交易流水查找电子账户转电子账户登记簿">
        <sql type="db2"><![CDATA[select a.* from knl_cary a where a.TRANSQ = #transq#]]></sql>
        <sql type="oracle"><![CDATA[select a.* from knl_cary a where a.TRANSQ = #transq#]]></sql>
        <sql type="mysql"><![CDATA[select a.* from knl_cary a where a.TRANSQ = #transq#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="transq" ref="BaseDict.Comm.transq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="交易流水" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoDpTable.IoKnlCary"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnbPidlByAcctno" longname="根据负债账号查询负债账号付息明细表">
        <sql><![CDATA[select sum(rlintr)+sum(totlin) from knb_pidl where acctno=#acctno# and indlst='1' and instdt>=#bgindt#]]></sql>
        <sql type="oracle"><![CDATA[select sum(rlintr)+sum(totlin) from knb_pidl where acctno=#acctno# and indlst='1' and instdt>=#bgindt#]]></sql>
        <sql type="mysql"><![CDATA[select sum(rlintr)+sum(totlin) from knb_pidl where acctno=#acctno# and indlst='1' and instdt>=#bgindt#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" ref="DpDict.Acct.acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="负债账号" parameterType="condition"/>
            <parameter property="bgindt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="计息起始日期" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.math.BigDecimal"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnaReltByReltst" longname="根据状态查询本人被开通的亲情钱包数">
        <sql><![CDATA[select count(1) from kna_relt a where a.elacct = #elacct# and a.reltst = #reltst#]]></sql>
        <sql type="oracle"><![CDATA[select count(1) from kna_relt a where a.elacct = #elacct# and a.reltst = #reltst#]]></sql>
        <sql type="mysql"><![CDATA[select count(1) from kna_relt a where a.elacct = #elacct# and a.reltst = #reltst#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="elacct" jdbcType="VARCHAR" javaType="BaseType.U_CUSTAC" mode="in" longname="关联人客户号" parameterType="condition"/>
            <parameter property="reltst" ref="WaDict.WaAcc.reltst" jdbcType="VARCHAR" javaType="WaEnumType.E_RELTST" mode="in" longname="亲情钱包状态" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.lang.Integer"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selCifCustAccsByCustno" longname="根据客户号查询客户关联关系">
        <sql type="db2"><![CDATA[select accs.* from cif_cust_accs accs 
     where accs.status = '1'  and accs.custno = #custno#]]></sql>
        <sql type="mysql"><![CDATA[select accs.* from cif_cust_accs accs 
     where accs.status = '1'  and accs.custno = #custno#]]></sql>
        <sql type="oracle"><![CDATA[select accs.* from cif_cust_accs accs 
     where accs.status = '1'  and accs.custno = #custno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custno" ref="BaseDict.Comm.custno" jdbcType="VARCHAR" javaType="BaseType.U_CUSTNO" mode="in" longname="客户号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCuTable.IoCifCustAccs"/>
    </select>
    <dynamicSelect cache="none" method="selectOne" type="sql" id="selSumEacctBlHWithLock" longname="根据电子账户和币种查询活期总余额">
        <parameterMap class="java.util.Map">
            <parameter property="custac" ref="BaseDict.Comm.custac" jdbcType="VARCHAR" javaType="BaseType.U_CHAR32" mode="in" longname="客户账号" parameterType="condition"/>
            <parameter property="crcycd" ref="BaseDict.Comm.crcycd" jdbcType="VARCHAR" javaType="BaseType.U_CRCYCD" mode="in" longname="币种" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.math.BigDecimal"/>
        <dynamicSql type="db2">
            <str type="Str"><![CDATA[select ifnull(sum(a.onlnbl),0) from kna_acct a ]]></str>
            <where type="Where">
                <and type="And">
                    <if test="crcycd != null" type="If">
                        <str type="Str"><![CDATA[a.crcycd = #crcycd#]]></str>
                    </if>
                    <if test="custac != &quot;&quot; &amp;&amp; custac != null" type="If">
                        <str type="Str"><![CDATA[a.custac = #custac#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select nvl(sum(a.onlnbl),0) from kna_acct a ]]></str>
            <where type="Where">
                <and type="And">
                    <if test="crcycd != null" type="If">
                        <str type="Str"><![CDATA[a.crcycd = #crcycd#]]></str>
                    </if>
                    <if test="custac != &quot;&quot; &amp;&amp; custac != null" type="If">
                        <str type="Str"><![CDATA[a.custac = #custac#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[select ifnull(sum(a.onlnbl),0) from kna_acct a ]]></str>
            <where type="Where">
                <and type="And">
                    <if test="crcycd != null" type="If">
                        <str type="Str"><![CDATA[a.crcycd = #crcycd#]]></str>
                    </if>
                    <if test="custac != &quot;&quot; &amp;&amp; custac != null" type="If">
                        <str type="Str"><![CDATA[a.custac = #custac#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
    </dynamicSelect>
    <dynamicSelect cache="none" method="selectOne" type="sql" id="selSumEacctBlH" longname="根据电子账户和币种查询活期总余额">
        <parameterMap class="java.util.Map">
            <parameter property="custac" ref="BaseDict.Comm.custac" jdbcType="VARCHAR" javaType="BaseType.U_CHAR32" mode="in" longname="客户账号" parameterType="condition"/>
            <parameter property="crcycd" ref="BaseDict.Comm.crcycd" jdbcType="VARCHAR" javaType="BaseType.U_CRCYCD" mode="in" longname="币种" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.math.BigDecimal"/>
        <dynamicSql type="db2">
            <str type="Str"><![CDATA[select ifnull(sum(a.onlnbl),0) from kna_acct a ]]></str>
            <where type="Where">
                <and type="And">
                    <if test="crcycd != null" type="If">
                        <str type="Str"><![CDATA[a.crcycd = #crcycd#]]></str>
                    </if>
                    <if test="custac != &quot;&quot; &amp;&amp; custac != null" type="If">
                        <str type="Str"><![CDATA[a.custac = #custac#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select nvl(sum(a.onlnbl),0) from kna_acct a ]]></str>
            <where type="Where">
                <and type="And">
                    <if test="crcycd != null" type="If">
                        <str type="Str"><![CDATA[a.crcycd = #crcycd#]]></str>
                    </if>
                    <if test="custac != &quot;&quot; &amp;&amp; custac != null" type="If">
                        <str type="Str"><![CDATA[a.custac = #custac#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[select ifnull(sum(a.onlnbl),0) from kna_acct a ]]></str>
            <where type="Where">
                <and type="And">
                    <if test="crcycd != null" type="If">
                        <str type="Str"><![CDATA[a.crcycd = #crcycd#]]></str>
                    </if>
                    <if test="custac != &quot;&quot; &amp;&amp; custac != null" type="If">
                        <str type="Str"><![CDATA[a.custac = #custac#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
    </dynamicSelect>
    <dynamicSelect cache="none" method="selectOne" type="sql" id="selSumEacctBlFxWithLock" longname="根据电子账户和币种查询定期总余额">
        <parameterMap class="java.util.Map">
            <parameter property="custac" ref="BaseDict.Comm.custac" jdbcType="VARCHAR" javaType="BaseType.U_CHAR32" mode="in" longname="客户账号" parameterType="condition"/>
            <parameter property="crcycd" ref="BaseDict.Comm.crcycd" jdbcType="VARCHAR" javaType="BaseType.U_CRCYCD" mode="in" longname="币种" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.math.BigDecimal"/>
        <dynamicSql type="db2">
            <str type="Str"><![CDATA[select ifnull(sum(a.onlnbl),0) from kna_fxac a]]></str>
            <where type="Where">
                <and type="And">
                    <if test="crcycd != null" type="If">
                        <str type="Str"><![CDATA[a.crcycd = #crcycd#]]></str>
                    </if>
                    <if test="custac != &quot;&quot; &amp;&amp; custac != null" type="If">
                        <str type="Str"><![CDATA[a.custac = #custac#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[select ifnull(sum(a.onlnbl),0) from kna_fxac a]]></str>
            <where type="Where">
                <and type="And">
                    <if test="crcycd != null" type="If">
                        <str type="Str"><![CDATA[a.crcycd = #crcycd#]]></str>
                    </if>
                    <if test="custac != &quot;&quot; &amp;&amp; custac != null" type="If">
                        <str type="Str"><![CDATA[a.custac = #custac#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select nvl(sum(a.onlnbl),0) from kna_fxac a]]></str>
            <where type="Where">
                <and type="And">
                    <if test="crcycd != null" type="If">
                        <str type="Str"><![CDATA[a.crcycd = #crcycd#]]></str>
                    </if>
                    <if test="custac != &quot;&quot; &amp;&amp; custac != null" type="If">
                        <str type="Str"><![CDATA[a.custac = #custac#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
    </dynamicSelect>
    <dynamicSelect cache="none" method="selectOne" type="sql" id="selSumEacctBlFx" longname="根据电子账户和币种查询定期总余额">
        <parameterMap class="java.util.Map">
            <parameter property="custac" ref="BaseDict.Comm.custac" jdbcType="VARCHAR" javaType="BaseType.U_CHAR32" mode="in" longname="客户账号" parameterType="condition"/>
            <parameter property="crcycd" ref="BaseDict.Comm.crcycd" jdbcType="VARCHAR" javaType="BaseType.U_CRCYCD" mode="in" longname="币种" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.math.BigDecimal"/>
        <dynamicSql type="db2">
            <str type="Str"><![CDATA[select ifnull(sum(a.onlnbl),0) from kna_fxac a]]></str>
            <where type="Where">
                <and type="And">
                    <if test="crcycd != null" type="If">
                        <str type="Str"><![CDATA[a.crcycd = #crcycd#]]></str>
                    </if>
                    <if test="custac != &quot;&quot; &amp;&amp; custac != null" type="If">
                        <str type="Str"><![CDATA[a.custac = #custac#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[select ifnull(sum(a.onlnbl),0) from kna_fxac a]]></str>
            <where type="Where">
                <and type="And">
                    <if test="crcycd != null" type="If">
                        <str type="Str"><![CDATA[a.crcycd = #crcycd#]]></str>
                    </if>
                    <if test="custac != &quot;&quot; &amp;&amp; custac != null" type="If">
                        <str type="Str"><![CDATA[a.custac = #custac#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select nvl(sum(a.onlnbl),0) from kna_fxac a]]></str>
            <where type="Where">
                <and type="And">
                    <if test="crcycd != null" type="If">
                        <str type="Str"><![CDATA[a.crcycd = #crcycd#]]></str>
                    </if>
                    <if test="custac != &quot;&quot; &amp;&amp; custac != null" type="If">
                        <str type="Str"><![CDATA[a.custac = #custac#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
    </dynamicSelect>
    <select cache="none" method="selectOne" type="sql" id="selKnaAcctWithLock" longname="根据负债账户查询账户信息">
        <sql type="db2"><![CDATA[select  a.* from kna_acct a where a.acctno =#acctno# for update]]></sql>
        <sql type="mysql"><![CDATA[select  a.* from kna_acct a where a.acctno =#acctno# for update]]></sql>
        <sql type="oracle"><![CDATA[select  a.* from kna_acct a where a.acctno =#acctno# for update]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" ref="DpDict.Acct.acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="负债账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDepoBusiMain.KnaAcct"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnaSignDetlInfo" longname="根据负债账号查询签约明细信息">
        <sql type="db2"><![CDATA[select * from kna_sign_detl where fxacct=#acctno#]]></sql>
        <sql type="oracle"><![CDATA[select * from kna_sign_detl where fxacct=#acctno#]]></sql>
        <sql type="mysql"><![CDATA[select * from kna_sign_detl where fxacct=#acctno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" ref="DpDict.Acct.acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="负债账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTable.IoCaKnaSignDetl"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnbPidlInfoByCurAcct" longname="根据活期账号查询负债账户付息明细表">
        <sql type="db2"><![CDATA[select sum(rlintr) from knb_pidl where acctno=#acctno#]]></sql>
        <sql type="oracle"><![CDATA[select sum(rlintr) from knb_pidl where acctno=#acctno#]]></sql>
        <sql type="mysql"><![CDATA[select sum(rlintr) from knb_pidl where acctno=#acctno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" ref="DpDict.Acct.acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="负债账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.math.BigDecimal"/>
    </select>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selAllHqTranDetl" longname="查询电子账户活期账户交易明细(含已销户)（客户端）">
        <parameterMap class="java.util.Map">
            <parameter property="acctno" jdbcType="VARCHAR" javaType="BaseType.U_CHAR1000" mode="in" longname="负债账号" parameterType="condition"/>
            <parameter property="crcycd" jdbcType="VARCHAR" javaType="BaseType.U_CRCYCD" mode="in" longname="币种" parameterType="condition"/>
            <parameter property="bgindt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="起始日期" parameterType="condition"/>
            <parameter property="endddt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="终止日期" parameterType="condition"/>
            <parameter property="smrycd" ref="BaseDict.Comm.smrycd" jdbcType="VARCHAR" javaType="BaseType.U_SMRYCD" mode="in" longname="摘要代码" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoDpTable.IoDpTranDetlHqQryAcct"/>
        <dynamicSql type="db2">
            <str type="Str"><![CDATA[select trandt,trantm,tranam,acctbl,trancy crcycd,csextg,amntcd,opcuac,opacna opcuna,tranbr,servtp,smrycd,smryds,remark,tmstmp,machdt from knl_bill]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[acctno in (${acctno}) and trancy = #crcycd#]]></str>
                    <if test="bgindt!=null&amp;&amp;bgindt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[trandt between #bgindt# and #endddt#]]></str>
                    </if>
                    <if test="smrycd!=null&amp;&amp;smrycd!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[smrycd = #smrycd#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by trandt desc,acctno desc, detlsq desc]]></str>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[select trandt,trantm,tranam,acctbl,trancy crcycd,csextg,amntcd,opcuac,opacna opcuna,tranbr,servtp,smrycd,smryds,remark,tmstmp,machdt from knl_bill]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[acctno in (${acctno}) and trancy = #crcycd#]]></str>
                    <if test="bgindt!=null&amp;&amp;bgindt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[trandt between #bgindt# and #endddt#]]></str>
                    </if>
                    <if test="smrycd!=null&amp;&amp;smrycd!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[smrycd = #smrycd#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by trandt desc,acctno desc, detlsq desc]]></str>
        </dynamicSql>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select trandt,trantm,tranam,acctbl,trancy crcycd,csextg,amntcd,opcuac,opacna opcuna,tranbr,servtp,smrycd,smryds,remark,tmstmp,machdt from knl_bill]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[acctno in (${acctno}) and trancy = #crcycd#]]></str>
                    <if test="bgindt!=null&amp;&amp;bgindt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[trandt between #bgindt# and #endddt#]]></str>
                    </if>
                    <if test="smrycd!=null&amp;&amp;smrycd!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[smrycd = #smrycd#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by trandt desc,acctno desc, detlsq desc]]></str>
        </dynamicSql>
    </dynamicSelect>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selAcctblListAll" longname="查询升级前后负债账户交易明细(柜面)(当前库)">
        <parameterMap class="java.util.Map">
            <parameter property="acctno" jdbcType="VARCHAR" javaType="BaseType.U_CHAR1000" mode="in" longname="负债账号" parameterType="condition"/>
            <parameter property="amntcd" ref="BaseDict.Comm.amntcd" jdbcType="VARCHAR" javaType="BaseEnumType.E_AMNTCD" mode="in" longname="借贷标志" parameterType="condition"/>
            <parameter property="bgindt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="开始日期" parameterType="condition"/>
            <parameter property="endddt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="终止日期" parameterType="condition"/>
            <parameter property="smrycd" ref="BaseDict.Comm.smrycd" jdbcType="VARCHAR" javaType="BaseType.U_SMRYCD" mode="in" longname="摘要代码" parameterType="condition"/>
            <parameter property="opcuac" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="对方账号" parameterType="condition"/>
            <parameter property="opcuna" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNA" mode="in" longname="对方户名" parameterType="condition"/>
            <parameter property="mxtram" jdbcType="VARCHAR" javaType="BaseType.U_TRANAM" mode="in" longname="最大交易金额" parameterType="condition"/>
            <parameter property="mntram" jdbcType="VARCHAR" javaType="BaseType.U_TRANAM" mode="in" longname="最小交易金额" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoDpTable.IoDpAcctblList"/>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select b.trandt, b.trantm, b.tranam, b.acctbl, b.trancy crcycd, b.csextg, b.amntcd, b.opcuac, b.opacna opcuna, 
            						b.tranbr, b.servtp, b.smrycd, b.smryds, b.remark, b.procsq, b.intrcd, b.userid, b.ussqno, b.authus, b.authsq
									from knl_bill b ]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[ EXISTS (select 1 from kna_acct a where a.acctno = b.acctno and  a.acctno = #acctno#) and b.trandt between #bgindt# and #endddt#]]></str>
                    <if test="amntcd!=null" type="If">
                        <str type="Str"><![CDATA[b.amntcd = #amntcd#]]></str>
                    </if>
                    <if test="mxtram!=null" type="If">
                        <str type="Str"><![CDATA[b.tranam <= #mxtram#]]></str>
                    </if>
                    <if test="smrycd!=null" type="If">
                        <str type="Str"><![CDATA[b.smrycd = #smrycd#]]></str>
                    </if>
                    <if test="opcuac!=null&amp;opcuac!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[b.opcuac = #opcuac#]]></str>
                    </if>
                    <if test="opcuna!=null&amp;opcuna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[b.opacna = #opcuna#]]></str>
                    </if>
                    <if test="mntram!=null" type="If">
                        <str type="Str"><![CDATA[b.tranam >= #mntram#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by b.trandt desc, b.acctno desc, b.detlsq desc]]></str>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[select b.trandt, b.trantm, b.tranam, b.acctbl, b.trancy crcycd, b.csextg, b.amntcd, b.opcuac, b.opacna opcuna, 
                                    b.tranbr, b.servtp, b.smrycd, b.smryds, b.remark, b.procsq, b.intrcd, b.userid, b.ussqno, b.authus, b.authsq
                                    from knl_bill b ]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[ EXISTS (select 1 from kna_acct a where a.acctno = b.acctno and  a.acctno = #acctno#) and b.trandt between #bgindt# and #endddt#]]></str>
                    <if test="amntcd!=null" type="If">
                        <str type="Str"><![CDATA[b.amntcd = #amntcd#]]></str>
                    </if>
                    <if test="mxtram!=null" type="If">
                        <str type="Str"><![CDATA[b.tranam <= #mxtram#]]></str>
                    </if>
                    <if test="smrycd!=null" type="If">
                        <str type="Str"><![CDATA[b.smrycd = #smrycd#]]></str>
                    </if>
                    <if test="opcuac!=null&amp;opcuac!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[b.opcuac = #opcuac#]]></str>
                    </if>
                    <if test="opcuna!=null&amp;opcuna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[b.opacna = #opcuna#]]></str>
                    </if>
                    <if test="mntram!=null" type="If">
                        <str type="Str"><![CDATA[b.tranam >= #mntram#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by b.trandt desc, b.acctno desc, b.detlsq desc]]></str>
        </dynamicSql>
    </dynamicSelect>
    <update method="update" id="updCifCustAccsByCustac" longname="更新客户信息关联表状态">
        <sql><![CDATA[update cif_cust_accs set status = '1' where custid = #custid#

]]></sql>
        <sql type="oracle"><![CDATA[update cif_cust_accs set status = '1' where custid = #custid#

]]></sql>
        <sql type="mysql"><![CDATA[update cif_cust_accs set status = '1' where custid = #custid#

]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custid" ref="BaseDict.Comm.custid" jdbcType="VARCHAR" javaType="BaseType.U_CUSTID" mode="in" longname="用户ID" parameterType="condition"/>
        </parameterMap>
    </update>
    <update method="update" id="updKnaAcalByAcalno" longname="更新账户别名状态">
        <sql><![CDATA[update kna_acal a set a.ACALST = #acalst#  ,a.tmstmp =#tmstmp# where a.custac = #custac# and a.acalno = #acalno# 
        <sql><![CDATA[update kna_acal a set a.ACALST = #acalst#  ,a.tmstmp =#tmstmp# where a.custac = #custac# and a.acalno = #acalno# 

]]></sql>
        <sql type="oracle"><![CDATA[update kna_acal a set a.ACALST = #acalst#  ,a.tmstmp =#tmstmp# where a.custac = #custac# and a.acalno = #acalno# 
        <sql><![CDATA[update kna_acal a set a.ACALST = #acalst#  ,a.tmstmp =#tmstmp# where a.custac = #custac# and a.acalno = #acalno# 

]]></sql>
        <sql type="mysql"><![CDATA[update kna_acal a set a.ACALST = #acalst#  ,a.tmstmp =#tmstmp# where a.custac = #custac# and a.acalno = #acalno# 
        <sql><![CDATA[update kna_acal a set a.ACALST = #acalst#  ,a.tmstmp =#tmstmp# where a.custac = #custac# and a.acalno = #acalno# 

]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acalno" ref="CaDict.Eacct.acalno" jdbcType="VARCHAR" javaType="BaseType.U_CHAR30" mode="in" longname="账户别名" parameterType="condition"/>
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUSTAC" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="tmstmp" ref="ApDict.Aplt.tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
            <parameter property="acalst" jdbcType="VARCHAR" javaType="CaEnumType.E_ACALST" mode="in" longname="关联状态" parameterType="condition"/>
        </parameterMap>
    </update>
    <select cache="none" method="selectAll" type="sql" id="selKnsAcsqClin" longname="查询系统内法人清算信息">
        <sql type="db2"><![CDATA[select a.* from kns_acsq_clin a
where a.trandt=#trandt# and a.mntrsq=#mntrsq# ]]></sql>
        <sql type="oracle"><![CDATA[select a.* from kns_acsq_clin a
where a.trandt=#trandt# and a.mntrsq=#mntrsq# ]]></sql>
        <sql type="mysql"><![CDATA[select a.* from kns_acsq_clin a
where a.trandt=#trandt# and a.mntrsq=#mntrsq# ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="trandt" ref="BaseDict.Comm.trandt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="mntrsq" ref="DpDict.Froz.mntrsq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="主交易流水" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoAccountComplexType.IoAccountClearInfo"/>
    </select>
    <update method="update" id="updKnaAccsAcctstByCLosInfo" longname="根据销户信息更新电子账号与子账户关联状态">
        <sql type="oracle"><![CDATA[update kna_accs a set acctst = #acctst#, , tmstmp=#tmstmp# where EXISTS 
(select 1  from  (select ACCTNO,CUSTAC  from kna_fxac where CLOSDT = #closdt# and CLOSSQ = #clossq# 
UNION all 
select ACCTNO,CUSTAC from kna_acct where CLOSDT = #closdt# and CLOSSQ = #clossq#) b 
where a.ACCTNO = b.ACCTNO and  a.CUSTAC = b.CUSTAC)

]]></sql>
        <sql type="mysql"><![CDATA[update kna_accs a set acctst = #acctst#, , tmstmp=#tmstmp# where EXISTS 
(select 1  from  (select ACCTNO,CUSTAC  from kna_fxac where CLOSDT = #closdt# and CLOSSQ = #clossq# 
UNION all 
select ACCTNO,CUSTAC from kna_acct where CLOSDT = #closdt# and CLOSSQ = #clossq#) b 
where a.ACCTNO = b.ACCTNO and  a.CUSTAC = b.CUSTAC)

]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctst" jdbcType="VARCHAR" javaType="BaseEnumType.E_DPACST" mode="in" longname="账户状态" parameterType="condition"/>
            <parameter property="tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
            <parameter property="closdt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="销户日期" parameterType="condition"/>
            <parameter property="clossq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="销户流水" parameterType="condition"/>
        </parameterMap>
    </update>
    <select cache="none" method="selectOne" type="sql" id="selHistAcctblByCustac" longname="查询账户历史账单余额">
        <sql type="db2"><![CDATA[select sum(a.acctbl) as  tranam from h_knl_bill a inner join 
(select u.acctno,max(u.detlsq) as detlsq from h_knl_bill u where u.custac = #custac# and u.trandt <=#trandt# group by u.acctno) b 
on(a.acctno = b.acctno and a.detlsq = b.detlsq)]]></sql>
        <sql type="oracle"><![CDATA[select sum(a.acctbl) as  tranam from h_knl_bill a inner join 
(select u.acctno,max(u.detlsq) as detlsq from h_knl_bill u where u.custac = #custac# and u.trandt <=#trandt# group by u.acctno) b 
on(a.acctno = b.acctno and a.detlsq = b.detlsq)]]></sql>
        <sql type="mysql"><![CDATA[select sum(a.acctbl) as  tranam from h_knl_bill a inner join 
(select u.acctno,max(u.detlsq) as detlsq from h_knl_bill u where u.custac = #custac# and u.trandt <=#trandt# group by u.acctno) b 
on(a.acctno = b.acctno and a.detlsq = b.detlsq)]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" ref="DpDict.Acct.custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="客户账号" parameterType="condition"/>
            <parameter property="trandt" ref="DpDict.Acct.trandt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="交易日期" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoDpFrozComplexType.IofrozInfo"/>
    </select>
    <select cache="none" method="selectPageWithCount" type="sql" id="selDpAcctInfo" longname="查询存款账户附加信息">
        <sql><![CDATA[select prod.sprdid,prod.sprdna ,prod.pddpfg from (
select sprdid,obgaon sprdna ,'1' as ordrid,'0204' as pddpfg from kna_acct_prod where acctno in (
select acctno from kna_acct a,kna_acdc b where b.cardno=#cardno# 
and a.custac=b.custac and a.acctst<>'2' and a.acsetp in ('04','05','07')) group by sprdid,obgaon
union all
select sprdid,obgaon sprdna ,'2' as ordrid,'0205' as pddpfg from kna_fxac_prod where acctno in (
select acctno from kna_fxac c,kna_acdc b where b.cardno=#cardno# 
and c.custac=b.custac and c.acctst<>'2' and c.acsetp in ('04','05','07')) group by sprdid,obgaon
)prod order by ordrid
]]></sql>
        <sql type="oracle"><![CDATA[select prod.sprdid,prod.sprdna ,prod.pddpfg from (
select sprdid,obgaon sprdna ,'1' as ordrid,'0204' as pddpfg from kna_acct_prod where acctno in (
select acctno from kna_acct a,kna_acdc b where b.cardno=#cardno# 
and a.custac=b.custac and a.acctst<>'2' and a.acsetp in ('04','05','07')) group by sprdid,obgaon
union all
select sprdid,obgaon sprdna ,'2' as ordrid,'0205' as pddpfg from kna_fxac_prod where acctno in (
select acctno from kna_fxac c,kna_acdc b where b.cardno=#cardno# 
and c.custac=b.custac and c.acctst<>'2' and c.acsetp in ('04','05','07')) group by sprdid,obgaon
)prod order by ordrid
]]></sql>
        <sql type="mysql"><![CDATA[select prod.sprdid,prod.sprdna ,prod.pddpfg from (
select sprdid,obgaon sprdna ,'1' as ordrid,'0204' as pddpfg from kna_acct_prod where acctno in (
select acctno from kna_acct a,kna_acdc b where b.cardno=#cardno# 
and a.custac=b.custac and a.acctst<>'2' and a.acsetp in ('04','05','07')) group by sprdid,obgaon
union all
select sprdid,obgaon sprdna ,'2' as ordrid,'0205' as pddpfg from kna_fxac_prod where acctno in (
select acctno from kna_fxac c,kna_acdc b where b.cardno=#cardno# 
and c.custac=b.custac and c.acctst<>'2' and c.acsetp in ('04','05','07')) group by sprdid,obgaon
)prod order by ordrid
]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="cardno" jdbcType="VARCHAR" javaType="BaseType.U_CARDNO" mode="in" longname="电子账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoDpProdQuery.IoDpAcctProdInfo"/>
    </select>
    <select cache="none" method="selectFirst" type="sql" id="selKnaFxacDetlByAcctno" longname="查询定期存款明细中最早记录对应的最大金额">
        <sql><![CDATA[select * from kna_fxac_detl where acctno=#acctno# and acctst='1' order by bgindt asc,onlnbl desc
]]></sql>
        <sql type="oracle"><![CDATA[select * from kna_fxac_detl where acctno=#acctno# and acctst='1' order by bgindt asc,onlnbl desc
]]></sql>
        <sql type="mysql"><![CDATA[select * from kna_fxac_detl where acctno=#acctno# and acctst='1' order by bgindt asc,onlnbl desc
]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="负债账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDepoBusiMain.KnaFxacDetl"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selDpAcTotbalByCardno" longname="根据电子账号查询存款总资产">
        <sql><![CDATA[select sum(temp.onlnbl) from (select b.onlnbl from kna_acdc a, kna_acct b 
where a.cardno=#cardno# and a.custac = b.custac and b.acctst<>'2' and b.acsetp in ('04','05','07')
union all 
select c.onlnbl from kna_acdc a, kna_fxac c 
where a.cardno=#cardno# and a.custac = c.custac and c.acctst<>'2' and c.acsetp in ('04','05','07') 
) temp]]></sql>
        <sql type="oracle"><![CDATA[select sum(temp.onlnbl) from (select b.onlnbl from kna_acdc a, kna_acct b 
where a.cardno=#cardno# and a.custac = b.custac and b.acctst<>'2' and b.acsetp in ('04','05','07')
union all 
select c.onlnbl from kna_acdc a, kna_fxac c 
where a.cardno=#cardno# and a.custac = c.custac and c.acctst<>'2' and c.acsetp in ('04','05','07') 
) temp]]></sql>
        <sql type="mysql"><![CDATA[select sum(temp.onlnbl) from (select b.onlnbl from kna_acdc a, kna_acct b 
where a.cardno=#cardno# and a.custac = b.custac and b.acctst<>'2' and b.acsetp in ('04','05','07')
union all 
select c.onlnbl from kna_acdc a, kna_fxac c 
where a.cardno=#cardno# and a.custac = c.custac and c.acctst<>'2' and c.acsetp in ('04','05','07') 
) temp]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="cardno" jdbcType="VARCHAR" javaType="BaseType.U_CARDNO" mode="in" longname="电子账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.math.BigDecimal"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnaFxacProdByAcctno" longname="根据存款子账号查询定期存款产品名称">
        <sql><![CDATA[select a.* from kna_fxac_prod a where a.acctno=#acctno#]]></sql>
        <sql type="oracle"><![CDATA[select a.* from kna_fxac_prod a where a.acctno=#acctno#]]></sql>
        <sql type="mysql"><![CDATA[select a.* from kna_fxac_prod a where a.acctno=#acctno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" ref="DpDict.Acct.acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="负债账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDepoBusiMain.KnaFxacProd"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnaAcctProdByAcctno" longname="根据存款子账号查询活期存款产品名称">
        <sql><![CDATA[select a.* from kna_acct_prod a where a.acctno=#acctno#]]></sql>
        <sql type="oracle"><![CDATA[select a.* from kna_acct_prod a where a.acctno=#acctno#]]></sql>
        <sql type="mysql"><![CDATA[select a.* from kna_acct_prod a where a.acctno=#acctno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" ref="DpDict.Acct.acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="负债账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDepoBusiMain.KnaAcctProd"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selknaacctbyacctno" longname="根据负债账号查询负债活期账户信息表">
        <sql type="db2"><![CDATA[select a.* from kna_acct a where a.acctno = #acctno#]]></sql>
        <sql type="oracle"><![CDATA[select a.* from kna_acct a where a.acctno = #acctno#]]></sql>
        <sql type="mysql"><![CDATA[select a.* from kna_acct a where a.acctno = #acctno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="负债账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDepoBusiMain.KnaAcct"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selknaacctbycustac" longname="根据电子账号查询负债账号活期对照表">
        <sql type="db2"><![CDATA[select a.* from kna_acct a where a.custac = #custac# and a.acsetp = '01']]></sql>
        <sql type="oracle"><![CDATA[select a.* from kna_acct a where a.custac = #custac# and a.acsetp = '01']]></sql>
        <sql type="mysql"><![CDATA[select a.* from kna_acct a where a.custac = #custac# and a.acsetp = '01']]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="客户账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDepoBusiMain.KnaAcct"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnbParaMenuByCodevl" longname="查询末级产品信息">
        <sql><![CDATA[select *  from knb_para_menu where codevl =#codevl# and chcode='end']]></sql>
        <sql type="oracle"><![CDATA[select *  from knb_para_menu where codevl =#codevl# and chcode='end']]></sql>
        <sql type="mysql"><![CDATA[select *  from knb_para_menu where codevl =#codevl# and chcode='end']]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="codevl" jdbcType="VARCHAR" javaType="BaseType.U_CHAR100" mode="in" longname="值代码" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoDpTable.IoKnbParaMenuInfo"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnaAcdcByAcctno" longname="根据负债子账户查询电子账户ID信息">
        <sql><![CDATA[select a.* from kna_acdc a where a.cardno= #cardno#]]></sql>
        <sql type="oracle"><![CDATA[select a.* from kna_acdc a where a.cardno= #cardno#]]></sql>
        <sql type="mysql"><![CDATA[select a.* from kna_acdc a where a.cardno= #cardno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="cardno" ref="DpDict.Acct.cardno" jdbcType="VARCHAR" javaType="BaseType.U_CARDNO" mode="in" longname="卡号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoDpProdQuery.IoDpAcdcOut"/>
    </select>
    <select cache="none" method="selectAll selectPageWithCount" type="sql" id="selAcctProdByClossq" longname="根据销户流水查询电子账户">
        <sql type="db2"><![CDATA[select c.ACSETP dpactp,d.totlin clprcp,sum(d.rlintr) cltxin ,sum(d.rlintx) clatax ,sum(d.rlintr) - sum(d.rlintx) clinst from (
SELECT acsetp,a.CLOSSQ,a.CLOSDT,a.ACCTNO FROM KNA_ACCT a WHERE a.CLOSSQ = #transq# and a.CUSTAC = #custac#
UNION ALL
SELECT case acsetp when '05' then '04'  else b.acsetp End 
acsetp,b.CLOSSQ,b.CLOSDT,b.ACCTNO FROM KAN_FXAC b WHERE b.CLOSSQ
= #transq# and b.CUSTAC = #custac#) c left join knb_pidl d on(c.acctno = d.acctno and c.clossq = d.pyinsq)
group by c.ACSETP,d.totlin
order by c.ACSETP desc]]></sql>
        <sql type="mysql"><![CDATA[select c.ACSETP dpactp,d.totlin clprcp,sum(d.rlintr) cltxin ,sum(d.rlintx) clatax ,sum(d.rlintr) - sum(d.rlintx) clinst from (
SELECT acsetp,a.CLOSSQ,a.CLOSDT,a.ACCTNO FROM KNA_ACCT a WHERE a.CLOSSQ = #transq# and a.CUSTAC = #custac#
UNION ALL
SELECT case acsetp when '05' then '04'  else b.acsetp End 
acsetp,b.CLOSSQ,b.CLOSDT,b.ACCTNO FROM KNA_FXAC b WHERE b.CLOSSQ
= #transq# and b.CUSTAC = #custac#) c left join knb_pidl d on(c.acctno = d.acctno and c.clossq = d.pyinsq)
group by c.ACSETP,d.totlin
order by c.ACSETP desc]]></sql>
        <sql type="oracle"><![CDATA[select c.ACSETP dpactp,d.totlin clprcp,sum(d.rlintr) cltxin ,sum(d.rlintx) clatax ,sum(d.rlintr) - sum(d.rlintx) clinst from (
SELECT acsetp,a.CLOSSQ,a.CLOSDT,a.ACCTNO FROM KNA_ACCT a WHERE a.CLOSSQ = #transq# and a.CUSTAC = #custac#
UNION ALL
SELECT case acsetp when '05' then '04'  else b.acsetp End 
acsetp,b.CLOSSQ,b.CLOSDT,b.ACCTNO FROM KAN_FXAC b WHERE b.CLOSSQ
= #transq# and b.CUSTAC = #custac#) c left join knb_pidl d on(c.acctno = d.acctno and c.clossq = d.pyinsq)
group by c.ACSETP,d.totlin
order by c.ACSETP desc]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="transq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" parameterType="condition"/>
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUSTAC" mode="in" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoDpProdParts.IoDpCloseDetailOT"/>
    </select>
    <select cache="none" method="selectPage" type="sql" id="selKnlBillByAcctno" longname="查询所有账户余额发生明细">
        <sql><![CDATA[SELECT * FROM knl_bill where acctno = #acctno# and corpno = #corpno# ORDER BY detlsq]]></sql>
        <sql type="oracle"><![CDATA[SELECT * FROM knl_bill where acctno = #acctno# and corpno = #corpno# ORDER BY detlsq]]></sql>
        <sql type="mysql"><![CDATA[SELECT * FROM knl_bill where acctno = #acctno# and corpno = #corpno# ORDER BY detlsq]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" ref="BaseDict.Comm.acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="账号" parameterType="condition"/>
            <parameter property="corpno" ref="BaseDict.Comm.corpno" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoDpTable.IoDpKnlBill"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnlBillByAcctnoCount" longname="查询所有账户余额发生明细">
        <sql><![CDATA[SELECT count(*) FROM knl_bill where acctno = #acctno# and corpno = #corpno# ORDER BY detlsq]]></sql>
        <sql type="oracle"><![CDATA[SELECT count(*) FROM knl_bill where acctno = #acctno# and corpno = #corpno# ORDER BY detlsq]]></sql>
        <sql type="mysql"><![CDATA[SELECT count(*) FROM knl_bill where acctno = #acctno# and corpno = #corpno# ORDER BY detlsq]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" ref="BaseDict.Comm.acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="账号" parameterType="condition"/>
            <parameter property="corpno" ref="BaseDict.Comm.corpno" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
        </parameterMap>
        <resultMap class="long"/>
    </select>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selBatranResult" longname="查询批量转账结果">
        <parameterMap class="java.util.Map">
            <parameter property="filesq" jdbcType="VARCHAR" javaType="BaseType.U_CHAR40" mode="in" longname="文件批次号" parameterType="condition"/>
            <parameter property="transt" jdbcType="VARCHAR" javaType="BaseEnumType.E_TRANST" mode="in" longname="交易状态" parameterType="condition"/>
            <parameter property="acctno" jdbcType="VARCHAR" javaType="BaseType.U_CARDNO" mode="in" longname="归集账号" parameterType="condition"/>
            <parameter property="acctna" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNA" mode="in" longname="归集账户名称" parameterType="condition"/>
            <parameter property="pyacct" jdbcType="VARCHAR" javaType="BaseType.U_CARDNO" mode="in" longname="被归集账号" parameterType="condition"/>
            <parameter property="pyacna" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNA" mode="in" longname="被归集账户名称" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpTransfer.DpKnbAcctBach"/>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[select * from knb_acct_bach]]></str>
            <where type="Where">
                <and type="And">
                    <if test="filesq!=null &amp;&amp; filesq!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[filesq=#filesq#]]></str>
                    </if>
                    <if test="transt!=null" type="If">
                        <str type="Str"><![CDATA[transt=#transt#]]></str>
                    </if>
                    <if test="acctno!=null &amp;&amp; acctno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[acctno=#acctno#]]></str>
                    </if>
                    <if test="acctna!=null &amp;&amp; acctna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[acctna=#acctna#]]></str>
                    </if>
                    <if test="pyacct!=null &amp;&amp; pyacct!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[pyacct=#pyacct#]]></str>
                    </if>
                    <if test="pyacna!=null &amp;&amp; pyacna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[pyacna=#pyacna#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by transq,soursq,trandt asc]]></str>
        </dynamicSql>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select * from knb_acct_bach]]></str>
            <where type="Where">
                <and type="And">
                    <if test="filesq!=null &amp;&amp; filesq!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[filesq=#filesq#]]></str>
                    </if>
                    <if test="transt!=null" type="If">
                        <str type="Str"><![CDATA[transt=#transt#]]></str>
                    </if>
                    <if test="acctno!=null &amp;&amp; acctno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[acctno=#acctno#]]></str>
                    </if>
                    <if test="acctna!=null &amp;&amp; acctna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[acctna=#acctna#]]></str>
                    </if>
                    <if test="pyacct!=null &amp;&amp; pyacct!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[pyacct=#pyacct#]]></str>
                    </if>
                    <if test="pyacna!=null &amp;&amp; pyacna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[pyacna=#pyacna#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by transq,soursq,trandt asc]]></str>
        </dynamicSql>
    </dynamicSelect>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selknlbillList" longname="电子账户对账单查询">
        <parameterMap class="java.util.Map">
            <parameter property="trandt" ref="DpDict.Acct.trandt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="bgindt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="起始日期" parameterType="condition"/>
            <parameter property="endddt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="截止日期" parameterType="condition"/>
            <parameter property="acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoDpQueryComplexType.IoKnlBillInfo"/>
        <dynamicSql type="db2">
            <str type="Str"><![CDATA[
            select a.acctno,a.trandt,a.tranbr,a.openbr,a.acctna,a.amntcd,a.trancy,a.tranam,a.acctbl,a.cardno,a.custac, a.dcmttp,
            a.dcbtno,a.bankcd,a.bankna,a.opcuac,a.opacna, a.opbrch,a.bgindt,a.servtp,a.cstrfg,a.userid,a.authus, a.transq,a.trantm
            from knl_bill a]]></str>
            <where type="Where">
                <and type="And">
                    <if test="bgindt!=null &amp;&amp;bgindt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt>=#bgindt#]]></str>
                    </if>
                    <if test="endddt !=null &amp;&amp;endddt !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt <= #endddt#]]></str>
                    </if>
                    <if test="acctno!=null&amp;&amp;acctno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.acctno=#acctno#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by  a.tmstmp  ]]></str>
        </dynamicSql>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[
            select a.acctno,a.trandt,a.tranbr,a.openbr,a.acctna,a.amntcd,a.trancy,a.tranam,a.acctbl,a.cardno,a.custac, a.dcmttp,
            a.dcbtno,a.bankcd,a.bankna,a.opcuac,a.opacna, a.opbrch,a.bgindt,a.servtp,a.cstrfg,a.userid,a.authus, a.transq,a.trantm
            from knl_bill a]]></str>
            <where type="Where">
                <and type="And">
                    <if test="bgindt!=null &amp;&amp;bgindt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt>=#bgindt#]]></str>
                    </if>
                    <if test="endddt !=null &amp;&amp;endddt !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt <= #endddt#]]></str>
                    </if>
                    <if test="acctno!=null&amp;&amp;acctno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.acctno=#acctno#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by  a.tmstmp  ]]></str>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[
            select a.acctno,a.trandt,a.tranbr,a.openbr,a.acctna,a.amntcd,a.trancy,a.tranam,a.acctbl,a.cardno,a.custac, a.dcmttp,
            a.dcbtno,a.bankcd,a.bankna,a.opcuac,a.opacna, a.opbrch,a.bgindt,a.servtp,a.cstrfg,a.userid,a.authus, a.transq,a.trantm
            from knl_bill a]]></str>
            <where type="Where">
                <and type="And">
                    <if test="bgindt!=null &amp;&amp;bgindt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt>=#bgindt#]]></str>
                    </if>
                    <if test="endddt !=null &amp;&amp;endddt !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt <= #endddt#]]></str>
                    </if>
                    <if test="acctno!=null&amp;&amp;acctno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.acctno=#acctno#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by  a.tmstmp  ]]></str>
        </dynamicSql>
    </dynamicSelect>
    <select cache="none" method="selectOne" type="sql" id="selPayrolAcctInfo" longname="查询代发工资转出方信息">
        <sql type="mysql"><![CDATA[select pyacct,sum(swpamt) swpamt from knb_acct_bach where filesq=#filesq# and transt!='9' group by pyacct]]></sql>
        <sql type="oracle"><![CDATA[select pyacct,sum(swpamt) swpamt from knb_acct_bach where filesq=#filesq# and transt!='9' group by pyacct]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="filesq" jdbcType="VARCHAR" javaType="BaseType.U_CHAR40" mode="in" longname="文件批次号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDepoBusiMain.KnbAcctBach"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selPayrolAcctTranst" longname="查询处理中的待发工资总金额">
        <sql type="mysql"><![CDATA[select sum(swpamt) swpamt from knb_acct_bach where filesq=#filesq# and transt='9']]></sql>
        <sql type="oracle"><![CDATA[select sum(swpamt) swpamt from knb_acct_bach where filesq=#filesq# and transt='9']]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="filesq" jdbcType="VARCHAR" javaType="BaseType.U_CHAR40" mode="in" longname="文件批次号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDepoBusiMain.KnbAcctBach"/>
    </select>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selKnlCnapotError" longname="根据文件日期和类型查询大小额对账差错文件">
        <parameterMap class="java.util.Map">
            <parameter property="trandt" jdbcType="VARCHAR" javaType="LnBaseType.U_DATE08" mode="in" parameterType="condition"/>
            <parameter property="subsys" jdbcType="VARCHAR" javaType="string" mode="in" parameterType="condition"/>
            <parameter property="status" jdbcType="VARCHAR" javaType="BaseEnumType.E_TRANST" mode="in" parameterType="condition"/>
        </parameterMap>
        <resultMap class="CustInfoCountType.InfoKnlCnapotError"/>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select  
a.subsys,a.crcycd,a.pyerac,a.pyeeac,a.tranam,
a.afeeam,a.feeam1,a.transq,a.trandt,a.erroty,
a.erromk,a.rdtrsq,a.rdtrdt,a.status
from 
knl_cnapot_error a]]></str>
            <where type="Where">
                <and type="And">
                    <if test="trandt!=null&amp;&amp;trandt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[rdtrdt=#trandt#]]></str>
                    </if>
                    <if test="subsys!=null&amp;&amp;subsys!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[subsys=#subsys#]]></str>
                    </if>
                    <if test="status!=null" type="If">
                        <str type="Str"><![CDATA[status=#status#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
    </dynamicSelect>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selKnlIoblCupsError" longname="根据文件日期和类型查询银联CUPS对账差错信息">
        <parameterMap class="java.util.Map">
            <parameter property="trandt" jdbcType="VARCHAR" javaType="LnBaseType.U_DATE08" mode="in" parameterType="condition"/>
            <parameter property="status" jdbcType="VARCHAR" javaType="DpEnumType.E_CUPSST" mode="in" parameterType="condition"/>
            <parameter property="djtype" jdbcType="VARCHAR" javaType="string" mode="in" parameterType="condition"/>
        </parameterMap>
        <resultMap class="CustInfoCountType.InfoKnlIoblCupsError"/>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select
a.mntrsq,a.trandt,a.cardno,a.tranam,a.crcycd,
a.otacct,a.inacct,a.chrgam,a.djtype,a.erroty,
a.erromk,a.rdtrsq,a.rdtrdt,a.transt
from 
knl_iobl_cups_error a]]></str>
            <where type="Where">
                <and type="And">
                    <if test="trandt!=null&amp;&amp;trandt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[rdtrdt=#trandt#]]></str>
                    </if>
                    <if test="status!=null" type="If">
                        <str type="Str"><![CDATA[transt=#status#]]></str>
                    </if>
                    <if test="djtype!=null" type="If">
                        <str type="Str"><![CDATA[djtype=#djtype#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
    </dynamicSelect>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selKnlIoblError" longname="根据文件日期查询传统核心对账差错信息">
        <parameterMap class="java.util.Map">
            <parameter property="trandt" jdbcType="VARCHAR" javaType="LnBaseType.U_DATE08" mode="in" parameterType="condition"/>
            <parameter property="status" jdbcType="VARCHAR" javaType="BaseEnumType.E_TRANST" mode="in" parameterType="condition"/>
            <parameter property="servtp" jdbcType="VARCHAR" javaType="MsType.U_CHANNEL" mode="in" parameterType="condition"/>
        </parameterMap>
        <resultMap class="CustInfoCountType.InfoKnlIoblError"/>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select
a.cardno,a.cuacno,a.acctno,a.toacct,a.toscac,
a.toacno,a.tlcgam,a.tranam,a.crcycd,a.transq,
a.trandt,a.erroty,a.erromk,a.rdtrsq,a.rdtrdt,a.status
from 
knl_iobl_error a]]></str>
            <where type="Where">
                <and type="And">
                    <if test="trandt!=null&amp;&amp;trandt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[rdtrdt=#trandt#]]></str>
                    </if>
                    <if test="status!=null" type="If">
                        <str type="Str"><![CDATA[status=#status#]]></str>
                    </if>
                    <if test="servtp!=null" type="If">
                        <str type="Str"><![CDATA[servtp=#servtp#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
    </dynamicSelect>
    <select cache="none" method="selectOne" type="sql" id="selAcctnaByAcctno" longname="根据负债账号查询客户名称">
        <sql type="oracle"><![CDATA[select a.acctna from lna_acct a where a.acctno=#acctno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" ref="LnDict.LNF.acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="贷款账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.lang.String"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnbPidlMaxNum" longname="根据负债账号查询负债账户付息明细">
        <sql type="oracle"><![CDATA[select b.* from knb_pidl b where b.indxno = (select max(indxno) from knb_pidl where acctno = #acctno#) ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" jdbcType="VARCHAR" javaType="string" mode="in" longname="负债账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDepoInst.KnbPidl"/>
    </select>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selKnsAcsqInfosNew" longname="查询会计流水表详细信息">
        <parameterMap class="java.util.Map">
            <parameter property="trandt" ref="DpDict.Acct.trandt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="transq" ref="DpDict.Acct.transq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="主交易流水" parameterType="condition"/>
            <parameter property="bgindt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="起始日期" parameterType="condition"/>
            <parameter property="endddt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="截止日期" parameterType="condition"/>
            <parameter property="corpno" ref="LnDict.LNF.corpno" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
            <parameter property="acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoAccountComplexType.IoKnsAcsqInfo"/>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select a.cuacno, a.trandt,a.mntrsq,c.prcscd,c.tranna as prcsna,a.cuacno as acctno,a.dtitcd ,a.crcycd,a.amntcd,
            a.tranam,a.atowtp,a.bltype,c.sacotg
            from kns_acsq a,knp_txns c]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[a.fileid = c.prcscd ]]></str>
                    <if test="bgindt!=null &amp;&amp;bgindt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt>=#bgindt#]]></str>
                    </if>
                    <if test="endddt !=null &amp;&amp;endddt !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt <= #endddt#]]></str>
                    </if>
                    <if test="transq !=null &amp;&amp; transq !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.transq =#transq#]]></str>
                    </if>
                    <if test="corpno !=null &amp;&amp;corpno !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.corpno =#corpno#]]></str>
                    </if>
                    <if test="acctno!=null&amp;&amp;acctno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[acctno=#acctno#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by a.sortno desc]]></str>
        </dynamicSql>
    </dynamicSelect>
    <select cache="none" method="selectPageWithCount" type="sql" id="selKnaAcctByPage" longname="分页查询电子账户子账户信息">
        <sql type="oracle"><![CDATA[SELECT a.acctna, a.custno, a.acctno, a.psedid, a.acctid, a.acsetp,  a.prodcd, a.crcycd, a.depttm, a.bgindt, a.brchno, a.opendt, a.opensq, a.closdt, a.clossq, a.onlnbl, a.lastbl, a.lstrdt, a.pddpfg, a.debttp, a.acctst, a.spectp, a.accttp, a.acctcd, a.isdrft
FROM kna_acct a WHERE a.custac = #custac#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUSTAC" mode="in" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDepoBusiMain.KnaAcct"/>
    </select>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selSubAccts" longname="查询电子账户子户信息">
        <parameterMap class="java.util.Map">
            <parameter property="custac" ref="BaseDict.Comm.custac" jdbcType="VARCHAR" javaType="BaseType.U_CHAR32" mode="in" longname="客户账号" parameterType="condition"/>
            <parameter property="acctno" ref="BaseDict.Comm.acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="账号" parameterType="condition"/>
            <parameter property="acctid" jdbcType="VARCHAR" javaType="BaseType.U_CHAR30" mode="in" longname="品牌子户ID" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDepoBusiMain.KnaAcct"/>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[SELECT a.acctna, a.custno, a.acctno, a.psedid, a.acctid, a.acsetp,  a.prodcd, a.crcycd, a.depttm, a.bgindt, a.brchno, a.opendt, a.opensq, a.closdt, a.clossq, a.onlnbl, a.lastbl, a.lstrdt, a.pddpfg, a.debttp, a.acctst, a.spectp, a.accttp, a.acctcd, a.isdrft
FROM kna_acct a]]></str>
            <where type="Where">
                <and type="And">
                    <if test="custac!=null&amp;&amp;custac!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.custac = #custac#]]></str>
                    </if>
                    <if test="acctno!=null&amp;&amp;acctno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.acctno = #acctno#]]></str>
                    </if>
                    <if test="acctid!=null&amp;&amp;acctid!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.acctid = #acctid#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
    </dynamicSelect>
    <select cache="none" method="selectAll" type="sql" id="selAllAgntDayFrTotal" longname="查询服务商当天分润信息">
        <sql type="oracle"><![CDATA[
 select a.agntid,
       a.agntna,
       sum(NVL(a.profitamt, 0)) profitamt,
       sum(NVL(a.prftam, 0)) prftam,
       sum(NVL(a.child_amt, 0)) child_amt
  from kub_day_fr_total a
 where a.trandt = #trandt#
   and a.dealst <> #dealst#
   and a.discyc = 'D'
 group by a.agntid, a.agntna]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="trandt" ref="BaseDict.Comm.trandt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="dealst" jdbcType="VARCHAR" javaType="DsEnumType.E_DEALST" mode="in" longname="记账状态" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DsComplex.KubDayFrTotalList"/>
    </select>
    <update method="update" id="updKubDayFrTotalDealst" longname="更新日分润汇总表">
        <sql type="oracle"><![CDATA[   update kub_day_fr_total a set a.dealst = #dealst#,a.prcscd = #prcscd#,a.messag = #messag#
    where a.agntid = #agntid# and a.trandt = #trandt#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="agntid" ref="DsDict.Ds.agntid" jdbcType="VARCHAR" javaType="BaseType.U_CHAR30" mode="in" longname="服务商ID" parameterType="condition"/>
            <parameter property="trandt" ref="BaseDict.Comm.trandt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="dealst" jdbcType="VARCHAR" javaType="DsEnumType.E_DEALST" mode="in" longname="记账状态" parameterType="condition"/>
            <parameter property="prcscd" jdbcType="VARCHAR" javaType="BaseType.U_CHAR10" mode="in" longname="交易码" parameterType="condition"/>
            <parameter property="messag" jdbcType="VARCHAR" javaType="BaseType.U_CHAR100" mode="in" longname="错误信息" parameterType="condition"/>
        </parameterMap>
    </update>
    <select cache="none" method="selectAll" type="sql" id="selAllAgntMothFrTotal" longname="查询服务商月结分润信息">
        <sql type="oracle"><![CDATA[ select a.agntid,a.prftam from kub_moth_fr a
where a.dealst <> '1'
and a.month like #sTranMonth# ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="sTranMonth" jdbcType="VARCHAR" javaType="string" mode="in" longname="交易月份" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DsComplex.KubDayFrTotalList"/>
    </select>
    <update method="update" id="updKubMothFrDealst" longname="更新月分润汇总表">
        <sql type="oracle"><![CDATA[ update kub_moth_fr a set a.dealst = #dealst#,a.sbrand = #sbrand#,a.bradna = #bradna#,
  a.prcscd = #prcscd#,a.messag = #messag#
  where a.agntid = #agntid# and a.month = #sMonth#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="sbrand" jdbcType="VARCHAR" javaType="BaseType.U_CHAR30" mode="in" longname="品牌ID" parameterType="condition"/>
            <parameter property="bradna" jdbcType="VARCHAR" javaType="BaseType.U_CHAR100" mode="in" longname="品牌名称" parameterType="condition"/>
            <parameter property="dealst" jdbcType="VARCHAR" javaType="DsEnumType.E_DEALST" mode="in" longname="记账状态" parameterType="condition"/>
            <parameter property="agntid" ref="DsDict.Ds.agntid" jdbcType="VARCHAR" javaType="BaseType.U_CHAR30" mode="in" longname="服务商ID" parameterType="condition"/>
            <parameter property="sMonth" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="月份" parameterType="condition"/>
            <parameter property="prcscd" jdbcType="VARCHAR" javaType="BaseType.U_CHAR10" mode="in" longname="交易码" parameterType="condition"/>
            <parameter property="messag" jdbcType="VARCHAR" javaType="BaseType.U_CHAR100" mode="in" longname="错误信息" parameterType="condition"/>
        </parameterMap>
    </update>
    <dynamicSelect cache="none" method="selectPageWithCount selectAll" type="sql" id="selKnlIoblStateInfo" longname="代发状态查询">
        <parameterMap class="java.util.Map">
            <parameter property="sbrand" jdbcType="VARCHAR" javaType="BaseType.U_CHAR30" mode="in" longname="品牌" parameterType="condition"/>
            <parameter property="inmeid" ref="PbDict.JFD.inmeid" jdbcType="VARCHAR" javaType="BaseType.U_CHAR25" mode="in" longname="内部商户ID" parameterType="condition"/>
            <parameter property="refeno" ref="DpRiskDict.Aply.refeno" jdbcType="VARCHAR" javaType="BaseType.U_CHAR50" mode="in" longname="参考号" parameterType="condition"/>
            <parameter property="prepsq" jdbcType="VARCHAR" javaType="PbBaseType.U_TRNSEQ" mode="in" longname="收单交易流水" parameterType="condition"/>
            <parameter property="sacdno" jdbcType="VARCHAR" javaType="BaseType.U_CHAR80" mode="in" longname="结算卡账号" parameterType="condition"/>
            <parameter property="sacdna" jdbcType="VARCHAR" javaType="BaseType.U_CHAR180" mode="in" longname="结算卡账号名称" parameterType="condition"/>
            <parameter property="servtp" jdbcType="VARCHAR" javaType="JfDpEnumType.E_EDMTYP" mode="in" longname="代发通道" parameterType="condition"/>
            <parameter property="transt" jdbcType="VARCHAR" javaType="JfDpEnumType.E_CUPSST" mode="in" longname="代发状态" parameterType="condition"/>
            <parameter property="stadat" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="代发交易起始日期" parameterType="condition"/>
            <parameter property="enddat" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="代发交易截止日期" parameterType="condition"/>
            <parameter property="ordeno" ref="DsDict.Ds.ordeno" jdbcType="VARCHAR" javaType="BaseType.U_CHAR60" mode="in" longname="订单号" parameterType="condition"/>
            <parameter property="finsty" jdbcType="VARCHAR" javaType="JfDpEnumType.E_FINSTY" mode="in" longname="结算方式" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpAcctType.KnlIoblStateInfo"/>
        <dynamicSql>
            <str type="Str"><![CDATA[select a.orgaid as sbrand, a.busitp, a.inmeid, a.teleno, a.tmteleno, a.inmena, a.ordeno, a.refeno, a.prepdt, a.prepsq, a.trandt, a.mntrtm, a.mntrsq,
b.sacdna, b.tmsacdna, b.sabkna, b.puacfg, b.cardtp, b.sacdno, b.tmsacdno, a.finsty, a.toanam, b.tranam as dftram, b.servtp, b.trandt as dftrdt, b.preptm as dftrtm, c.mntrsq as dftrsq,
b.transt, b.rtcode, b.retmsg, a.mercfg, a.preptm, a.unkpdt, a.pabkno, a.tmpabkno, a.chrgam, a.tranam, a.jnanam, a.voucfe, a.prpoin, a.acfist,
b.sabkna as dfbkno, b.cardtp as dfcrtp, b.sacdno as dfcrno, b.bankno, b.orgaid, a.merate 
from knl_iobl_cups a left join knl_iobl_edm_contro c on a.mntrsq = c.retrsq
left join knl_iobl_edm b on b.mntrsq = c.mntrsq]]></str>
            <where type="Where">
                <and type="And">
                    <if test="sbrand!=null&amp;&amp;sbrand!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.orgaid = #sbrand#]]></str>
                    </if>
                    <if test="inmeid!=null&amp;&amp;inmeid!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.inmeid = #inmeid#]]></str>
                    </if>
                    <if test="refeno!=null&amp;&amp;refeno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.refeno = #refeno#]]></str>
                    </if>
                    <if test="prepsq!=null&amp;&amp;prepsq!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.prepsq = #prepsq#]]></str>
                    </if>
                    <if test="sacdna!=null&amp;&amp;sacdna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[b.sacdna = #sacdna#]]></str>
                    </if>
                    <if test="sacdno!=null&amp;&amp;sacdno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[b.sacdno = #sacdno#]]></str>
                    </if>
                    <if test="servtp!=null" type="If">
                        <str type="Str"><![CDATA[b.servtp = #servtp#]]></str>
                    </if>
                    <if test="transt!=null" type="If">
                        <str type="Str"><![CDATA[b.transt = #transt#]]></str>
                    </if>
                    <if test="stadat != null &amp;&amp; stadat != &quot;&quot; &amp;&amp; enddat != null &amp;&amp; enddat != &quot;&quot;" type="If">
                        <str type="Str"><![CDATA[b.trandt between #stadat# and #enddat#]]></str>
                    </if>
                    <if test="ordeno!=null&amp;&amp;ordeno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.ordeno = #ordeno#]]></str>
                    </if>
                    <if test="finsty!=null" type="If">
                        <str type="Str"><![CDATA[a.finsty = #finsty#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
    </dynamicSelect>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selKnlBillByTrandtAndMerInfo" longname="查询账户余额">
        <parameterMap class="java.util.Map">
            <parameter property="bgindt" jdbcType="VARCHAR" javaType="string" mode="in" longname="起始交易日期" parameterType="condition"/>
            <parameter property="enddt" jdbcType="VARCHAR" javaType="string" mode="in" longname="截止交易日期" parameterType="condition"/>
            <parameter property="tlphno" jdbcType="VARCHAR" javaType="BaseType.U_TELENO" mode="in" longname="手机号" parameterType="condition"/>
            <parameter property="idtftp" jdbcType="VARCHAR" javaType="BaseEnumType.E_IDTFTP" mode="in" longname="证件类型" parameterType="condition"/>
            <parameter property="idtfno" jdbcType="VARCHAR" javaType="string" mode="in" longname="证件号码" parameterType="condition"/>
        </parameterMap>
        <resultMap class="CaCustInfo.AccountBalanceInfo"/>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select a .*,  b.idtfno,b.tmidtfno,c. tlphno,c.tmtlphno from  knl_bill a, kna_maad b,kna_acal c]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[a.custac = b.custac and a.custac = c.custac]]></str>
                    <if test="bgindt!=null&amp;&amp;bgindt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt >= #bgindt#]]></str>
                    </if>
                    <if test="enddt!=null&amp;&amp;enddt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt <= #enddt#]]></str>
                    </if>
                    <if test="tlphno!=null&amp;&amp;tlphno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[c.tlphno = #tlphno#]]></str>
                    </if>
                    <if test="idtftp!=null" type="If">
                        <str type="Str"><![CDATA[b.idtftp = #idtftp#]]></str>
                    </if>
                    <if test="idtfno!=null &amp;&amp; idtfno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[b.idtfno = #idtfno#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
    </dynamicSelect>
    <select cache="none" method="selectAll" type="sql" id="selKnaAcctByCustac" longname="根据电子账户查询所有子户">
        <sql type="oracle"><![CDATA[SELECT * FROM KNA_ACCT WHERE CUSTAC = #custac# AND acctst <> '2' ORDER BY OPENDT, TMSTMP for update]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" ref="DpDict.Acct.custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDepoBusiMain.KnaAcct"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selectBatchPaidCount" longname="查询文件笔数">
        <sql><![CDATA[select count(1) counts, NVL(sum(tranam) ,0) tranam from knb_batch_paid where filesq = #filesq#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="filesq" jdbcType="VARCHAR" javaType="BaseType.U_CHAR40" mode="in" longname="批量交易批次号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpTransfer.DpCount"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selectBatchProfitCount" longname="查询文件数量">
        <sql><![CDATA[select count(1) counts, NVL(sum(tranam) ,0) tranam  from knb_batch_profit where filesq = #filesq#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="filesq" jdbcType="VARCHAR" javaType="BaseType.U_CHAR40" mode="in" longname="批量交易批次号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpTransfer.DpCount"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selectBatchPaidByFilesq" longname="通过批次号查询批量代发表">
        <sql><![CDATA[select * from knb_batch_paid where filesq = #filesq#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="filesq" jdbcType="VARCHAR" javaType="BaseType.U_CHAR40" mode="in" longname="批量交易批次号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDepoBusiMain.knb_batch_paid"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selectBatchProfitByFilesq" longname="通过批次号查询批量分润表">
        <sql><![CDATA[select * from knb_batch_profit where filesq = #filesq#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="filesq" jdbcType="VARCHAR" javaType="BaseType.U_CHAR40" mode="in" longname="批量交易批次号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpDepoBusiMain.knb_batch_profit"/>
    </select>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selKnsAcsqInfosByAcctOrSqWithBradna" longname="查询会计流水表详细信息(带品牌名称)">
        <parameterMap class="java.util.Map">
            <parameter property="mntrsq" ref="DpDict.Froz.mntrsq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="主交易流水" parameterType="condition"/>
            <parameter property="bgindt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="起始日期" parameterType="condition"/>
            <parameter property="endddt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="截止日期" parameterType="condition"/>
            <parameter property="acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="账号" parameterType="condition"/>
            <parameter property="sortno" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="序号" parameterType="condition"/>
            <parameter property="acctna" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNA" mode="in" longname="账户名称" parameterType="condition"/>
            <parameter property="amntcd" jdbcType="VARCHAR" javaType="BaseEnumType.E_AMNTCD" mode="in" longname="借贷标志" parameterType="condition"/>
            <parameter property="atowtp" jdbcType="VARCHAR" javaType="PbEnumType.E_ATOWTP" mode="in" longname="会计主体" parameterType="condition"/>
            <parameter property="tranam" jdbcType="VARCHAR" javaType="BaseType.U_TRANAM" mode="in" longname="交易金额" parameterType="condition"/>
            <parameter property="bradna" jdbcType="VARCHAR" javaType="BaseType.U_CHAR50" mode="in" longname="品牌名称" parameterType="condition"/>
            <parameter property="cardno" jdbcType="VARCHAR" javaType="BaseType.U_CARDNO" mode="in" longname="卡号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTypGenEAccountInfo.IoKnsAcsqInfoWithBradna"/>
        <dynamicSql type="db2">
            <str type="Str"><![CDATA[select * from
(
select a.trandt,a.mntrsq,a.fileid prcscd, g.description prcsna,
a.acctno,case when a.atowtp='1' then d.acctna  else c.acctna end as acctna,
a.crcycd,a.amntcd,a.tranam,a.atowtp,a.bltype,a.transq, h.userid tranus,
case when trim(a.cuacno) is not null then a.cuacno else b.custac end as cuacno,a.dtitcd,
a.acctbr,a.sortno,b.bradna, 
e.cardno, a.tmstmp
 from kns_acsq a
 left join kna_sbad b
 on a.acctno=b.acctno
 left join kna_acct c
 on (a.acctno=c.acctno)
 left join gl_kna_acct d
 on (a.acctno=d.acctno)
 left join kna_acdc e
 on(b.custac=e.custac)
 left join tsp_service_in g
 on(a.fileid=g.inner_service_code)
 left join knl_bill h
 on(a.transq=h.transq)
) f]]></str>
            <where type="Where">
                <and type="And">
                    <if test="bgindt!=null &amp;&amp;bgindt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.trandt>=#bgindt#]]></str>
                    </if>
                    <if test="endddt !=null &amp;&amp;endddt !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.trandt <= #endddt#]]></str>
                    </if>
                    <if test="mntrsq !=null &amp;&amp; mntrsq !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.mntrsq =#mntrsq#]]></str>
                    </if>
                    <if test="acctno!=null&amp;&amp;acctno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.acctno=#acctno#]]></str>
                    </if>
                    <if test="sortno!=null&amp;&amp;sortno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.sortno=#sortno#]]></str>
                    </if>
                    <if test="acctna!=null&amp;&amp;acctna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.acctna=#acctna#]]></str>
                    </if>
                    <if test="amntcd!=null" type="If">
                        <str type="Str"><![CDATA[f.amntcd=#amntcd#]]></str>
                    </if>
                    <if test="atowtp!=null" type="If">
                        <str type="Str"><![CDATA[f.atowtp=#atowtp#]]></str>
                    </if>
                    <if test="tranam!=null&amp;&amp;tranam!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.tranam=#tranam#]]></str>
                    </if>
                    <if test="bradna!=null&amp;&amp;bradna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.bradna=#bradna#]]></str>
                    </if>
                    <if test="cardno!=null&amp;&amp;cardno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.cardno=#cardno#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by  f.tmstmp  ]]></str>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[
            select * from
(
select a.trandt,a.mntrsq,a.fileid prcscd, g.description prcsna,
a.acctno,case when a.atowtp='1' then d.acctna  else c.acctna end as acctna,
a.crcycd,a.amntcd,a.tranam,a.atowtp,a.bltype,a.transq, h.userid tranus,
case when trim(a.cuacno) is not null then a.cuacno else b.custac end as cuacno,a.dtitcd,
a.acctbr,a.sortno,b.bradna, 
e.cardno, a.tmstmp
 from kns_acsq a
 left join kna_sbad b
 on a.acctno=b.acctno
 left join kna_acct c
 on (a.acctno=c.acctno)
 left join gl_kna_acct d
 on (a.acctno=d.acctno)
 left join kna_acdc e
 on(b.custac=e.custac)
 left join tsp_service_in g
 on(a.fileid=g.inner_service_code)
 left join knl_bill h
 on(a.transq=h.transq)
) f]]></str>
            <where type="Where">
                <and type="And">
                    <if test="bgindt!=null &amp;&amp;bgindt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.trandt>=#bgindt#]]></str>
                    </if>
                    <if test="endddt !=null &amp;&amp;endddt !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.trandt <= #endddt#]]></str>
                    </if>
                    <if test="mntrsq !=null &amp;&amp; mntrsq !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.mntrsq =#mntrsq#]]></str>
                    </if>
                    <if test="acctno!=null&amp;&amp;acctno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.acctno=#acctno#]]></str>
                    </if>
                    <if test="sortno!=null&amp;&amp;sortno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.sortno=#sortno#]]></str>
                    </if>
                    <if test="acctna!=null&amp;&amp;acctna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.acctna=#acctna#]]></str>
                    </if>
                    <if test="amntcd!=null" type="If">
                        <str type="Str"><![CDATA[f.amntcd=#amntcd#]]></str>
                    </if>
                    <if test="atowtp!=null" type="If">
                        <str type="Str"><![CDATA[f.atowtp=#atowtp#]]></str>
                    </if>
                    <if test="tranam!=null&amp;&amp;tranam!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.tranam=#tranam#]]></str>
                    </if>
                    <if test="bradna!=null&amp;&amp;bradna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.bradna=#bradna#]]></str>
                    </if>
                    <if test="cardno!=null&amp;&amp;cardno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.cardno=#cardno#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by  f.tmstmp  ]]></str>
        </dynamicSql>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[
            select * from
(
select a.trandt,a.mntrsq,a.fileid prcscd, g.description prcsna,
a.acctno,case when a.atowtp='1' then d.acctna  else c.acctna end as acctna,
a.crcycd,a.amntcd,a.tranam,a.atowtp,a.bltype,a.transq, h.userid tranus,
case when trim(a.cuacno) is not null then a.cuacno else b.custac end as cuacno,a.dtitcd,
a.acctbr,a.sortno,b.bradna, 
e.cardno, a.tmstmp
 from kns_acsq a
 left join kna_sbad b
 on a.acctno=b.acctno
 left join kna_acct c
 on (a.acctno=c.acctno)
 left join gl_kna_acct d
 on (a.acctno=d.acctno)
 left join kna_acdc e
 on(b.custac=e.custac)
 left join tsp_service_in g
 on(a.fileid=g.inner_service_code)
 left join knl_bill h
 on(a.transq=h.transq)
) f]]></str>
            <where type="Where">
                <and type="And">
                    <if test="bgindt!=null &amp;&amp;bgindt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.trandt>=#bgindt#]]></str>
                    </if>
                    <if test="endddt !=null &amp;&amp;endddt !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.trandt <= #endddt#]]></str>
                    </if>
                    <if test="mntrsq !=null &amp;&amp; mntrsq !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.mntrsq =#mntrsq#]]></str>
                    </if>
                    <if test="acctno!=null&amp;&amp;acctno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.acctno=#acctno#]]></str>
                    </if>
                    <if test="sortno!=null&amp;&amp;sortno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.sortno=#sortno#]]></str>
                    </if>
                    <if test="acctna!=null&amp;&amp;acctna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.acctna=#acctna#]]></str>
                    </if>
                    <if test="amntcd!=null" type="If">
                        <str type="Str"><![CDATA[f.amntcd=#amntcd#]]></str>
                    </if>
                    <if test="atowtp!=null" type="If">
                        <str type="Str"><![CDATA[f.atowtp=#atowtp#]]></str>
                    </if>
                    <if test="tranam!=null&amp;&amp;tranam!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.tranam=#tranam#]]></str>
                    </if>
                    <if test="bradna!=null&amp;&amp;bradna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.bradna=#bradna#]]></str>
                    </if>
                    <if test="cardno!=null&amp;&amp;cardno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.cardno=#cardno#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by  f.tmstmp  ]]></str>
        </dynamicSql>
    </dynamicSelect>
    <dynamicSelect cache="none" method="selectAll" type="sql" id="selKnsAcsqInfosByAcctOrSqWithBradnaExp" longname="查询会计流水表详细信息(带品牌名称导出明细)">
        <parameterMap class="java.util.Map">
            <parameter property="mntrsq" ref="DpDict.Froz.mntrsq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="主交易流水" parameterType="condition"/>
            <parameter property="bgindt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="起始日期" parameterType="condition"/>
            <parameter property="endddt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="截止日期" parameterType="condition"/>
            <parameter property="acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="账号" parameterType="condition"/>
            <parameter property="sortno" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="序号" parameterType="condition"/>
            <parameter property="acctna" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNA" mode="in" longname="账户名称" parameterType="condition"/>
            <parameter property="amntcd" jdbcType="VARCHAR" javaType="BaseEnumType.E_AMNTCD" mode="in" longname="借贷标志" parameterType="condition"/>
            <parameter property="atowtp" jdbcType="VARCHAR" javaType="PbEnumType.E_ATOWTP" mode="in" longname="会计主体" parameterType="condition"/>
            <parameter property="tranam" jdbcType="VARCHAR" javaType="BaseType.U_TRANAM" mode="in" longname="交易金额" parameterType="condition"/>
            <parameter property="bradna" jdbcType="VARCHAR" javaType="BaseType.U_CHAR50" mode="in" longname="品牌名称" parameterType="condition"/>
            <parameter property="cardno" jdbcType="VARCHAR" javaType="BaseType.U_CARDNO" mode="in" longname="卡号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTypGenEAccountInfo.IoKnsAcsqInfoWithBradna"/>
        <dynamicSql type="db2">
            <str type="Str"><![CDATA[select * from
(
select a.trandt,a.mntrsq,a.fileid prcscd, g.description prcsna,
a.acctno,case when a.atowtp='1' then d.acctna  else c.acctna end as acctna,
a.crcycd,a.amntcd,a.tranam,a.atowtp,a.bltype,a.transq, h.userid tranus,
case when trim(a.cuacno) is not null then a.cuacno else b.custac end as cuacno,a.dtitcd,
a.acctbr,a.sortno,b.bradna, 
e.cardno, a.tmstmp
 from kns_acsq a
 left join kna_sbad b
 on a.acctno=b.acctno
 left join kna_acct c
 on (a.acctno=c.acctno)
 left join gl_kna_acct d
 on (a.acctno=d.acctno)
 left join kna_acdc e
 on(b.custac=e.custac)
 left join tsp_service_in g
 on(a.fileid=g.inner_service_code)
 left join knl_bill h
 on(a.transq=h.transq)
) f]]></str>
            <where type="Where">
                <and type="And">
                    <if test="bgindt!=null &amp;&amp;bgindt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.trandt>=#bgindt#]]></str>
                    </if>
                    <if test="endddt !=null &amp;&amp;endddt !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.trandt <= #endddt#]]></str>
                    </if>
                    <if test="mntrsq !=null &amp;&amp; mntrsq !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.mntrsq =#mntrsq#]]></str>
                    </if>
                    <if test="acctno!=null&amp;&amp;acctno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.acctno=#acctno#]]></str>
                    </if>
                    <if test="sortno!=null&amp;&amp;sortno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.sortno=#sortno#]]></str>
                    </if>
                    <if test="acctna!=null&amp;&amp;acctna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.acctna=#acctna#]]></str>
                    </if>
                    <if test="amntcd!=null" type="If">
                        <str type="Str"><![CDATA[f.amntcd=#amntcd#]]></str>
                    </if>
                    <if test="atowtp!=null" type="If">
                        <str type="Str"><![CDATA[f.atowtp=#atowtp#]]></str>
                    </if>
                    <if test="tranam!=null&amp;&amp;tranam!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.tranam=#tranam#]]></str>
                    </if>
                    <if test="bradna!=null&amp;&amp;bradna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.bradna=#bradna#]]></str>
                    </if>
                    <if test="cardno!=null&amp;&amp;cardno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.cardno=#cardno#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by  f.tmstmp  ]]></str>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[
            select * from
(
select a.trandt,a.mntrsq,a.fileid prcscd, g.description prcsna,
a.acctno,case when a.atowtp='1' then d.acctna  else c.acctna end as acctna,
a.crcycd,a.amntcd,a.tranam,a.atowtp,a.bltype,a.transq, h.userid tranus,
case when trim(a.cuacno) is not null then a.cuacno else b.custac end as cuacno,a.dtitcd,
a.acctbr,a.sortno,b.bradna, 
e.cardno, a.tmstmp
 from kns_acsq a
 left join kna_sbad b
 on a.acctno=b.acctno
 left join kna_acct c
 on (a.acctno=c.acctno)
 left join gl_kna_acct d
 on (a.acctno=d.acctno)
 left join kna_acdc e
 on(b.custac=e.custac)
 left join tsp_service_in g
 on(a.fileid=g.inner_service_code)
 left join knl_bill h
 on(a.transq=h.transq)
) f]]></str>
            <where type="Where">
                <and type="And">
                    <if test="bgindt!=null &amp;&amp;bgindt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.trandt>=#bgindt#]]></str>
                    </if>
                    <if test="endddt !=null &amp;&amp;endddt !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.trandt <= #endddt#]]></str>
                    </if>
                    <if test="mntrsq !=null &amp;&amp; mntrsq !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.mntrsq =#mntrsq#]]></str>
                    </if>
                    <if test="acctno!=null&amp;&amp;acctno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.acctno=#acctno#]]></str>
                    </if>
                    <if test="sortno!=null&amp;&amp;sortno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.sortno=#sortno#]]></str>
                    </if>
                    <if test="acctna!=null&amp;&amp;acctna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.acctna=#acctna#]]></str>
                    </if>
                    <if test="amntcd!=null" type="If">
                        <str type="Str"><![CDATA[f.amntcd=#amntcd#]]></str>
                    </if>
                    <if test="atowtp!=null" type="If">
                        <str type="Str"><![CDATA[f.atowtp=#atowtp#]]></str>
                    </if>
                    <if test="tranam!=null&amp;&amp;tranam!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.tranam=#tranam#]]></str>
                    </if>
                    <if test="bradna!=null&amp;&amp;bradna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.bradna=#bradna#]]></str>
                    </if>
                    <if test="cardno!=null&amp;&amp;cardno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.cardno=#cardno#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by  f.tmstmp  ]]></str>
        </dynamicSql>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[
            select * from
(
select a.trandt,a.mntrsq,a.fileid prcscd, g.description prcsna,
a.acctno,case when a.atowtp='1' then d.acctna  else c.acctna end as acctna,
a.crcycd,a.amntcd,a.tranam,a.atowtp,a.bltype,a.transq, h.userid tranus,
case when trim(a.cuacno) is not null then a.cuacno else b.custac end as cuacno,a.dtitcd,
a.acctbr,a.sortno,b.bradna, 
e.cardno, a.tmstmp
 from kns_acsq a
 left join kna_sbad b
 on a.acctno=b.acctno
 left join kna_acct c
 on (a.acctno=c.acctno)
 left join gl_kna_acct d
 on (a.acctno=d.acctno)
 left join kna_acdc e
 on(b.custac=e.custac)
 left join tsp_service_in g
 on(a.fileid=g.inner_service_code)
 left join knl_bill h
 on(a.transq=h.transq)
) f]]></str>
            <where type="Where">
                <and type="And">
                    <if test="bgindt!=null &amp;&amp;bgindt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.trandt>=#bgindt#]]></str>
                    </if>
                    <if test="endddt !=null &amp;&amp;endddt !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.trandt <= #endddt#]]></str>
                    </if>
                    <if test="mntrsq !=null &amp;&amp; mntrsq !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.mntrsq =#mntrsq#]]></str>
                    </if>
                    <if test="acctno!=null&amp;&amp;acctno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.acctno=#acctno#]]></str>
                    </if>
                    <if test="sortno!=null&amp;&amp;sortno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.sortno=#sortno#]]></str>
                    </if>
                    <if test="acctna!=null&amp;&amp;acctna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.acctna=#acctna#]]></str>
                    </if>
                    <if test="amntcd!=null" type="If">
                        <str type="Str"><![CDATA[f.amntcd=#amntcd#]]></str>
                    </if>
                    <if test="atowtp!=null" type="If">
                        <str type="Str"><![CDATA[f.atowtp=#atowtp#]]></str>
                    </if>
                    <if test="tranam!=null&amp;&amp;tranam!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.tranam=#tranam#]]></str>
                    </if>
                    <if test="bradna!=null&amp;&amp;bradna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.bradna=#bradna#]]></str>
                    </if>
                    <if test="cardno!=null&amp;&amp;cardno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[f.cardno=#cardno#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by  f.tmstmp  ]]></str>
        </dynamicSql>
    </dynamicSelect>
</sqls>
