<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<sqls xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="Ca" longname="电子账户SQL" package="cn.sunline.ltts.busi.ca.namedsql" xsi:noNamespaceSchemaLocation="ltts-model.xsd">
    <select cache="none" method="selectOne" type="sql" id="getCardInfo" longname="获取电子账户卡信息">
        <sql type="oracle"><![CDATA[
    	select
    	    	b.* 
    	from
    	    	kna_acdc a 
    	join
    	    	kcd_card b 
    	    	    	on a.cardno = b.cardno 
    	where
    	    	a.status = '1' and a.custac = #custac#
    	]]></sql>
        <sql type="mysql"><![CDATA[
    	select
    	    	b.* 
    	from
    	    	kna_acdc a 
    	join
    	    	kcd_card b 
    	    	    	on a.cardno = b.cardno 
    	where
    	    	a.status = '1' and a.custac = #custac#
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CHAR35" mode="in" longname="电子账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KcdCard"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selFacctByCustac" longname="查询电子账户活期负债信息">
        <sql type="mysql"><![CDATA[
    	select
    	    	c.*, d.cardno 
    	from
    	    	kna_acdc d 
    	join
    	    	(
    	    	    	select
    	    	    	    	a.custac ,a.custno,a.accttp, a.custna,
    	    	    	    	b.subsac,b.acctno 
    	    	    	from
    	    	    	    	kna_cust a 
    	    	    	join
    	    	    	    	kna_accs b 
    	    	    	    	    	on a.custac=b.custac 
    	    	    	where
    	    	    	    	a.custac=#custac# and b.fcflag='0204' 
    	    	    	    	and b.prodtp='0'
    	    	) c 
    	    	    	on d.custac=c.custac
    	]]></sql>
        <sql type="oracle"><![CDATA[
    	select
    	    	c.*, d.cardno 
    	from
    	    	kna_acdc d 
    	join
    	    	(
    	    	    	select
    	    	    	    	a.custac ,a.custno,a.accttp, a.custna,
    	    	    	    	b.subsac,b.acctno 
    	    	    	from
    	    	    	    	kna_cust a 
    	    	    	join
    	    	    	    	kna_accs b 
    	    	    	    	    	on a.custac=b.custac 
    	    	    	where
    	    	    	    	a.custac=#custac# and b.fcflag='0204' 
    	    	    	    	and b.prodtp='0'
    	    	) c 
    	    	    	on d.custac=c.custac
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="string" mode="in" longname="电子账户" parameterType="condition"/>
        </parameterMap>
        <resultMap class="FacctInfo.facctInfo"/>
    </select>
    <update method="update" id="updateBindCaStatus" longname="解除绑卡状态">
        <sql type="oracle"><![CDATA[
    	update
    	    	kna_cacd 
    	set
    	    	status = '2',tmstmp=#tmstmp# 
    	where
    	    	custac=#custac# and cardno =#cardno# 
    	]]></sql>
        <sql type="mysql"><![CDATA[
    	update
    	    	kna_cacd 
    	set
    	    	status = '2',tmstmp=#tmstmp# 
    	where
    	    	custac=#custac# and cardno =#cardno# 
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" ref="QtDict.Qt.custac" jdbcType="VARCHAR" javaType="PbBaseType.U_CUSTAC" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="cardno" jdbcType="VARCHAR" javaType="BaseType.U_CHAR40" mode="in" longname="交易卡号" parameterType="condition"/>
            <parameter property="tmstmp" ref="ApDict.Aplt.tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <select cache="none" method="selectOne" type="sql" id="selAcctByCustacAndProdtp" longname="查询状态为正常的电子账户信息">
        <sql type="oracle"><![CDATA[
    	select
    	    	a.* 
    	from
    	    	kna_cust a 
    	join
    	    	kna_accs b 
    	    	    	on (
    	    	    	    	a.custac = b.custac
    	    	    	) 
    	where
    	    	a.acctst = '1' and b.acctst = '1' 
    	    	and a.custac = #custac# and b.prodtp = #prodtp# 
    	]]></sql>
        <sql type="mysql"><![CDATA[
    	select
    	    	a.* 
    	from
    	    	kna_cust a 
    	join
    	    	kna_accs b 
    	    	    	on (
    	    	    	    	a.custac = b.custac 
    	    	    	) 
    	where
    	    	a.acctst = '1' and b.acctst = '1' 
    	    	and a.custac = #custac# and b.prodtp = #prodtp# select
    	    	    	a.* 
    	    	from
    	    	    	kna_cust a 
    	    	join
    	    	    	kna_accs b 
    	    	    	    	on (
    	    	    	    	    	a.custac = b.custac 
    	    	    	    	) 
    	    	where
    	    	    	a.acctst = '1' 
    	    	    	and b.acctst = '1' and a.custac = #custac# 
    	    	    	and b.prodtp = #prodtp# 
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="prodtp" jdbcType="VARCHAR" javaType="DpEnumType.E_PRODTP" mode="in" longname="产品类型" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KnaCust"/>
    </select>
    <update method="update" id="updateBindCaSt" longname="如果卡处于关闭状态再次绑定，更改它的状态">
        <sql type="oracle"><![CDATA[
    	update
    	    	kna_cacd 
    	set
    	    	status = '1',tmstmp=#tmstmp# 
    	where
    	    	custac=#custac# and cardno =#cardno#
    	]]></sql>
        <sql type="mysql"><![CDATA[
    	update
    	    	kna_cacd 
    	set
    	    	status = '1',tmstmp=#tmstmp# 
    	where
    	    	custac=#custac# and cardno =#cardno#
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" ref="QtDict.Qt.custac" jdbcType="VARCHAR" javaType="PbBaseType.U_CUSTAC" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="cardno" jdbcType="VARCHAR" javaType="BaseType.U_CHAR40" mode="in" longname="交易卡号" parameterType="condition"/>
            <parameter property="tmstmp" ref="ApDict.Aplt.tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <dynamicSelect cache="none" method="selectPage" type="sql" id="getEacctInfos" longname="获取电子账户信息列表">
        <parameterMap class="java.util.Map">
            <parameter property="ecctno" ref="CaDict.Eacct.ecctno" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="teleno" ref="DpDict.Acct.teleno" jdbcType="VARCHAR" javaType="BaseType.U_TELENO" mode="in" longname="电话号码" parameterType="condition"/>
            <parameter property="custna" ref="DpDict.Acct.custna" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNA" mode="in" longname="客户名称" parameterType="condition"/>
            <parameter property="idtftp" ref="DpDict.Acct.idtftp" jdbcType="VARCHAR" javaType="BaseEnumType.E_IDTFTP" mode="in" longname="证件类型" parameterType="condition"/>
            <parameter property="idtfno" ref="DpDict.Acct.idtfno" jdbcType="VARCHAR" javaType="BaseType.U_IDTFNO" mode="in" longname="证件号码" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTypGenEAccountInfo.QryEacctInfos"/>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select (select cardno from kna_acdc where custac=b.custac and status=1) as cardin ,(select cardno from kna_cacd where custac=b.custac and status=1) as cardou ,b.custac as ecctno, a.custna, a.idtftp, a.idtfno, a.opendt, a.emails, a.teleno, a.addres, b.accttp,b.acctst
  from cif_cust a, kna_cust b]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[a.custno = b.custno]]></str>
                    <if test="ecctno!=null&amp;&amp;ecctno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[b.custac = #ecctno#]]></str>
                    </if>
                    <if test="teleno!=null&amp;&amp;teleno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.teleno = #teleno#]]></str>
                    </if>
                    <if test="custna!=null&amp;&amp;custna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.custna like '%'||#custna#||'%']]></str>
                    </if>
                    <if test="idtftp!=null" type="If">
                        <str type="Str"><![CDATA[a.idtftp = #idtftp#]]></str>
                    </if>
                    <if test="idtfno!=null&amp;&amp;idtfno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.idtfno = #idtfno#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by b.custac]]></str>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[select (select cardno from kna_acdc where custac=b.custac and status=1) as cardin ,(select cardno from kna_cacd where custac=b.custac and status=1) as cardou ,b.custac as ecctno, a.custna, a.idtftp, a.idtfno, a.opendt, a.emails, a.teleno, a.addres, b.accttp,b.acctst
  from cif_cust a, kna_cust b]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[a.custno = b.custno]]></str>
                    <if test="ecctno!=null&amp;&amp;ecctno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[b.custac = #ecctno#]]></str>
                    </if>
                    <if test="teleno!=null&amp;&amp;teleno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.teleno = #teleno#]]></str>
                    </if>
                    <if test="custna!=null&amp;&amp;custna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.custna like '%'||#custna#||'%']]></str>
                    </if>
                    <if test="idtftp!=null" type="If">
                        <str type="Str"><![CDATA[a.idtftp = #idtftp#]]></str>
                    </if>
                    <if test="idtfno!=null&amp;&amp;idtfno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.idtfno = #idtfno#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by b.custac]]></str>
        </dynamicSql>
    </dynamicSelect>
    <dynamicSelect cache="none" method="selectOne" type="sql" id="countEacctInfos" longname="获取电子账户信息列表">
        <parameterMap class="java.util.Map">
            <parameter property="ecctno" ref="CaDict.Eacct.ecctno" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="teleno" ref="DpDict.Acct.teleno" jdbcType="VARCHAR" javaType="BaseType.U_TELENO" mode="in" longname="电话号码" parameterType="condition"/>
            <parameter property="custna" ref="DpDict.Acct.custna" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNA" mode="in" longname="客户名称" parameterType="condition"/>
            <parameter property="idtftp" ref="DpDict.Acct.idtftp" jdbcType="VARCHAR" javaType="BaseEnumType.E_IDTFTP" mode="in" longname="证件类型" parameterType="condition"/>
            <parameter property="idtfno" ref="DpDict.Acct.idtfno" jdbcType="VARCHAR" javaType="BaseType.U_IDTFNO" mode="in" longname="证件号码" parameterType="condition"/>
        </parameterMap>
        <resultMap class="long"/>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select count(a.custno) from cif_cust a, kna_cust b]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[a.custno = b.custno]]></str>
                    <if test="ecctno!=null&amp;&amp;ecctno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[b.custac = #ecctno#]]></str>
                    </if>
                    <if test="teleno!=null&amp;&amp;teleno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.teleno = #teleno#]]></str>
                    </if>
                    <if test="custna!=null&amp;&amp;custna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.custna like '%'||#custna#||'%']]></str>
                    </if>
                    <if test="idtftp!=null" type="If">
                        <str type="Str"><![CDATA[a.idtftp = #idtftp#]]></str>
                    </if>
                    <if test="idtfno!=null&amp;&amp;idtfno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.idtfno = #idtfno#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[select count(a.custno) from cif_cust a, kna_cust b]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[a.custno = b.custno]]></str>
                    <if test="ecctno!=null&amp;&amp;ecctno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[b.custac = #ecctno#]]></str>
                    </if>
                    <if test="teleno!=null&amp;&amp;teleno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.teleno = #teleno#]]></str>
                    </if>
                    <if test="custna!=null&amp;&amp;custna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.custna like '%'||#custna#||'%']]></str>
                    </if>
                    <if test="idtftp!=null" type="If">
                        <str type="Str"><![CDATA[a.idtftp = #idtftp#]]></str>
                    </if>
                    <if test="idtfno!=null&amp;&amp;idtfno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.idtfno = #idtfno#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
    </dynamicSelect>
    <select cache="none" method="selectFirst" type="sql" id="selKnaCustByCustno" longname="根据客户号查询电子账号">
        <sql type="oracle"><![CDATA[
    	select
    	    	* 
    	from
    	    	kna_cust 
    	where
    	    	custno = #custno# and cacttp = #csactp# 
    	    	and acctst <> '2'
    	]]></sql>
        <sql type="mysql"><![CDATA[
    	select
    	    	* 
    	from
    	    	kna_cust 
    	where
    	    	custno = #custno# and cacttp = #csactp# 
    	    	and acctst <> '2'
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custno" jdbcType="VARCHAR" javaType="BaseType.U_CHAR30" mode="in" longname="客户号" parameterType="condition"/>
            <parameter property="csactp" jdbcType="VARCHAR" javaType="DpEnumType.E_CUSACT" mode="in" longname="客户账号类型" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KnaCust"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selAccsByProdtp" longname="根据产品类型查询子账户号">
        <sql type="oracle"><![CDATA[
    	select
    	    	* 
    	from
    	    	kna_accs 
    	where
    	    	custac = #custac# and prodtp = #prodtp# 
    	    	and acctst <> '2'
    	]]></sql>
        <sql type="mysql"><![CDATA[
    	select
    	    	* 
    	from
    	    	kna_accs 
    	where
    	    	custac = #custac# and prodtp = #prodtp# 
    	    	and acctst <> '2'
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="string" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="prodtp" jdbcType="VARCHAR" javaType="DpEnumType.E_PRODTP" mode="in" longname="机构号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KnaAccs"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selKnCustAll" longname="电子账户导出数据">
        <sql type="oracle"><![CDATA[
    	select
    	    	* 
    	from
    	    	kna_cust 
    	order by
    	    	custac
    	]]></sql>
        <sql type="mysql"><![CDATA[
    	select
    	    	* 
    	from
    	    	kna_cust 
    	order by
    	    	custac
    	]]></sql>
        <parameterMap class="java.util.Map"/>
        <resultMap class="ElectronicAccount.KnaCust"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selKnaAccsAll" longname="电子账户与子账户关联表导出数据">
        <sql type="oracle"><![CDATA[
    	select
    	    	* 
    	from
    	    	kna_accs 
    	order by
    	    	custac
    	]]></sql>
        <sql type="mysql"><![CDATA[
    	select
    	    	* 
    	from
    	    	kna_accs 
    	order by
    	    	custac
    	]]></sql>
        <parameterMap class="java.util.Map"/>
        <resultMap class="ElectronicAccount.KnaAccs"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selKcdCardAll" longname="内部卡导出数据">
        <sql type="oracle"><![CDATA[select * from kcd_card order by cardno]]></sql>
        <sql type="mysql"><![CDATA[select * from kcd_card order by cardno]]></sql>
        <parameterMap class="java.util.Map"/>
        <resultMap class="ElectronicAccount.KcdCard"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selKnaCacdAll" longname="外部卡当前卡及历史绑卡记录导出数据">
        <sql type="oracle"><![CDATA[select * from kna_cacd order by custac]]></sql>
        <sql type="mysql"><![CDATA[select * from kna_cacd order by custac]]></sql>
        <parameterMap class="java.util.Map"/>
        <resultMap class="ElectronicAccount.KnaCacd"/>
    </select>
    <dynamicSelect cache="none" method="selectAll" type="sql" id="selKnaCustInfoByDatetm" longname="生成KnaCust增量文件">
        <parameterMap class="java.util.Map">
            <parameter property="datetm" jdbcType="VARCHAR" javaType="string" mode="in" longname="日期" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KnaCust"/>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[SELECT * FROM kna_cust]]></str>
            <where type="Where">
                <and type="And">
                    <if test="datetm!=null&amp;datetm!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[tmstmp=#datetm#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[SELECT * FROM kna_cust]]></str>
            <where type="Where">
                <and type="And">
                    <if test="datetm!=null&amp;datetm!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[tmstmp=#datetm#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
    </dynamicSelect>
    <select cache="none" method="selectOne" type="sql" id="selClientLedgerByCardno" longname="根据电子账号客户端分户账查询">
        <sql><![CDATA[
    	select
    	    	acct.acctno,acdc.cardno,cust.custac,cust.custna,accs.custid,
    	    	accs.custcd, cust.acctst,'0000000000' acctsz,cust.accttp,cust.brchno,
    	    	acal.acalno teleno, acct.crcycd,acct.onlnbl,0 acctbl,cust.opendt,
    	    	0 acctam,null acctInfoList 
    	from
    	    	kna_acdc acdc 
    	inner join
    	    	kna_cust cust 
    	    	    	on(
    	    	    	    	acdc.custac = cust.custac
    	    	    	) 
    	left join
    	    	kna_acal acal 
    	    	    	on(
    	    	    	    	cust.custac = acal.custac and acal.acaltp = '1' 
    	    	    	    	and acal.acalst = '1'
    	    	    	) 
    	inner join
    	    	kna_acct acct 
    	    	    	on(
    	    	    	    	cust.custac = acct.custac
    	    	    	) 
    	inner join
    	    	cif_cust_accs accs 
    	    	    	on(
    	    	    	    	cust.custno = accs.custno
    	    	    	) 
    	where
    	    	acdc.cardno = #cardno# and acct.acsetp = #acsetp# 
    	    	and acct.acctst <> '2' and accs.STATUS = '1'
    	]]></sql>
        <sql type="oracle"><![CDATA[
    	select
    	    	acct.acctno,acdc.cardno,cust.custac,cust.custna,accs.custid,
    	    	accs.custcd, cust.acctst,'0000000000' acctsz,cust.accttp,cust.brchno,
    	    	acal.acalno teleno, acct.crcycd,acct.onlnbl,0 acctbl,cust.opendt,
    	    	0 acctam,null acctInfoList 
    	from
    	    	kna_acdc acdc 
    	inner join
    	    	kna_cust cust 
    	    	    	on(
    	    	    	    	acdc.custac = cust.custac
    	    	    	) 
    	left join
    	    	kna_acal acal 
    	    	    	on(
    	    	    	    	cust.custac = acal.custac and acal.acaltp = '1' 
    	    	    	    	and acal.acalst = '1'
    	    	    	) 
    	inner join
    	    	kna_acct acct 
    	    	    	on(
    	    	    	    	cust.custac = acct.custac
    	    	    	) 
    	inner join
    	    	cif_cust_accs accs 
    	    	    	on(
    	    	    	    	cust.custno = accs.custno
    	    	    	) 
    	where
    	    	acdc.cardno = #cardno# and acct.acsetp = #acsetp# 
    	    	and acct.acctst <> '2' and accs.STATUS = '1'
    	]]></sql>
        <sql type="mysql"><![CDATA[
    	select
    	    	acct.acctno,acdc.cardno,cust.custac,cust.custna,accs.custid,
    	    	accs.custcd, cust.acctst,'0000000000' acctsz,cust.accttp,cust.brchno,
    	    	acal.acalno teleno, acct.crcycd,acct.onlnbl,0 acctbl,cust.opendt,
    	    	0 acctam,null acctInfoList 
    	from
    	    	kna_acdc acdc 
    	inner join
    	    	kna_cust cust 
    	    	    	on(
    	    	    	    	acdc.custac = cust.custac
    	    	    	) 
    	left join
    	    	kna_acal acal 
    	    	    	on(
    	    	    	    	cust.custac = acal.custac and acal.acaltp = '1' 
    	    	    	    	and acal.acalst = '1'
    	    	    	) 
    	inner join
    	    	kna_acct acct 
    	    	    	on(
    	    	    	    	cust.custac = acct.custac
    	    	    	) 
    	inner join
    	    	cif_cust_accs accs 
    	    	    	on(
    	    	    	    	cust.custno = accs.custno
    	    	    	) 
    	where
    	    	acdc.cardno = #cardno# and acct.acsetp = #acsetp# 
    	    	and acct.acctst <> '2' and accs.STATUS = '1'
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="cardno" jdbcType="VARCHAR" javaType="BaseType.U_CARDNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="acsetp" ref="DpDict.Acct.acsetp" jdbcType="VARCHAR" javaType="BaseEnumType.E_ACSETP" mode="in" longname="子账号类型" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTypGenEAccountInfo.IoCaClientLedgerOut"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selProdInfoListByCustac" longname="查询亲情钱包产品信息">
        <sql type="db2"><![CDATA[
    	select
    	    	substr(relt.relaip,locate(',',relt.relaip) +1) || '(' || cust.custna || ')' prodna,wact.onlnbl 
    	from
    	    	kna_acct wact 
    	inner join
    	    	kna_relt relt 
    	    	    	on(
    	    	    	    	wact.acctno = relt.acctno
    	    	    	) 
    	inner join
    	    	kna_cust cust 
    	    	    	on(
    	    	    	    	relt.elacct = cust.custno
    	    	    	) 
    	where
    	    	wact.custac = #custac#
    	]]></sql>
        <sql type="oracle"><![CDATA[
    	select
    	    	substr(relt.relaip,instr(relt.relaip,',') +1) || '(' || cust.custna || ')' prodna,wact.onlnbl 
    	from
    	    	kna_acct wact 
    	inner join
    	    	kna_relt relt 
    	    	    	on(
    	    	    	    	wact.acctno = relt.acctno
    	    	    	) 
    	inner join
    	    	kna_cust cust 
    	    	    	on(
    	    	    	    	relt.elacct = cust.custno
    	    	    	) 
    	where
    	    	wact.custac = #custac#
    	]]></sql>
        <sql type="mysql"><![CDATA[
    	select
    	    	substr(relt.relaip,locate(',',relt.relaip) +1) + '(' + cust.custna + ')' prodna,wact.onlnbl 
    	from
    	    	kna_acct wact 
    	inner join
    	    	kna_relt relt 
    	    	    	on(
    	    	    	    	wact.acctno = relt.acctno
    	    	    	) 
    	inner join
    	    	kna_cust cust 
    	    	    	on(
    	    	    	    	relt.elacct = cust.custno
    	    	    	) 
    	where
    	    	wact.custac = #custac#
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUSTAC" mode="in" longname="电子账号ID" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTypGenEAccountInfo.IoCaProdInfo"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selPdtlInfoListByCustac" longname="查询资产产品类型列表">
        <sql type="db2"><![CDATA[
    	select
    	    	'11' pdtltp,sum(onlnbl) pdtlam 
    	from
    	    	(select
    	    	    	* 
    	    	from
    	    	    	kna_acct acct 
    	    	where
    	    	    	acct.custac = #custac# and acct.acsetp in (
    	    	    	    	'01','04'
    	    	    	)) a 
    	union
    	all select
    	    	'12' pdtltp,sum(onlnbl) pdtlam 
    	from
    	    	(select
    	    	    	* 
    	    	from
    	    	    	kna_fxac fxac 
    	    	where
    	    	    	fxac.custac = #custac# 
    	    	    	and fxac.acsetp in (
    	    	    	    	'05','07'
    	    	    	)) b 
    	union
    	all select
    	    	'13' pdtltp,sum(onlnbl) pdtlam 
    	from
    	    	(select
    	    	    	* 
    	    	from
    	    	    	kna_acct acct 
    	    	where
    	    	    	acct.custac = #custac# and acct.acsetp = '02') c 
    	union
    	all select
    	    	'14' pdtltp,sum(onlnbl) pdtlam 
    	from
    	    	(select
    	    	    	* 
    	    	from
    	    	    	kna_acct acct 
    	    	where
    	    	    	acct.custac = #custac# 
    	    	    	and acct.acsetp = '06') d 
    	union
    	all select
    	    	'15' pdtltp,
    	    	sum(onlnbl) pdtlam 
    	from
    	    	(select
    	    	    	* 
    	    	from
    	    	    	kna_acct acct 
    	    	where
    	    	    	acct.custac = #custac# and acct.acsetp = '03') e 
    	union
    	all select
    	    	'21' pdtltp,sum(nowtam) pdtlam 
    	from
    	    	(select
    	    	    	* 
    	    	from
    	    	    	fna_acct fnat 
    	    	where
    	    	    	fnat.custac = #custac#) f
    	]]></sql>
        <sql type="oracle"><![CDATA[
    	select
    	    	'11' pdtltp,sum(onlnbl) pdtlam 
    	from
    	    	(select
    	    	    	* 
    	    	from
    	    	    	kna_acct acct 
    	    	where
    	    	    	acct.custac = #custac# and acct.acsetp in (
    	    	    	    	'01','04'
    	    	    	)) a 
    	union
    	all select
    	    	'12' pdtltp,sum(onlnbl) pdtlam 
    	from
    	    	(select
    	    	    	* 
    	    	from
    	    	    	kna_fxac fxac 
    	    	where
    	    	    	fxac.custac = #custac# 
    	    	    	and fxac.acsetp in (
    	    	    	    	'05','07'
    	    	    	)) b 
    	union
    	all select
    	    	'13' pdtltp,sum(onlnbl) pdtlam 
    	from
    	    	(select
    	    	    	* 
    	    	from
    	    	    	kna_acct acct 
    	    	where
    	    	    	acct.custac = #custac# and acct.acsetp = '02') c 
    	union
    	all select
    	    	'14' pdtltp,sum(onlnbl) pdtlam 
    	from
    	    	(select
    	    	    	* 
    	    	from
    	    	    	kna_acct acct 
    	    	where
    	    	    	acct.custac = #custac# 
    	    	    	and acct.acsetp = '06') d 
    	union
    	all select
    	    	'15' pdtltp,
    	    	sum(onlnbl) pdtlam 
    	from
    	    	(select
    	    	    	* 
    	    	from
    	    	    	kna_acct acct 
    	    	where
    	    	    	acct.custac = #custac# and acct.acsetp = '03') e 
    	union
    	all select
    	    	'21' pdtltp,sum(nowtam) pdtlam 
    	from
    	    	(select
    	    	    	* 
    	    	from
    	    	    	fna_acct fnat 
    	    	where
    	    	    	fnat.custac = #custac#) f
    	]]></sql>
        <sql type="mysql"><![CDATA[
    	select
    	    	'11' pdtltp,sum(onlnbl) pdtlam 
    	from
    	    	(select
    	    	    	* 
    	    	from
    	    	    	kna_acct acct 
    	    	where
    	    	    	acct.custac = #custac# and acct.acsetp in (
    	    	    	    	'01','04'
    	    	    	)) a 
    	union
    	all select
    	    	'12' pdtltp,sum(onlnbl) pdtlam 
    	from
    	    	(select
    	    	    	* 
    	    	from
    	    	    	kna_fxac fxac 
    	    	where
    	    	    	fxac.custac = #custac# 
    	    	    	and fxac.acsetp in (
    	    	    	    	'05','07'
    	    	    	)) b 
    	union
    	all select
    	    	'13' pdtltp,sum(onlnbl) pdtlam 
    	from
    	    	(select
    	    	    	* 
    	    	from
    	    	    	kna_acct acct 
    	    	where
    	    	    	acct.custac = #custac# and acct.acsetp = '02') c 
    	union
    	all select
    	    	'14' pdtltp,sum(onlnbl) pdtlam 
    	from
    	    	(select
    	    	    	* 
    	    	from
    	    	    	kna_acct acct 
    	    	where
    	    	    	acct.custac = #custac# 
    	    	    	and acct.acsetp = '06') d 
    	union
    	all select
    	    	'15' pdtltp,
    	    	sum(onlnbl) pdtlam 
    	from
    	    	(select
    	    	    	* 
    	    	from
    	    	    	kna_acct acct 
    	    	where
    	    	    	acct.custac = #custac# and acct.acsetp = '03') e 
    	union
    	all select
    	    	'21' pdtltp,sum(nowtam) pdtlam 
    	from
    	    	(select
    	    	    	* 
    	    	from
    	    	    	fna_acct fnat 
    	    	where
    	    	    	fnat.custac = #custac#) f
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUSTAC" mode="in" longname="电子账号ID" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTypGenEAccountInfo.IoCaPdtlInfoList"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selCardnoByIdtftpIdtfno" longname="根据证件获取电子账号">
        <sql><![CDATA[
    	select
    	    	acdc.cardno cardno 
    	from
    	    	cif_cust cifc 
    	inner join
    	    	kna_cust cust 
    	    	    	on (
    	    	    	    	cifc.custno = cust.custno
    	    	    	) 
    	inner join
    	    	kna_acdc acdc 
    	    	    	on (
    	    	    	    	cust.custac = acdc.custac
    	    	    	) 
    	where
    	    	cifc.idtftp = #idtftp# and cifc.idtfno = #idtfno# 
    	    	and cust.ACCTST <> '2'
    	]]></sql>
        <sql type="oracle"><![CDATA[
    	select
    	    	acdc.cardno cardno 
    	from
    	    	cif_cust cifc 
    	inner join
    	    	kna_cust cust 
    	    	    	on (
    	    	    	    	cifc.custno = cust.custno
    	    	    	) 
    	inner join
    	    	kna_acdc acdc 
    	    	    	on (
    	    	    	    	cust.custac = acdc.custac
    	    	    	) 
    	where
    	    	cifc.idtftp = #idtftp# and cifc.idtfno = #idtfno# 
    	    	and cust.ACCTST <> '2'
    	]]></sql>
        <sql type="mysql"><![CDATA[
    	select
    	    	acdc.cardno cardno 
    	from
    	    	cif_cust cifc 
    	inner join
    	    	kna_cust cust 
    	    	    	on (
    	    	    	    	cifc.custno = cust.custno
    	    	    	) 
    	inner join
    	    	kna_acdc acdc 
    	    	    	on (
    	    	    	    	cust.custac = acdc.custac
    	    	    	) 
    	where
    	    	cifc.idtftp = #idtftp# and cifc.idtfno = #idtfno# 
    	    	and cust.ACCTST <> '2'
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="idtftp" jdbcType="VARCHAR" javaType="BaseEnumType.E_IDTFTP" mode="in" longname="证件类型" parameterType="condition"/>
            <parameter property="idtfno" jdbcType="VARCHAR" javaType="BaseType.U_IDTFNO" mode="in" longname="证件号码" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.lang.String"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selCustacByCustid" longname="根据用户ID获取电子账号ID">
        <sql type="db2"><![CDATA[select cust.* from kna_cust cust
left join cif_cust_accs accs on(accs.custno = cust.custno)
where accs.custid = #custid#
and accs.STATUS = '1'
and cust.ACCTST <> '2']]></sql>
        <sql type="oracle"><![CDATA[select cust.* from kna_cust cust
left join cif_cust_accs accs on(accs.custno = cust.custno)
where accs.custid = #custid#
and accs.STATUS = '1'
and cust.ACCTST <> '2']]></sql>
        <sql type="mysql"><![CDATA[select cust.* from kna_cust cust
left join cif_cust_accs accs on(accs.custno = cust.custno)
where accs.custid = #custid#
and accs.STATUS = '1'
and cust.ACCTST <> '2']]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custid" ref="BaseDict.Comm.custid" jdbcType="VARCHAR" javaType="BaseType.U_CUSTID" mode="in" longname="用户ID" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KnaCust"/>
    </select>
    <update method="update" id="updKnaAccsByAcctno" longname="根据负债账号更新负债账号客户账号对应表信息">
        <sql><![CDATA[update kna_accs set acctst=#acctst#,tmstmp=#tmstmp# where acctno=#acctno#]]></sql>
        <sql type="oracle"><![CDATA[update kna_accs set acctst=#acctst#,tmstmp=#tmstmp# where acctno=#acctno#]]></sql>
        <sql type="mysql"><![CDATA[update kna_accs set acctst=#acctst#,tmstmp=#tmstmp# where acctno=#acctno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctst" jdbcType="VARCHAR" javaType="BaseEnumType.E_ACCTST" mode="in" parameterType="condition"/>
            <parameter property="acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" parameterType="condition"/>
            <parameter property="tmstmp" ref="ApDict.Aplt.tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <update method="update" id="updKnaSignDetlBySignno" longname="修改签约明细表中的下次日期">
        <sql><![CDATA[
    	update
    	    	kna_sign_detl 
    	set
    	    	currdt=#currdt#, nextdt=#nextdt# , tmstmp=#tmstmp# 
    	where
    	    	signno=#signno# and signst=#signst# 
    	    	and signtp=#signtp#
    	]]></sql>
        <sql type="oracle"><![CDATA[
    	update
    	    	kna_sign_detl 
    	set
    	    	currdt=#currdt#, nextdt=#nextdt# , tmstmp=#tmstmp# 
    	where
    	    	signno=#signno# and signst=#signst# 
    	    	and signtp=#signtp#
    	]]></sql>
        <sql type="mysql"><![CDATA[
    	update
    	    	kna_sign_detl 
    	set
    	    	currdt=#currdt#, nextdt=#nextdt# , tmstmp=#tmstmp# 
    	where
    	    	signno=#signno# and signst=#signst# 
    	    	and signtp=#signtp#
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="currdt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="当前日期" parameterType="condition"/>
            <parameter property="nextdt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="下个日期" parameterType="condition"/>
            <parameter property="signno" jdbcType="VARCHAR" javaType="BaseType.U_SENOTP" mode="in" longname="签约号" parameterType="condition"/>
            <parameter property="signst" jdbcType="VARCHAR" javaType="CaEnumType.E_SIGNST" mode="in" longname="签约状态" parameterType="condition"/>
            <parameter property="signtp" jdbcType="VARCHAR" javaType="CaEnumType.E_SIGNTP" mode="in" longname="签约类型" parameterType="condition"/>
            <parameter property="tmstmp" ref="ApDict.Aplt.tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <select cache="none" method="selectOne" type="sql" id="selMaxCardnoByCardno" longname="根据卡号查询最大卡号">
        <sql type="db2"><![CDATA[select max(acctno) as acctno from dpb_pswd where acctno like concat(#cdrlno#,'%')]]></sql>
        <sql type="oracle"><![CDATA[select max(acctno) as acctno from dpb_pswd where acctno like concat(#cdrlno#,'%')]]></sql>
        <sql type="mysql"><![CDATA[select max(acctno) as acctno from dpb_pswd where acctno like concat(#cdrlno#,'%')]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="cdrlno" jdbcType="VARCHAR" javaType="BaseType.U_CHAR20" mode="in" longname="卡规则号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.lang.String"/>
    </select>
    <dynamicSelect cache="none" method="selectPage" type="sql" id="selEacctTransDetail" longname="查询电子账号转账明细">
        <parameterMap class="java.util.Map">
            <parameter property="ecctno" ref="CaDict.Eacct.ecctno" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="corpno" ref="ApDict.Aplt.corpno" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ServEacctType.EacctTransDetailInfoOut"/>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select a.*  from knl_iobl a]]></str>
            <where type="Where">
                <and type="And">
                    <if test="ecctno !=null &amp;&amp; ecctno !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.cuacno = #ecctno#]]></str>
                    </if>
                    <if test="corpno !=null &amp;&amp; corpno !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.corpno = #corpno#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[select a.*  from knl_iobl a]]></str>
            <where type="Where">
                <and type="And">
                    <if test="ecctno !=null &amp;&amp; ecctno !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.cuacno = #ecctno#]]></str>
                    </if>
                    <if test="corpno !=null &amp;&amp; corpno !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.corpno = #corpno#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
    </dynamicSelect>
    <dynamicSelect cache="none" method="selectOne" type="sql" id="selTotalCount" longname="查询电子账号转账明细">
        <parameterMap class="java.util.Map">
            <parameter property="ecctno" ref="CaDict.Eacct.ecctno" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="corpno" ref="ApDict.Aplt.corpno" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.lang.String"/>
        <dynamicSql type="db2">
            <str type="Str"><![CDATA[select count(*)  from knl_iobl a]]></str>
            <where type="Where">
                <and type="And">
                    <if test="ecctno !=null &amp;&amp; ecctno !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.cuacno = #ecctno#]]></str>
                    </if>
                    <if test="corpno !=null &amp;&amp; corpno !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.corpno = #corpno#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select count(*)  from knl_iobl a]]></str>
            <where type="Where">
                <and type="And">
                    <if test="ecctno !=null &amp;&amp; ecctno !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.cuacno = #ecctno#]]></str>
                    </if>
                    <if test="corpno !=null &amp;&amp; corpno !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.corpno = #corpno#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[select count(*)  from knl_iobl a]]></str>
            <where type="Where">
                <and type="And">
                    <if test="ecctno !=null &amp;&amp; ecctno !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.cuacno = #ecctno#]]></str>
                    </if>
                    <if test="corpno !=null &amp;&amp; corpno !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.corpno = #corpno#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
    </dynamicSelect>
    <select cache="none" method="selectOne" type="sql" id="selTransResult" longname="交易是否成功查证">
        <sql type="db2"><![CDATA[
    	select
    	    	case when a.ERROCD ='00000000' then '1' else '0' end as status ,a.MTRASQ,a.TRANDT 
    	from
    	    	kapp_jioybw a 
    	where
    	    	a.MTRASQ =#mtrasq# 
    	]]></sql>
        <sql type="oracle"><![CDATA[
    	select
    	    	case when a.ERROCD ='00000000' then '1' else '0' end as status ,a.MTRASQ,a.TRANDT 
    	from
    	    	kapp_jioybw a 
    	where
    	    	a.MTRASQ =#mtrasq# 
    	]]></sql>
        <sql type="mysql"><![CDATA[
    	select
    	    	case when a.ERROCD ='00000000' then '1' else '0' end as status ,a.MTRASQ,a.TRANDT 
    	from
    	    	kapp_jioybw a 
    	where
    	    	a.MTRASQ =#mtrasq# 
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="mtrasq" jdbcType="VARCHAR" javaType="PbBaseType.U_TRNSEQ" mode="in" longname="原交易流水" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTypGenEAccountInfo.IoCaInfoOut"/>
    </select>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selOpenrtResult" longname="查询批量开户结果信息">
        <parameterMap class="java.util.Map">
            <parameter property="btchno" ref="PbDict.Dcmt.btchno" jdbcType="VARCHAR" javaType="BaseType.U_CHAR12" mode="in" longname="当前批号" parameterType="condition"/>
            <parameter property="corpno" ref="ApDict.Aplt.corpno" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
            <parameter property="openrt" jdbcType="VARCHAR" javaType="CaEnumType.E_OPENRS" mode="in" longname="开户结果" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ServEacctType.EacctBtoprtInfo"/>
        <dynamicSql type="db2">
            <str type="Str"><![CDATA[select cardno,custna,accttp,brchno,idtftp,idtfno,custid,angtna agntna,openrt openrs,losern 
from  knb_opbt a left join kna_acdc b on a.CUSTAC = b.CUSTAC ]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[btchno =#btchno# and a.corpno = #corpno#]]></str>
                    <if test="openrt !=null " type="If">
                        <str type="Str"><![CDATA[openrt =#openrt#]]></str>
                    </if>
                    <str type="Str"><![CDATA[a.openrt <> '1']]></str>
                </and>
            </where>
        </dynamicSql>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select cardno,custna,accttp,brchno,idtftp,idtfno,custid,angtna agntna,openrt openrs,losern 
from  knb_opbt a left join kna_acdc b on a.CUSTAC = b.CUSTAC ]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[btchno =#btchno# and a.corpno = #corpno#]]></str>
                    <if test="openrt !=null " type="If">
                        <str type="Str"><![CDATA[openrt =#openrt#]]></str>
                    </if>
                    <str type="Str"><![CDATA[a.openrt <> '1']]></str>
                </and>
            </where>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[select cardno,custna,accttp,brchno,idtftp,idtfno,custid,angtna agntna,openrt openrs,losern 
from  knb_opbt a left join kna_acdc b on a.CUSTAC = b.CUSTAC ]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[btchno =#btchno# and a.corpno = #corpno#]]></str>
                    <if test="openrt !=null " type="If">
                        <str type="Str"><![CDATA[openrt =#openrt#]]></str>
                    </if>
                    <str type="Str"><![CDATA[a.openrt <> '1']]></str>
                </and>
            </where>
        </dynamicSql>
    </dynamicSelect>
    <dynamicSelect cache="none" method="selectOne" type="sql" id="selOpenrtResultCount" longname="查询批量开户结果总笔数">
        <parameterMap class="java.util.Map">
            <parameter property="btchno" ref="PbDict.Dcmt.btchno" jdbcType="VARCHAR" javaType="BaseType.U_CHAR12" mode="in" longname="当前批号" parameterType="condition"/>
            <parameter property="openrt" jdbcType="VARCHAR" javaType="CaEnumType.E_OPENRS" mode="in" longname="开户结果" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.lang.String"/>
        <dynamicSql type="db2">
            <str type="Str"><![CDATA[select count(*) from knb_opbt]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[btchno =#btchno#]]></str>
                    <if test="openrt !=null " type="If">
                        <str type="Str"><![CDATA[openrt =#openrt#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[select count(*) from knb_opbt]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[btchno =#btchno#]]></str>
                    <if test="openrt !=null " type="If">
                        <str type="Str"><![CDATA[openrt =#openrt#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select count(*) from knb_opbt]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[btchno =#btchno#]]></str>
                    <if test="openrt !=null " type="If">
                        <str type="Str"><![CDATA[openrt =#openrt#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
    </dynamicSelect>
    <update method="update" id="updKnaCustMpckrt" longname="更新电子账户人脸识别结果">
        <sql type="db2"><![CDATA[update kna_cust set mpckrt = #revirs#,tmstmp=#tmstmp# where custac = #custac#]]></sql>
        <sql type="oracle"><![CDATA[update kna_cust set mpckrt = #revirs#,tmstmp=#tmstmp# where custac = #custac#]]></sql>
        <sql type="mysql"><![CDATA[update kna_cust set mpckrt = #revirs#,tmstmp=#tmstmp# where custac = #custac#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUSTAC" mode="in" longname="电子账户ID" parameterType="condition"/>
            <parameter property="revirs" jdbcType="VARCHAR" javaType="CaEnumType.E_MPCKRT" mode="in" longname="审核状态" parameterType="condition"/>
            <parameter property="tmstmp" ref="ApDict.Aplt.tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <update method="update" id="updKnaPromMpckrt" longname="更新电子账户升级登记薄人脸识别结果">
        <sql type="db2"><![CDATA[update knb_prom set mpckrt = #revirs# ,tmstmp=#tmstmp# where custac = #custac#]]></sql>
        <sql type="oracle"><![CDATA[update knb_prom set mpckrt = #revirs# ,tmstmp=#tmstmp# where custac = #custac#]]></sql>
        <sql type="mysql"><![CDATA[update knb_prom set mpckrt = #revirs# ,tmstmp=#tmstmp# where custac = #custac#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUSTAC" mode="in" longname="电子账户ID" parameterType="condition"/>
            <parameter property="revirs" jdbcType="VARCHAR" javaType="CaEnumType.E_MPCKRT" mode="in" longname="审核状态" parameterType="condition"/>
            <parameter property="tmstmp" ref="ApDict.Aplt.tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <select cache="none" method="selectAll" type="sql" id="selAccatpByCustac" longname="根据电子账号ID查询电子账户分类">
        <sql type="db2"><![CDATA[
    	select
    	    	addt.accatp 
    	from
    	    	kna_accs accs 
    	inner join
    	    	kna_acct_addt addt 
    	    	    	on(
    	    	    	    	accs.acctno = addt.acctno
    	    	    	) 
    	where
    	    	accs.custac =#custac# and accs.acctst <> '2'
    	]]></sql>
        <sql type="oracle"><![CDATA[
    	select
    	    	addt.accatp 
    	from
    	    	kna_accs accs 
    	inner join
    	    	kna_acct_addt addt 
    	    	    	on(
    	    	    	    	accs.acctno = addt.acctno
    	    	    	) 
    	where
    	    	accs.custac =#custac# and accs.acctst <> '2']]></sql>
        <sql type="mysql"><![CDATA[
    	select
    	    	addt.accatp 
    	from
    	    	kna_accs accs 
    	inner join
    	    	kna_acct_addt addt 
    	    	    	on(
    	    	    	    	accs.acctno = addt.acctno
    	    	    	) 
    	where
    	    	accs.custac =#custac# and accs.acctst <> '2']]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUSTAC" mode="in" longname="电子账号ID" parameterType="condition"/>
        </parameterMap>
        <resultMap class="BaseEnumType.E_ACCATP"/>
    </select>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selAccknbagntByBrchno" longname="通过机构号查询代理单位信息">
        <parameterMap class="java.util.Map">
            <parameter property="brchno" jdbcType="VARCHAR" javaType="string" mode="in" longname="机构号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTable.IoCaKnaagntinfo"/>
        <dynamicSql type="db2">
            <str type="Str"><![CDATA[select a.* from knb_agnt a]]></str>
            <where type="Where">
                <if test="brchno != null" type="If">
                    <str type="Str"><![CDATA[brchno = #brchno#]]></str>
                </if>
            </where>
            <str type="Str"><![CDATA[order by a.tmstmp desc]]></str>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[select a.* from knb_agnt a]]></str>
            <where type="Where">
                <if test="brchno != null" type="If">
                    <str type="Str"><![CDATA[brchno = #brchno#]]></str>
                </if>
            </where>
            <str type="Str"><![CDATA[order by a.tmstmp desc]]></str>
        </dynamicSql>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select a.* from knb_agnt a]]></str>
            <where type="Where">
                <if test="brchno != null" type="If">
                    <str type="Str"><![CDATA[brchno = #brchno#]]></str>
                </if>
            </where>
            <str type="Str"><![CDATA[order by a.tmstmp desc]]></str>
        </dynamicSql>
    </dynamicSelect>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selOpenAcct" longname="开户登记簿查询">
        <parameterMap class="java.util.Map">
            <parameter property="cardno" jdbcType="VARCHAR" javaType="BaseType.U_CARDNO" mode="in" longname="卡号" parameterType="condition"/>
            <parameter property="orgnbr" jdbcType="VARCHAR" javaType="BaseType.U_BRCHNO" mode="in" longname="机构码" parameterType="condition"/>
            <parameter property="bgindt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="起始日期" parameterType="condition"/>
            <parameter property="matudt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="终止日期" parameterType="condition"/>
            <parameter property="crcycd" ref="CaDict.Eacct.crcycd" jdbcType="VARCHAR" javaType="BaseType.U_CRCYCD" mode="in" longname="币种" parameterType="condition"/>
            <parameter property="csextg" ref="CaDict.Eacct.csextg" jdbcType="VARCHAR" javaType="BaseEnumType.E_CSEXTG" mode="in" longname="钞汇标志" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTypGenEAccountInfo.IoCaOpenAccInfo"/>
        <dynamicSql type="db2">
            <str type="Str"><![CDATA[select a.custac,a.custna,a.accttp,a.acalno,a.crcycd,a.csextg,
a.brchno,a.opendt,a.chnlid,a.openus,a.opensq,b.idtftp,b.idtfno,c.cardno from knb_opac a,cif_cust b,kna_acdc c,kna_cust d]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[a.custac = d.custac and b.custno=d.custno and c.custac=d.custac]]></str>
                    <if test="cardno!=null &amp;&amp; cardno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[c.cardno = #cardno#]]></str>
                    </if>
                    <if test="orgnbr!=null &amp;&amp; orgnbr!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.brchno = #orgnbr#]]></str>
                    </if>
                    <if test="crcycd!=null &amp;&amp; crcycd!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.crcycd = #crcycd#]]></str>
                    </if>
                    <if test="bgindt!=null &amp;&amp; bgindt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.opendt between #bgindt# and #matudt# ]]></str>
                    </if>
                    <if test="csextg!=null" type="If">
                        <str type="Str"><![CDATA[a.csextg = #csextg#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[select a.custac,a.custna,a.accttp,a.acalno,a.crcycd,a.csextg,
a.brchno,a.opendt,a.opensv,a.openus,a.opensq,b.idtftp,b.idtfno,c.cardno from knb_opac a,cif_cust b,kna_acdc c,kna_cust d]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[a.custac = d.custac and b.custno=d.custno and c.custac=d.custac]]></str>
                    <if test="cardno!=null &amp;&amp; cardno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[c.cardno = #cardno#]]></str>
                    </if>
                    <if test="orgnbr!=null &amp;&amp; orgnbr!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.brchno = #orgnbr#]]></str>
                    </if>
                    <if test="crcycd!=null &amp;&amp; crcycd!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.crcycd = #crcycd#]]></str>
                    </if>
                    <if test="bgindt!=null &amp;&amp; bgindt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.opendt between #bgindt# and #matudt# ]]></str>
                    </if>
                    <if test="csextg!=null" type="If">
                        <str type="Str"><![CDATA[a.csextg = #csextg#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select a.custac,a.custna,a.accttp,a.acalno,a.crcycd,a.csextg,
a.brchno,a.opendt,a.chnlid,a.openus,a.opensq,b.idtftp,b.idtfno,c.cardno from knb_opac a,cif_cust b,kna_acdc c,kna_cust d]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[a.custac = d.custac and b.custno=d.custno and c.custac=d.custac]]></str>
                    <if test="cardno!=null &amp;&amp; cardno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[c.cardno = #cardno#]]></str>
                    </if>
                    <if test="orgnbr!=null &amp;&amp; orgnbr!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.brchno = #orgnbr#]]></str>
                    </if>
                    <if test="crcycd!=null &amp;&amp; crcycd!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.crcycd = #crcycd#]]></str>
                    </if>
                    <if test="bgindt!=null &amp;&amp; bgindt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.opendt between #bgindt# and #matudt# ]]></str>
                    </if>
                    <if test="csextg!=null" type="If">
                        <str type="Str"><![CDATA[a.csextg = #csextg#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by a.opendt,c.cardno]]></str>
        </dynamicSql>
    </dynamicSelect>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selList" longname="销户查询">
        <parameterMap class="java.util.Map">
            <parameter property="cardno" jdbcType="VARCHAR" javaType="BaseType.U_CARDNO" mode="in" longname="卡号" parameterType="condition"/>
            <parameter property="orgnbr" jdbcType="VARCHAR" javaType="string" mode="in" longname="机构号" parameterType="condition"/>
            <parameter property="bgindt" jdbcType="VARCHAR" javaType="string" mode="in" longname="起始日期" parameterType="condition"/>
            <parameter property="matudt" jdbcType="VARCHAR" javaType="string" mode="in" longname="到期日期 " parameterType="condition"/>
            <parameter property="crcycd" ref="CaDict.Eacct.crcycd" jdbcType="VARCHAR" javaType="BaseType.U_CRCYCD" mode="in" longname="币种" parameterType="condition"/>
            <parameter property="csextg" ref="CaDict.Eacct.csextg" jdbcType="VARCHAR" javaType="BaseEnumType.E_CSEXTG" mode="in" longname="钞汇标志" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTypGenEAccountInfo.IoCaQryInfoList"/>
        <dynamicSql type="db2">
            <str type="Str"><![CDATA[select a.custac,a.custna,a.accttp,a.crcycd,a.csextg,a.closam,
a.tnacno,a.closdt,a.closbr,a.closwy clostp,a.closus,a.clossv clsosv,
a.clossq,b.idtftp,b.idtfno,c.cardno from knb_clac a,cif_cust b,kna_acdc c,kna_cust d ]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[a.status = '1' and a.custac = d.custac and b.custno=d.custno and c.custac=d.custac]]></str>
                    <if test="cardno!=null &amp;&amp; cardno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[c.cardno = #cardno#]]></str>
                    </if>
                    <if test="orgnbr!=null &amp;&amp; orgnbr!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.closbr = #orgnbr#]]></str>
                    </if>
                    <if test="crcycd!=null" type="If">
                        <str type="Str"><![CDATA[a.crcycd = #crcycd#]]></str>
                    </if>
                    <if test="bgindt!=null&amp;&amp;bgindt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.closdt between #bgindt# and (#matudt#+1)]]></str>
                    </if>
                    <if test="csextg!=null" type="If">
                        <str type="Str"><![CDATA[a.csextg=#csextg#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select a.custac,a.custna,a.accttp,a.crcycd,a.csextg,a.closam,
a.tnacno,a.closdt,a.closbr,a.closwy clostp,a.closus,a.clossv clsosv,
a.clossq,b.idtftp,b.idtfno,c.cardno from knb_clac a,cif_cust b,kna_acdc c,kna_cust d ]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[a.status = '1' and a.custac = d.custac and b.custno=d.custno and c.custac=d.custac]]></str>
                    <if test="cardno!=null &amp;&amp; cardno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[c.cardno = #cardno#]]></str>
                    </if>
                    <if test="orgnbr!=null &amp;&amp; orgnbr!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.closbr = #orgnbr#]]></str>
                    </if>
                    <if test="crcycd!=null" type="If">
                        <str type="Str"><![CDATA[a.crcycd = #crcycd#]]></str>
                    </if>
                    <if test="bgindt!=null&amp;&amp;bgindt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.closdt between #bgindt# and (#matudt#+1)]]></str>
                    </if>
                    <if test="csextg!=null" type="If">
                        <str type="Str"><![CDATA[a.csextg=#csextg#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by d.opendt,c.cardno]]></str>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[select a.custac,a.custna,a.accttp,a.crcycd,a.csextg,a.closam,
a.tnacno,a.closdt,a.closbr,a.closwy clostp,a.closus,a.clossv clsosv,
a.clossq,b.idtftp,b.idtfno,c.cardno from knb_clac a,cif_cust b,kna_acdc c,kna_cust d ]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[a.status = '1' and a.custac = d.custac and b.custno=d.custno and c.custac=d.custac]]></str>
                    <if test="cardno!=null &amp;&amp; cardno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[c.cardno = #cardno#]]></str>
                    </if>
                    <if test="orgnbr!=null &amp;&amp; orgnbr!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.closbr = #orgnbr#]]></str>
                    </if>
                    <if test="crcycd!=null" type="If">
                        <str type="Str"><![CDATA[a.crcycd = #crcycd#]]></str>
                    </if>
                    <if test="bgindt!=null&amp;&amp;bgindt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.closdt between #bgindt# and (#matudt#+1)]]></str>
                    </if>
                    <if test="csextg!=null" type="If">
                        <str type="Str"><![CDATA[a.csextg=#csextg#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
    </dynamicSelect>
    <select cache="none" method="selectPageWithCount" type="sql" id="selSuccOpenrtResult" longname="查询开户成功结果信息">
        <sql type="db2"><![CDATA[
    	select
    	    	cardno,custna,accttp,brchno,idtftp,
    	    	idtfno,custid,angtna agntna,openrt openrs,losern 
    	from
    	    	knb_opbt a 
    	left join
    	    	kna_acdc b 
    	    	    	on a.CUSTAC = b.CUSTAC 
    	where
    	    	btchno= #btchno# and a.corpno = #corpno# 
    	    	and openrt ='3'
    	]]></sql>
        <sql type="oracle"><![CDATA[
    	select
    	    	cardno,custna,accttp,brchno,idtftp,
    	    	idtfno,custid,angtna agntna,openrt openrs,losern 
    	from
    	    	knb_opbt a 
    	left join
    	    	kna_acdc b 
    	    	    	on a.CUSTAC = b.CUSTAC 
    	where
    	    	btchno= #btchno# and a.corpno = #corpno# 
    	    	and openrt ='3'
    	]]></sql>
        <sql type="mysql"><![CDATA[
    	select
    	    	cardno,custna,accttp,brchno,idtftp,
    	    	idtfno,custid,angtna agntna,openrt openrs,losern 
    	from
    	    	knb_opbt a 
    	left join
    	    	kna_acdc b 
    	    	    	on a.CUSTAC = b.CUSTAC 
    	where
    	    	btchno= #btchno# and a.corpno = #corpno# 
    	    	and openrt ='3'
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="btchno" jdbcType="VARCHAR" javaType="ApBaseType.U_PILJYLSH" mode="in" longname="批量交易批次号" parameterType="condition"/>
            <parameter property="corpno" ref="ApDict.Aplt.corpno" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ServEacctType.EacctBtoprtInfo"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selSuccOpenrtResultForCount" longname="查询批量开户成功笔数">
        <sql type="db2"><![CDATA[select count(*) from knb_opbt 
  where btchno= #btchno# and (openrt ='1' or openrt ='3')]]></sql>
        <sql type="oracle"><![CDATA[select count(*) from knb_opbt 
  where btchno= #btchno# and (openrt ='1' or openrt ='3')]]></sql>
        <sql type="mysql"><![CDATA[select count(*) from knb_opbt 
  where btchno= #btchno# and (openrt ='1' or openrt ='3')]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="btchno" jdbcType="VARCHAR" javaType="ApBaseType.U_PILJYLSH" mode="in" longname="批量交易批次号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.lang.String"/>
    </select>
    <select cache="none" method="selectPageWithCount" type="sql" id="selFailOpenrtResult" longname="查询批量开户失败信息">
        <sql type="db2"><![CDATA[select custac,custna,accttp,brchno,idtftp,idtfno,custid,angtna agntna,openrt openrs,losern from knb_opbt 
  where btchno= #btchno# and corpno = #corpno# and (openrt ='2' or openrt ='4')]]></sql>
        <sql type="oracle"><![CDATA[select custac,custna,accttp,brchno,idtftp,idtfno,custid,angtna agntna,openrt openrs,losern from knb_opbt 
  where btchno= #btchno# and corpno = #corpno# and (openrt ='2' or openrt ='4')]]></sql>
        <sql type="mysql"><![CDATA[select custac,custna,accttp,brchno,idtftp,idtfno,custid,angtna agntna,openrt openrs,losern from knb_opbt 
  where btchno= #btchno# and corpno = #corpno# and (openrt ='2' or openrt ='4')]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="btchno" jdbcType="VARCHAR" javaType="ApBaseType.U_PILJYLSH" mode="in" longname="批量交易批次号" parameterType="condition"/>
            <parameter property="corpno" ref="ApDict.Aplt.corpno" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ServEacctType.EacctBtoprtInfo"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selFailOpenrtResultForCount" longname="查询批量开户失败笔数">
        <sql type="db2"><![CDATA[select count(1) from knb_opbt 
  where btchno= #btchno# and (openrt ='2' or openrt ='4')]]></sql>
        <sql type="oracle"><![CDATA[select count(1) from knb_opbt 
  where btchno= #btchno# and (openrt ='2' or openrt ='4')]]></sql>
        <sql type="mysql"><![CDATA[select count(1) from knb_opbt 
  where btchno= #btchno# and (openrt ='2' or openrt ='4')]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="btchno" jdbcType="VARCHAR" javaType="ApBaseType.U_PILJYLSH" mode="in" longname="批量交易批次号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.lang.String"/>
    </select>
    <update method="update" id="updKnaAcalAcalst" longname="更新账户别名表关联状态">
        <sql type="db2"><![CDATA[update kna_acal set acalst= '2',tmstmp=#tmstmp# where acaltp = '1' and acalno= #acalno# and acalst= '1']]></sql>
        <sql type="oracle"><![CDATA[update kna_acal set acalst= '2',tmstmp=#tmstmp# where acaltp = '1' and acalno= #acalno# and acalst= '1']]></sql>
        <sql type="mysql"><![CDATA[update kna_acal set acalst= '2',tmstmp=#tmstmp# where acaltp = '1' and acalno= #acalno# and acalst= '1']]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acalno" ref="CaDict.Eacct.acalno" jdbcType="VARCHAR" javaType="BaseType.U_CHAR30" mode="in" longname="账户别名" parameterType="condition"/>
            <parameter property="tmstmp" ref="ApDict.Aplt.tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <update method="update" id="updKnbPromInfos" longname="根据身份核查结果更新升级登记簿信息">
        <sql type="db2"><![CDATA[update knb_prom set idckrt = #idckrt#,promst = #promst#,promdt = #promdt#,transq = #transq#, tmstmp=#tmstmp# where custac = #custac# and promst = #promst1#]]></sql>
        <sql type="oracle"><![CDATA[update knb_prom set idckrt = #idckrt#,promst = #promst#,promdt = #promdt#,transq = #transq#, tmstmp=#tmstmp# where custac = #custac# and promst = #promst1#]]></sql>
        <sql type="mysql"><![CDATA[update knb_prom set idckrt = #idckrt#,promst = #promst#,promdt = #promdt#,transq = #transq#, tmstmp=#tmstmp# where custac = #custac# and promst = #promst1#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="idckrt" ref="CaDict.Eacct.idckrt" jdbcType="VARCHAR" javaType="CaEnumType.E_IDCKRT" mode="in" longname="身份核查结果" parameterType="condition"/>
            <parameter property="promst" ref="CaDict.Eacct.promst" jdbcType="VARCHAR" javaType="CaEnumType.E_PROMST" mode="in" longname="升级状态" parameterType="condition"/>
            <parameter property="promdt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" parameterType="condition"/>
            <parameter property="transq" ref="BaseDict.Comm.transq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="交易流水" parameterType="condition"/>
            <parameter property="custac" ref="CaDict.Eacct.custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="promst1" jdbcType="VARCHAR" javaType="CaEnumType.E_PROMST" mode="in" parameterType="condition"/>
            <parameter property="tmstmp" ref="ApDict.Aplt.tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <update method="update" id="updKnbPromInfosByMpckrt" longname="根据人脸核查结果更新升级登记簿信息">
        <sql type="db2"><![CDATA[update knb_prom set mpckrt= #mpckrt#,promst = #promst#,promdt = #promdt#,tmstmp=#tmstmp# where custac = #custac# and promst = #promst1#]]></sql>
        <sql type="oracle"><![CDATA[update knb_prom set mpckrt= #mpckrt#,promst = #promst#,promdt = #promdt#,tmstmp=#tmstmp# where custac = #custac# and promst = #promst1#]]></sql>
        <sql type="mysql"><![CDATA[update knb_prom set mpckrt= #mpckrt#,promst = #promst#,promdt = #promdt#,tmstmp=#tmstmp# where custac = #custac# and promst = #promst1#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="mpckrt" ref="CaDict.Eacct.mpckrt" jdbcType="VARCHAR" javaType="CaEnumType.E_MPCKRT" mode="in" longname="人脸识别结果" parameterType="condition"/>
            <parameter property="promst" ref="CaDict.Eacct.promst" jdbcType="VARCHAR" javaType="CaEnumType.E_PROMST" mode="in" longname="升级状态" parameterType="condition"/>
            <parameter property="promdt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" parameterType="condition"/>
            <parameter property="custac" ref="CaDict.Eacct.custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="promst1" jdbcType="VARCHAR" javaType="CaEnumType.E_PROMST" mode="in" parameterType="condition"/>
            <parameter property="tmstmp" ref="ApDict.Aplt.tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <select cache="none" method="selectOne" type="sql" id="selKnaReltIdckrt" longname="查询亲情关联关系表身份核查标志">
        <sql type="db2"><![CDATA[select * from kna_relt where reltid = #reltid#]]></sql>
        <sql type="oracle"><![CDATA[select * from kna_relt where reltid = #reltid#]]></sql>
        <sql type="mysql"><![CDATA[select * from kna_relt where reltid = #reltid#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="reltid" jdbcType="VARCHAR" javaType="BaseType.U_CHAR80" mode="in" longname="亲情关系ID" parameterType="condition"/>
        </parameterMap>
        <resultMap class="WaAcctType.IoWaKnaRelt"/>
    </select>
    <update method="update" id="updKnaReltInfo" longname="更新亲情钱包关联关系表">
        <sql type="db2"><![CDATA[update kna_relt set idckrt= #idckrt#,reltst = #reltst# ,tmstmp=#tmstmp#where reltid = #reltid#]]></sql>
        <sql type="oracle"><![CDATA[update kna_relt set idckrt= #idckrt#,reltst = #reltst# ,tmstmp=#tmstmp#where reltid = #reltid#]]></sql>
        <sql type="mysql"><![CDATA[update kna_relt set idckrt= #idckrt#,reltst = #reltst# ,tmstmp=#tmstmp#where reltid = #reltid#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="idckrt" ref="CaDict.Eacct.idckrt" jdbcType="VARCHAR" javaType="CaEnumType.E_IDCKRT" mode="in" longname="身份核查结果" parameterType="condition"/>
            <parameter property="reltst" ref="WaDict.WaAcc.reltst" jdbcType="VARCHAR" javaType="WaEnumType.E_RELTST" mode="in" longname="亲情钱包状态" parameterType="condition"/>
            <parameter property="reltid" jdbcType="VARCHAR" javaType="BaseType.U_CHAR80" mode="in" parameterType="condition"/>
            <parameter property="tmstmp" ref="ApDict.Aplt.tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <update method="update" id="updCifCustAccs" longname="更新客户信息关联表">
        <sql type="db2"><![CDATA[update cif_cust_accs set custcd = #custcd# where custid = #custid# and status = #status#]]></sql>
        <sql type="oracle"><![CDATA[update cif_cust_accs set custcd = #custcd# where custid = #custid# and status = #status#]]></sql>
        <sql type="mysql"><![CDATA[update cif_cust_accs set custcd = #custcd# where custid = #custid# and status = #status#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custcd" ref="BaseDict.Comm.custcd" jdbcType="VARCHAR" javaType="BaseType.U_CHAR20" mode="in" longname="客户内码" parameterType="condition"/>
            <parameter property="custid" ref="BaseDict.Comm.custid" jdbcType="VARCHAR" javaType="BaseType.U_CUSTID" mode="in" longname="用户ID" parameterType="condition"/>
            <parameter property="status" jdbcType="VARCHAR" javaType="BaseEnumType.E_STATUS" mode="in" longname="关联状态" parameterType="condition"/>
        </parameterMap>
    </update>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selTransNormal" longname="转账异常查询">
        <parameterMap class="java.util.Map">
            <parameter property="brchno" jdbcType="VARCHAR" javaType="BaseType.U_BRCHNO" mode="in" longname="机构号" parameterType="condition"/>
            <parameter property="bgdate" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="起始日期" parameterType="condition"/>
            <parameter property="endate" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="终止日期" parameterType="condition"/>
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号ID" parameterType="condition"/>
            <parameter property="tranam" jdbcType="VARCHAR" javaType="BaseType.U_TRANAM" mode="in" longname="销户金额" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTypGenEAccountInfo.qrbkCaOut"/>
        <dynamicSql type="db2">
            <str type="Str"><![CDATA[select a.brchno  ,trandt  , '1' as erortp,otacct as custac, otacna  as custna,tranam, inacct as toacct, inacna as toacna, servtp ,crcycd ,glacct as hungac ,glacna as hungna , glseeq as hungnb,descrb as erortx 
     from kns_tran_eror a ]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[erortp='1']]></str>
                    <if test="brchno!=null&amp;&amp;brchno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.brchno = #brchno#]]></str>
                    </if>
                    <if test="bgdate!=null&amp;&amp;bgdate!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt >= #bgdate#]]></str>
                    </if>
                    <if test="endate!=null&amp;&amp;endate!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt <= #endate#]]></str>
                    </if>
                    <if test="custac!=null&amp;&amp;custac!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[(a.inacct = #custac# or a.otacct = #custac#)]]></str>
                    </if>
                    <if test="tranam!=null" type="If">
                        <str type="Str"><![CDATA[a.tranam = #tranam#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[select a.brchno  ,trandt  , '1' as erortp,otacct as custac, otacna  as custna,tranam, inacct as toacct, inacna as toacna, servtp ,crcycd ,glacct as hungac ,glacna as hungna , glseeq as hungnb,descrb as erortx 
     from kns_tran_eror a ]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[erortp='1']]></str>
                    <if test="brchno!=null&amp;&amp;brchno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.brchno = #brchno#]]></str>
                    </if>
                    <if test="bgdate!=null&amp;&amp;bgdate!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt >= #bgdate#]]></str>
                    </if>
                    <if test="endate!=null&amp;&amp;endate!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt <= #endate#]]></str>
                    </if>
                    <if test="custac!=null&amp;&amp;custac!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[(a.inacct = #custac# or a.otacct = #custac#)]]></str>
                    </if>
                    <if test="tranam!=null" type="If">
                        <str type="Str"><![CDATA[a.tranam = #tranam#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select a.brchno  ,trandt  , '1' as erortp,otacct as custac, otacna  as custna,tranam, inacct as toacct, inacna as toacna, servtp ,crcycd ,glacct as hungac ,glacna as hungna , glseeq as hungnb,descrb as erortx 
     from kns_tran_eror a ]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[erortp='1']]></str>
                    <if test="brchno!=null&amp;&amp;brchno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.brchno = #brchno#]]></str>
                    </if>
                    <if test="bgdate!=null&amp;&amp;bgdate!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt >= #bgdate#]]></str>
                    </if>
                    <if test="endate!=null&amp;&amp;endate!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt <= #endate#]]></str>
                    </if>
                    <if test="custac!=null&amp;&amp;custac!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[(a.inacct = #custac# or a.otacct = #custac#)]]></str>
                    </if>
                    <if test="tranam!=null" type="If">
                        <str type="Str"><![CDATA[a.tranam = #tranam#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
    </dynamicSelect>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selCloseAbnormal" longname="销户异常查询">
        <parameterMap class="java.util.Map">
            <parameter property="brchno" jdbcType="VARCHAR" javaType="BaseType.U_BRCHNO" mode="in" longname="机构号" parameterType="condition"/>
            <parameter property="bgdate" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="起始日期" parameterType="condition"/>
            <parameter property="endate" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="终止日期" parameterType="condition"/>
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号ID" parameterType="condition"/>
            <parameter property="tranam" jdbcType="VARCHAR" javaType="BaseType.U_TRANAM" mode="in" longname="销户金额" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTypGenEAccountInfo.qrbkCaOut"/>
        <dynamicSql type="db2">
            <str type="Str"><![CDATA[select a.brchno  ,trandt  , '2' as erortp,otacct as custac, otacna  as custna,tranam, inacct as toacct, inacna as toacna, servtp ,crcycd ,glacct as hungac ,glacna as hungna , glseeq as hungnb,descrb as erortx 
     from kns_tran_eror a ]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[erortp='2']]></str>
                    <if test="brchno!=null&amp;&amp;brchno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.brchno = #brchno#]]></str>
                    </if>
                    <if test="bgdate!=null&amp;&amp;bgdate!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt >= #bgdate#]]></str>
                    </if>
                    <if test="endate!=null&amp;&amp;endate!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt <= #endate#]]></str>
                    </if>
                    <if test="custac!=null&amp;&amp;custac!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[(a.inacct = #custac# or a.otacct = #custac#)]]></str>
                    </if>
                    <if test="tranam!=null" type="If">
                        <str type="Str"><![CDATA[a.tranam = #tranam#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select a.brchno  ,trandt  , '2' as erortp,otacct as custac, otacna  as custna,tranam, inacct as toacct, inacna as toacna, servtp ,crcycd ,glacct as hungac ,glacna as hungna , glseeq as hungnb,descrb as erortx 
     from kns_tran_eror a ]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[erortp='2']]></str>
                    <if test="brchno!=null&amp;&amp;brchno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.brchno = #brchno#]]></str>
                    </if>
                    <if test="bgdate!=null&amp;&amp;bgdate!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt >= #bgdate#]]></str>
                    </if>
                    <if test="endate!=null&amp;&amp;endate!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt <= #endate#]]></str>
                    </if>
                    <if test="custac!=null&amp;&amp;custac!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[(a.inacct = #custac# or a.otacct = #custac#)]]></str>
                    </if>
                    <if test="tranam!=null" type="If">
                        <str type="Str"><![CDATA[a.tranam = #tranam#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[select a.brchno  ,trandt  , '2' as erortp,otacct as custac, otacna  as custna,tranam, inacct as toacct, inacna as toacna, servtp ,crcycd ,glacct as hungac ,glacna as hungna , glseeq as hungnb,descrb as erortx 
     from kns_tran_eror a ]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[erortp='2']]></str>
                    <if test="brchno!=null&amp;&amp;brchno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.brchno = #brchno#]]></str>
                    </if>
                    <if test="bgdate!=null&amp;&amp;bgdate!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt >= #bgdate#]]></str>
                    </if>
                    <if test="endate!=null&amp;&amp;endate!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trandt <= #endate#]]></str>
                    </if>
                    <if test="custac!=null&amp;&amp;custac!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[(a.inacct = #custac# or a.otacct = #custac#)]]></str>
                    </if>
                    <if test="tranam!=null" type="If">
                        <str type="Str"><![CDATA[a.tranam = #tranam#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
    </dynamicSelect>
    <select cache="none" method="selectFirst" type="sql" id="selKnbReclByTel" longname="根据手机号模糊查询电子账户卡号复用表">
        <sql type="db2"><![CDATA[select * from knb_recl where cardno like '%' || #teleno# || '%' and enabst = #enabst# order by cardno]]></sql>
        <sql type="oracle"><![CDATA[select * from knb_recl where cardno like '%' || #teleno# || '%' and enabst = #enabst# order by cardno]]></sql>
        <sql type="mysql"><![CDATA[
    	select
    	    	* 
    	from
    	    	knb_recl 
    	where
    	    	cardno like '%' + #teleno# + '%' and enabst = #enabst# 
    	order by
    	    	cardno
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="teleno" ref="BaseDict.Comm.teleno" jdbcType="VARCHAR" javaType="BaseType.U_TELENO" mode="in" longname="电话号码" parameterType="condition"/>
            <parameter property="enabst" ref="CaDict.Eacct.enabst" jdbcType="VARCHAR" javaType="CaEnumType.E_ENABST" mode="in" longname="启用状态" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KnbRecl"/>
    </select>
    <select cache="none" method="selectFirst" type="sql" id="selKnbReclInfo" longname="根据卡号第七位查询可复用信息">
        <sql type="db2"><![CDATA[
    	select
    	    	* 
    	from
    	    	knb_recl 
    	where
    	    	SUBSTR(CARDNO,7,1) not in(
    	    	    	'0','1'
    	    	) and enabst = #enabst# 
    	order by
    	    	cardno
    	]]></sql>
        <sql type="oracle"><![CDATA[
    	select
    	    	* 
    	from
    	    	knb_recl 
    	where
    	    	SUBSTR(CARDNO,7,1) not in(
    	    	    	'0','1'
    	    	) and enabst = #enabst# 
    	order by
    	    	cardno
    	]]></sql>
        <sql type="mysql"><![CDATA[
    	select
    	    	* 
    	from
    	    	knb_recl 
    	where
    	    	SUBSTR(CARDNO,7,1) not in(
    	    	    	'0','1'
    	    	) and enabst = #enabst# 
    	order by
    	    	cardno
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="enabst" ref="CaDict.Eacct.enabst" jdbcType="VARCHAR" javaType="CaEnumType.E_ENABST" mode="in" longname="启用状态" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KnbRecl"/>
    </select>
    <update method="update" id="updKnbReclEnabst" longname="更新电子账户卡号复用表启用状态">
        <sql type="db2"><![CDATA[update knb_recl set enabst = #enabst#,trandt = #trandt#,tmstmp = #tmstmp# where cardno = #cardno#]]></sql>
        <sql type="oracle"><![CDATA[update knb_recl set enabst = #enabst#,trandt = #trandt#,tmstmp = #tmstmp# where cardno = #cardno#]]></sql>
        <sql type="mysql"><![CDATA[update knb_recl set enabst = #enabst#,trandt = #trandt#,tmstmp = #tmstmp# where cardno = #cardno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="enabst" ref="CaDict.Eacct.enabst" jdbcType="VARCHAR" javaType="CaEnumType.E_ENABST" mode="in" longname="启用状态" parameterType="condition"/>
            <parameter property="cardno" jdbcType="VARCHAR" javaType="BaseType.U_CARDNO" mode="in" longname="卡号" parameterType="condition"/>
            <parameter property="trandt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="tmstmp" ref="ApDict.Aplt.tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <delete method="delete" id="delknbacifall" longname="全量删除涉案账号名单">
        <sql><![CDATA[delete from knb_acif]]></sql>
        <sql type="oracle"><![CDATA[delete from knb_acif]]></sql>
        <sql type="mysql"><![CDATA[delete from knb_acif]]></sql>
        <parameterMap class="java.util.Map"/>
    </delete>
    <delete method="delete" id="delknbacdball" longname="全量删除可疑账号名单">
        <sql><![CDATA[delete from knb_acdb]]></sql>
        <sql type="oracle"><![CDATA[delete from knb_acdb]]></sql>
        <sql type="mysql"><![CDATA[delete from knb_acdb]]></sql>
        <parameterMap class="java.util.Map"/>
    </delete>
    <select cache="none" method="selectOne" type="sql" id="selAcctByCustac" longname="根据电子账号ID查询电子账户信息">
        <sql><![CDATA[select * from kna_cust where custac =#custac#]]></sql>
        <sql type="oracle"><![CDATA[select * from kna_cust where custac =#custac#]]></sql>
        <sql type="mysql"><![CDATA[select * from kna_cust where custac =#custac#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" ref="BaseDict.Comm.custac" jdbcType="VARCHAR" javaType="BaseType.U_CHAR32" mode="in" longname="客户账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTable.IoCaKnaCust"/>
    </select>
    <select cache="none" method="selectFirst" type="sql" id="selKnaAcdcByCustac" longname="根据电子账号查询最新一条卡客户账号对照表记录">
        <sql><![CDATA[select a.* from kna_acdc a where a.custac=#custac#  order by tmstmp desc]]></sql>
        <sql type="oracle"><![CDATA[select a.* from kna_acdc a where a.custac=#custac#  order by tmstmp desc]]></sql>
        <sql type="mysql"><![CDATA[select a.* from kna_acdc a where a.custac=#custac#  order by tmstmp desc]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" ref="BaseDict.Comm.custac" jdbcType="VARCHAR" javaType="BaseType.U_CHAR32" mode="in" longname="客户账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KnaAcdc"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnaCustByCustac" longname="根据电子账号查询电子账户表">
        <sql><![CDATA[select a.* from kna_cust a where a.custac=#custac# ]]></sql>
        <sql type="oracle"><![CDATA[select a.* from kna_cust a where a.custac=#custac# ]]></sql>
        <sql type="mysql"><![CDATA[select a.* from kna_cust a where a.custac=#custac# ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" ref="BaseDict.Comm.custac" jdbcType="VARCHAR" javaType="BaseType.U_CHAR32" mode="in" longname="客户账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KnaCust"/>
    </select>
    <update method="update" id="updKnaSignDetlinfo" longname="二类户升级一类户签约信息更新">
        <sql type="db2"><![CDATA[update kna_sign_detl a set a.ACCTNO = #acctno#,a.PRODCD = #prodcd# ,a.tmstmp=#tmstmp# where a.ACCTNO = #acctnm# and a.SIGNST = #signst#
]]></sql>
        <sql type="oracle"><![CDATA[update kna_sign_detl a set a.ACCTNO = #acctno#,a.PRODCD = #prodcd# ,a.tmstmp=#tmstmp# where a.ACCTNO = #acctnm# and a.SIGNST = #signst#
]]></sql>
        <sql type="mysql"><![CDATA[update kna_sign_detl a set a.ACCTNO = #acctno#,a.PRODCD = #prodcd# ,a.tmstmp=#tmstmp# where a.ACCTNO = #acctnm# and a.SIGNST = #signst#
]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" ref="DpDict.Acct.acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="负债账号" parameterType="condition"/>
            <parameter property="prodcd" ref="DpDict.Prod.prodcd" jdbcType="VARCHAR" javaType="BaseType.U_PRODCD" mode="in" longname="产品编号" parameterType="condition"/>
            <parameter property="acctnm" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="解约负债账号" parameterType="condition"/>
            <parameter property="signst" jdbcType="VARCHAR" javaType="CaEnumType.E_SIGNST" mode="in" longname="签约状态" parameterType="condition"/>
            <parameter property="tmstmp" ref="ApDict.Aplt.tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <select cache="none" method="selectOne" type="sql" id="selKnaAcdcByCardno" longname="根据虚拟卡号查询电子账户表">
        <sql type="db2"><![CDATA[select * from  kna_acdc  where CARDNO = #cardno# and STATUS = #status#
]]></sql>
        <sql type="oracle"><![CDATA[select * from  kna_acdc  where CARDNO = #cardno# and STATUS = #status#
]]></sql>
        <sql type="mysql"><![CDATA[select * from  kna_acdc  where CARDNO = #cardno# and STATUS = #status#
]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="cardno" ref="BaseDict.Comm.cardno" jdbcType="VARCHAR" javaType="BaseType.U_CARDNO" mode="in" longname="交易卡号" parameterType="condition"/>
            <parameter property="status" jdbcType="VARCHAR" javaType="BaseEnumType.E_DPACST" mode="in" longname="状态" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KnaAcdc"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnaAcalByAcalno" longname="根据手机号查询账户信息别名表">
        <sql type="db2"><![CDATA[select * from kna_acal where acalno = #acalno# and acalst=#acalst# and acaltp = #acaltp#]]></sql>
        <sql type="oracle"><![CDATA[select * from kna_acal where acalno = #acalno# and acalst=#acalst# and acaltp = #acaltp#]]></sql>
        <sql type="mysql"><![CDATA[select * from kna_acal where acalno = #acalno# and acalst=#acalst# and acaltp = #acaltp#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acalno" ref="CaDict.Eacct.acalno" jdbcType="VARCHAR" javaType="BaseType.U_CHAR30" mode="in" longname="账户别名" parameterType="condition"/>
            <parameter property="acaltp" ref="CaDict.Eacct.acaltp" jdbcType="VARCHAR" javaType="CaEnumType.E_ACALTP" mode="in" longname="账户别名类型" parameterType="condition"/>
            <parameter property="acalst" ref="CaDict.Eacct.acalst" jdbcType="VARCHAR" javaType="CaEnumType.E_ACALST" mode="in" longname="关联状态" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KnaAcal"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnaAcalByAcalnoAndAcalst" longname="根据手机号查询账户信息别名表">
        <sql type="db2"><![CDATA[select * from kna_acal where acalno = #acalno# and acaltp = #acaltp# and acalst = '1']]></sql>
        <sql type="oracle"><![CDATA[select * from kna_acal where acalno = #acalno# and acaltp = #acaltp# and acalst = '1']]></sql>
        <sql type="mysql"><![CDATA[select * from kna_acal where acalno = #acalno# and acaltp = #acaltp# and acalst = '1']]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acalno" ref="CaDict.Eacct.acalno" jdbcType="VARCHAR" javaType="BaseType.U_CHAR30" mode="in" longname="账户别名" parameterType="condition"/>
            <parameter property="acaltp" ref="CaDict.Eacct.acaltp" jdbcType="VARCHAR" javaType="CaEnumType.E_ACALTP" mode="in" longname="账户别名类型" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KnaAcal"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selknbCksqByCkrtsq" longname="根据核查流水号查询身份核查流水登记簿">
        <sql type="db2"><![CDATA[select * from knb_cksq where ckrtsq = #ckrtsq#]]></sql>
        <sql type="oracle"><![CDATA[select * from knb_cksq where ckrtsq = #ckrtsq#]]></sql>
        <sql type="mysql"><![CDATA[select * from knb_cksq where ckrtsq = #ckrtsq#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="ckrtsq" ref="CaDict.Eacct.ckrtsq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="核查流水号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KnbCksq"/>
    </select>
    <select cache="none" method="selectFirst" type="sql" id="selKnaAcalByCustac" longname="根据电子账号查询绑定手机号">
        <sql type="db2"><![CDATA[select * from kna_acal where custac = #custac# and acaltp = #acaltp# and acalst = #acalst# order by tmstmp desc]]></sql>
        <sql type="oracle"><![CDATA[select * from kna_acal where custac = #custac# and acaltp = #acaltp# and acalst = #acalst# order by tmstmp desc]]></sql>
        <sql type="mysql"><![CDATA[select * from kna_acal where custac = #custac# and acaltp = #acaltp# and acalst = #acalst# order by tmstmp desc]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" ref="CaDict.Eacct.custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="acaltp" ref="CaDict.Eacct.acaltp" jdbcType="VARCHAR" javaType="CaEnumType.E_ACALTP" mode="in" longname="账户别名类型" parameterType="condition"/>
            <parameter property="acalst" ref="CaDict.Eacct.acalst" jdbcType="VARCHAR" javaType="CaEnumType.E_ACALST" mode="in" longname="关联状态" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KnaAcal"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnbClacByCustac" longname="根据电子账号查询处理成功的销户登记簿记录">
        <sql type="db2"><![CDATA[select a.* from knb_clac a where a.custac=#custac# and a.status = #status#]]></sql>
        <sql type="oracle"><![CDATA[select a.* from knb_clac a where a.custac=#custac# and a.status = #status#]]></sql>
        <sql type="mysql"><![CDATA[select a.* from knb_clac a where a.custac=#custac# and a.status = #status#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" ref="CaDict.Eacct.custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="status" jdbcType="VARCHAR" javaType="DpEnumType.E_CLSTAT" mode="in" longname="销户状态" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KnbClac"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="knlSpndVerify" longname="电子账户消费查证">
        <sql type="db2"><![CDATA[select  case when a.status ='9' then '1' else '0' end as  status ,a.transq,a.TRANDT,a.transq  from knl_spnd  a 
where  a.transq =#retraq#  ]]></sql>
        <sql type="oracle"><![CDATA[select  case when a.status ='9' then '1' else '0' end as  status ,a.transq,a.TRANDT,a.transq  from knl_spnd  a 
where  a.transq =#retraq#  ]]></sql>
        <sql type="mysql"><![CDATA[select  case when a.status ='9' then '1' else '0' end as  status ,a.transq,a.TRANDT,a.transq  from knl_spnd  a 
where  a.transq =#retraq#  ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="retraq" jdbcType="VARCHAR" javaType="BaseType.U_CHAR32" mode="in" longname="原交易流水号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTypGenEAccountInfo.IoCaInfoOut"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="knlCnapotVerify" longname="大小额查证">
        <sql><![CDATA[select  case when a.status ='9' then '1' else '0' end as  status ,a.transq,a.TRANDT from knl_cnapot a
		where  a.transq =#retraq# ]]></sql>
        <sql type="oracle"><![CDATA[select  case when a.status ='9' then '1' else '0' end as  status ,a.transq,a.TRANDT from knl_cnapot a
		where  a.transq =#retraq# ]]></sql>
        <sql type="mysql"><![CDATA[select  case when a.status ='9' then '1' else '0' end as  status ,a.transq,a.TRANDT from knl_cnapot a
		where  a.transq =#retraq# ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="retraq" jdbcType="VARCHAR" javaType="BaseType.U_CHAR32" mode="in" longname="原交易流水号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTypGenEAccountInfo.IoCaInfoOut"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="knlIoblCupsVerify" longname="银联cups转账查证">
        <sql type="db2"><![CDATA[select  case when a.transt ='1' then '1' else '0' end as  status ,a.mntrsq,a.TRANDT from knl_iobl_cups a 
where  a.mntrsq =#retraq# ]]></sql>
        <sql type="oracle"><![CDATA[select  case when a.transt ='1' then '1' else '0' end as  status ,a.mntrsq,a.TRANDT from knl_iobl_cups a 
where  a.mntrsq =#retraq# ]]></sql>
        <sql type="mysql"><![CDATA[select  case when a.transt ='1' then '1' else '0' end as  status ,a.mntrsq,a.TRANDT from knl_iobl_cups a 
where  a.mntrsq =#retraq# ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="retraq" jdbcType="VARCHAR" javaType="BaseType.U_CHAR32" mode="in" longname="原交易流水号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTypGenEAccountInfo.IoCaInfoOut"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="knlCaryVerify" longname="电子账户转电子账户查证">
        <sql type="db2"><![CDATA[select  case when a.status ='2' then '1' else '0' end as  status ,a.transq,a.TRANDT from knl_cary a where  a.transq=#retraq# ]]></sql>
        <sql type="oracle"><![CDATA[select  case when a.status ='2' then '1' else '0' end as  status ,a.transq,a.TRANDT from knl_cary a where  a.transq=#retraq# ]]></sql>
        <sql type="mysql"><![CDATA[select  case when a.status ='2' then '1' else '0' end as  status ,a.transq,a.TRANDT from knl_cary a where  a.transq=#retraq# ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="retraq" jdbcType="VARCHAR" javaType="BaseType.U_CHAR32" mode="in" longname="原交易流水号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTypGenEAccountInfo.IoCaInfoOut"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="kcbChrgRgstVerify" longname="收费查证">
        <sql type="db2"><![CDATA[select '1' status, a.trnseq, a.trandt from kcb_chrg_rgst a 
where  a.TRNSEQ =#retraq#]]></sql>
        <sql type="oracle"><![CDATA[select '1' status, a.trnseq, a.trandt from kcb_chrg_rgst a 
where  a.TRNSEQ =#retraq#]]></sql>
        <sql type="mysql"><![CDATA[select '1' status, a.trnseq, a.trandt from kcb_chrg_rgst a 
where  a.TRNSEQ =#retraq#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="retraq" jdbcType="VARCHAR" javaType="BaseType.U_CHAR32" mode="in" longname="原交易流水号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTypGenEAccountInfo.IoCaInfoOut"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnaAcdcByCard" longname="根据电子账号查询卡客户账户对照表">
        <sql type="db2"><![CDATA[select * from  kna_acdc  where CARDNO = #cardno# ]]></sql>
        <sql type="mysql"><![CDATA[select * from  kna_acdc  where CARDNO = #cardno# ]]></sql>
        <sql type="oracle"><![CDATA[select * from  kna_acdc  where CARDNO = #cardno# ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="cardno" ref="BaseDict.Comm.cardno" jdbcType="VARCHAR" javaType="BaseType.U_CARDNO" mode="in" longname="交易卡号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTable.IoCaKnaAcdc"/>
    </select>
    <select cache="none" method="selectFirst" type="sql" id="selKnaAcdcByAcStutas" longname="根据状态账号查询最新一条卡客户账号对照表记录">
        <sql><![CDATA[select a.* from kna_acdc a where a.custac=#custac# and a.status = #status# order by tmstmp desc]]></sql>
        <sql type="oracle"><![CDATA[select a.* from kna_acdc a where a.custac=#custac# and a.status = #status# order by tmstmp desc]]></sql>
        <sql type="mysql"><![CDATA[select a.* from kna_acdc a where a.custac=#custac# and a.status = #status# order by tmstmp desc]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" ref="CaDict.Eacct.custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="status" jdbcType="VARCHAR" javaType="BaseEnumType.E_DPACST" mode="in" longname="状态" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KnaAcdc"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selGlKnsGlvcByTransq" longname="查询内部户交易记录是否存在">
        <sql><![CDATA[select count(0) from gl_kns_glvc where transq = #transq# ]]></sql>
        <sql type="oracle"><![CDATA[select count(0) from gl_kns_glvc where transq = #transq# ]]></sql>
        <sql type="mysql"><![CDATA[select count(0) from gl_kns_glvc where transq = #transq# ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="transq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" parameterType="condition"/>
        </parameterMap>
        <resultMap class="long"/>
    </select>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selAcctno" longname="查询电子账号关联负债账号">
        <parameterMap class="java.util.Map">
            <parameter property="cardno" jdbcType="VARCHAR" javaType="BaseType.U_CARDNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="存款子账号" parameterType="condition"/>
            <parameter property="prodcd" jdbcType="VARCHAR" javaType="BaseType.U_PRODCD" mode="in" longname="产品编号" parameterType="condition"/>
            <parameter property="pddpfg" jdbcType="VARCHAR" javaType="DpEnumType.E_FCFLAG" mode="in" longname="定活期标识" parameterType="condition"/>
            <parameter property="sprdid" jdbcType="VARCHAR" javaType="BaseType.U_CHAR20" mode="in" longname="可售产品ID" parameterType="condition"/>
            <parameter property="sprdna" jdbcType="VARCHAR" javaType="BaseType.U_CHAR80" mode="in" longname="可售产品名称" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTable.IoCaSelAcctno"/>
        <dynamicSql type="db2">
            <str type="Str"><![CDATA[select info.* from (]]></str>
            <str type="Str"><![CDATA[select b.acctno,b.pddpfg faflag,b.crcycd,b.prodcd,b.brchno,b.bgindt,b.opendt matudt,b.depttm,b.onlnbl,b.deptdy from kna_acdc a, kna_acct b, kna_acct_prod d]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[a.cardno=#cardno#]]></str>
                    <str type="Str"><![CDATA[a.custac = b.custac]]></str>
                    <str type="Str"><![CDATA[b.acctno = d.acctno]]></str>
                    <str type="Str"><![CDATA[b.acctst<>'2']]></str>
                    <str type="Str"><![CDATA[b.acsetp in ('04','05','07')]]></str>
                    <if test="acctno!=null &amp;&amp; acctno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[b.acctno=#acctno#]]></str>
                    </if>
                    <if test="prodcd!=null &amp;&amp; prodcd!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[b.prodcd=#prodcd#]]></str>
                    </if>
                    <if test="sprdid!=null &amp;&amp; sprdid!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[d.sprdid=#sprdid#]]></str>
                    </if>
                    <if test="sprdna!=null &amp;&amp; sprdna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[d.obgaon=#sprdna#]]></str>
                    </if>
                    <if test="pddpfg!=null" type="If">
                        <str type="Str"><![CDATA[b.pddpfg=#pddpfg#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[union all]]></str>
            <str type="Str"><![CDATA[select c.acctno,c.pddpfg faflag,c.crcycd,c.prodcd,c.brchno,c.bgindt,c.matudt,c.depttm,c.onlnbl,c.deptdy from kna_acdc a, kna_fxac c, kna_fxac_prod e]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[a.cardno=#cardno#]]></str>
                    <str type="Str"><![CDATA[a.custac = c.custac]]></str>
                    <str type="Str"><![CDATA[c.acctno = e.acctno]]></str>
                    <str type="Str"><![CDATA[c.acctst<>'2']]></str>
                    <str type="Str"><![CDATA[c.acsetp in ('04','05','07')]]></str>
                    <if test="acctno!=null &amp;&amp; acctno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[c.acctno=#acctno#]]></str>
                    </if>
                    <if test="prodcd!=null &amp;&amp; prodcd!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[c.prodcd=#prodcd#]]></str>
                    </if>
                    <if test="sprdid!=null &amp;&amp; sprdid!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[e.sprdid=#sprdid#]]></str>
                    </if>
                    <if test="sprdna!=null &amp;&amp; sprdna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[e.obgaon=#sprdna#]]></str>
                    </if>
                    <if test="pddpfg!=null" type="If">
                        <str type="Str"><![CDATA[c.pddpfg=#pddpfg#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[)info]]></str>
            <str type="Str"><![CDATA[order by info.matudt desc]]></str>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[select info.* from (]]></str>
            <str type="Str"><![CDATA[select b.acctno,b.pddpfg faflag,b.crcycd,b.prodcd,b.brchno,b.bgindt,b.opendt matudt,b.depttm,b.onlnbl,b.deptdy from kna_acdc a, kna_acct b, kna_acct_prod d]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[a.cardno=#cardno#]]></str>
                    <str type="Str"><![CDATA[a.custac = b.custac]]></str>
                    <str type="Str"><![CDATA[b.acctno = d.acctno]]></str>
                    <str type="Str"><![CDATA[b.acctst<>'2']]></str>
                    <str type="Str"><![CDATA[b.acsetp in ('04','05','07')]]></str>
                    <if test="acctno!=null &amp;&amp; acctno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[b.acctno=#acctno#]]></str>
                    </if>
                    <if test="prodcd!=null &amp;&amp; prodcd!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[b.prodcd=#prodcd#]]></str>
                    </if>
                    <if test="sprdid!=null &amp;&amp; sprdid!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[d.sprdid=#sprdid#]]></str>
                    </if>
                    <if test="sprdna!=null &amp;&amp; sprdna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[d.obgaon=#sprdna#]]></str>
                    </if>
                    <if test="pddpfg!=null" type="If">
                        <str type="Str"><![CDATA[b.pddpfg=#pddpfg#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[union all]]></str>
            <str type="Str"><![CDATA[select c.acctno,c.pddpfg faflag,c.crcycd,c.prodcd,c.brchno,c.bgindt,c.matudt,c.depttm,c.onlnbl,c.deptdy from kna_acdc a, kna_fxac c, kna_fxac_prod e]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[a.cardno=#cardno#]]></str>
                    <str type="Str"><![CDATA[a.custac = c.custac]]></str>
                    <str type="Str"><![CDATA[c.acctno = e.acctno]]></str>
                    <str type="Str"><![CDATA[c.acctst<>'2']]></str>
                    <str type="Str"><![CDATA[c.acsetp in ('04','05','07')]]></str>
                    <if test="acctno!=null &amp;&amp; acctno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[c.acctno=#acctno#]]></str>
                    </if>
                    <if test="prodcd!=null &amp;&amp; prodcd!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[c.prodcd=#prodcd#]]></str>
                    </if>
                    <if test="sprdid!=null &amp;&amp; sprdid!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[e.sprdid=#sprdid#]]></str>
                    </if>
                    <if test="sprdna!=null &amp;&amp; sprdna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[e.obgaon=#sprdna#]]></str>
                    </if>
                    <if test="pddpfg!=null" type="If">
                        <str type="Str"><![CDATA[c.pddpfg=#pddpfg#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[)info]]></str>
            <str type="Str"><![CDATA[order by info.matudt desc]]></str>
        </dynamicSql>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select info.* from (]]></str>
            <str type="Str"><![CDATA[select b.acctno,b.pddpfg faflag,b.crcycd,b.prodcd,b.brchno,b.bgindt,b.opendt matudt,b.depttm,b.onlnbl,b.deptdy from kna_acdc a, kna_acct b, kna_acct_prod d]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[a.cardno=#cardno#]]></str>
                    <str type="Str"><![CDATA[a.custac = b.custac]]></str>
                    <str type="Str"><![CDATA[b.acctno = d.acctno]]></str>
                    <str type="Str"><![CDATA[b.acctst<>'2']]></str>
                    <str type="Str"><![CDATA[b.acsetp in ('04','05','07')]]></str>
                    <if test="acctno!=null &amp;&amp; acctno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[b.acctno=#acctno#]]></str>
                    </if>
                    <if test="prodcd!=null &amp;&amp; prodcd!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[b.prodcd=#prodcd#]]></str>
                    </if>
                    <if test="sprdid!=null &amp;&amp; sprdid!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[d.sprdid=#sprdid#]]></str>
                    </if>
                    <if test="sprdna!=null &amp;&amp; sprdna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[d.obgaon=#sprdna#]]></str>
                    </if>
                    <if test="pddpfg!=null" type="If">
                        <str type="Str"><![CDATA[b.pddpfg=#pddpfg#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[union all]]></str>
            <str type="Str"><![CDATA[select c.acctno,c.pddpfg faflag,c.crcycd,c.prodcd,c.brchno,c.bgindt,c.matudt,c.depttm,c.onlnbl,c.deptdy from kna_acdc a, kna_fxac c, kna_fxac_prod e]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[a.cardno=#cardno#]]></str>
                    <str type="Str"><![CDATA[a.custac = c.custac]]></str>
                    <str type="Str"><![CDATA[c.acctno = e.acctno]]></str>
                    <str type="Str"><![CDATA[c.acctst<>'2']]></str>
                    <str type="Str"><![CDATA[c.acsetp in ('04','05','07')]]></str>
                    <if test="acctno!=null &amp;&amp; acctno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[c.acctno=#acctno#]]></str>
                    </if>
                    <if test="prodcd!=null &amp;&amp; prodcd!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[c.prodcd=#prodcd#]]></str>
                    </if>
                    <if test="sprdid!=null &amp;&amp; sprdid!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[e.sprdid=#sprdid#]]></str>
                    </if>
                    <if test="sprdna!=null &amp;&amp; sprdna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[e.obgaon=#sprdna#]]></str>
                    </if>
                    <if test="pddpfg!=null" type="If">
                        <str type="Str"><![CDATA[c.pddpfg=#pddpfg#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[)info]]></str>
            <str type="Str"><![CDATA[order by info.matudt desc]]></str>
        </dynamicSql>
    </dynamicSelect>
    <select cache="none" method="selectAll" type="sql" id="selCurrentPdtlListByCustac" longname="查询活期存款产品类型列表">
        <sql type="db2"><![CDATA[
    	select
    	    	a.prodna,a.prodtp,sum(a.onlnbl) onlnbl 
    	from
    	    	( select
    	    	    	case when acsetp = '01' then '普通活期' else '智能活期' end prodna,case when acsetp = '01' then '111' else '112' end prodtp, onlnbl 
    	    	from
    	    	    	kna_acct 
    	    	where
    	    	    	acsetp in (
    	    	    	    	'01','04'
    	    	    	) and custac = #custac# 
    	    	    	and crcycd = #crcycd# and acctst <> '2') a 
    	group by
    	    	a.prodna,
    	    	a.prodtp 
    	]]></sql>
        <sql type="oracle"><![CDATA[
    	select
    	    	a.prodna,a.prodtp,sum(a.onlnbl) onlnbl 
    	from
    	    	( select
    	    	    	case when acsetp = '01' then '普通活期' else '智能活期' end prodna,case when acsetp = '01' then '111' else '112' end prodtp, onlnbl 
    	    	from
    	    	    	kna_acct 
    	    	where
    	    	    	acsetp in (
    	    	    	    	'01','04'
    	    	    	) and custac = #custac# 
    	    	    	and crcycd = #crcycd# and acctst <> '2') a 
    	group by
    	    	a.prodna,
    	    	a.prodtp 
    	]]></sql>
        <sql type="mysql"><![CDATA[
    	select
    	    	a.prodna,a.prodtp,sum(a.onlnbl) onlnbl 
    	from
    	    	( select
    	    	    	case when acsetp = '01' then '普通活期' else '智能活期' end prodna,case when acsetp = '01' then '111' else '112' end prodtp, onlnbl 
    	    	from
    	    	    	kna_acct 
    	    	where
    	    	    	acsetp in (
    	    	    	    	'01','04'
    	    	    	) and custac = #custac# 
    	    	    	and crcycd = #crcycd# and acctst <> '2') a 
    	group by
    	    	a.prodna,
    	    	a.prodtp 
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" ref="CaDict.Eacct.custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="crcycd" ref="BaseDict.Comm.crcycd" jdbcType="VARCHAR" javaType="BaseType.U_CRCYCD" mode="in" longname="币种" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTypGenEAccountInfo.IoCaProdInfo"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selFxacPdtlListByCustac" longname="查询定期存款产品类型列表">
        <sql type="db2"><![CDATA[
    	select
    	    	a.prodna,sum(a.onlnbl) onlnbl 
    	from
    	    	( select
    	    	    	case when acsetp = '07' then '普通定期' else '智能定期' end prodna, onlnbl 
    	    	from
    	    	    	kna_fxac 
    	    	where
    	    	    	acsetp in (
    	    	    	    	'05','07'
    	    	    	) and custac = #custac# 
    	    	    	and crcycd = #crcycd# and acctst <> '2') a 
    	group by
    	    	prodna
    	]]></sql>
        <sql type="oracle"><![CDATA[
    	select
    	    	a.prodna,sum(a.onlnbl) onlnbl 
    	from
    	    	( select
    	    	    	case when acsetp = '07' then '普通定期' else '智能定期' end prodna, onlnbl 
    	    	from
    	    	    	kna_fxac 
    	    	where
    	    	    	acsetp in (
    	    	    	    	'05','07'
    	    	    	) and custac = #custac# 
    	    	    	and crcycd = #crcycd# and acctst <> '2') a 
    	group by
    	    	prodna
    	]]></sql>
        <sql type="mysql"><![CDATA[
    	select
    	    	a.prodna,sum(a.onlnbl) onlnbl 
    	from
    	    	( select
    	    	    	case when acsetp = '07' then '普通定期' else '智能定期' end prodna, onlnbl 
    	    	from
    	    	    	kna_fxac 
    	    	where
    	    	    	acsetp in (
    	    	    	    	'05','07'
    	    	    	) and custac = #custac# 
    	    	    	and crcycd = #crcycd# and acctst <> '2') a 
    	group by
    	    	prodna
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" ref="CaDict.Eacct.custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="crcycd" ref="BaseDict.Comm.crcycd" jdbcType="VARCHAR" javaType="BaseType.U_CRCYCD" mode="in" longname="币种" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTypGenEAccountInfo.IoCaProdInfo"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selFinaPdtlListByCustac" longname="查询理财资产产品类型列表">
        <sql type="db2"><![CDATA[
    	select
    	    	prodna,nowtam 
    	from
    	    	fna_acct 
    	where
    	    	custac = #custac# and crcycd = #crcycd# 
    	    	and acctst = '1'
    	]]></sql>
        <sql type="oracle"><![CDATA[
    	select
    	    	prodna,nowtam 
    	from
    	    	fna_acct 
    	where
    	    	custac = #custac# and crcycd = #crcycd# 
    	    	and acctst = '1'
    	]]></sql>
        <sql type="mysql"><![CDATA[
    	select
    	    	prodna,nowtam 
    	from
    	    	fna_acct 
    	where
    	    	custac = #custac# and crcycd = #crcycd# 
    	    	and acctst = '1'
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" ref="CaDict.Eacct.custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="crcycd" ref="BaseDict.Comm.crcycd" jdbcType="VARCHAR" javaType="BaseType.U_CRCYCD" mode="in" longname="币种" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTypGenEAccountInfo.IoCaProdInfo"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selIdtpnoBycardno" longname="根据客户号查询证件类型和证件号码">
        <sql type="db2"><![CDATA[select a.* from cif_cust a where custno = 
(select custno from kna_cust where custac =
 (select custac from kna_acdc  where cardno = #cardno#))]]></sql>
        <sql type="oracle"><![CDATA[select a.* from cif_cust a where custno = 
(select custno from kna_cust where custac =
 (select custac from kna_acdc  where cardno = #cardno#))]]></sql>
        <sql type="mysql"><![CDATA[select a.* from cif_cust a where custno = 
(select custno from kna_cust where custac =
 (select custac from kna_acdc  where cardno = #cardno#))]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="cardno" jdbcType="VARCHAR" javaType="BaseType.U_CARDNO" mode="in" longname="卡号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCuTable.IoCucifCust"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnaAccsByAcctno" longname="根据负债账号查询负债账号客户账号">
        <sql type="db2"><![CDATA[select a.* from kna_accs a where a.acctno = #acctno#]]></sql>
        <sql type="oracle"><![CDATA[select a.* from kna_accs a where a.acctno = #acctno#]]></sql>
        <sql type="mysql"><![CDATA[select a.* from kna_accs a where a.acctno = #acctno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" ref="DpDict.Acct.acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="负债账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTable.IoCaKnaAccs"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selCustInfoByCustid" longname="根据用户ID查询电子账户信息">
        <sql type="db2"><![CDATA[select cust.* from kna_cust cust
left join cif_cust_accs accs on(accs.custno = cust.custno)
where accs.custcd = #custcd# and cust.acctst<>'2' and accs.status <>'2'
]]></sql>
        <sql type="oracle"><![CDATA[select cust.* from kna_cust cust
left join cif_cust_accs accs on(accs.custno = cust.custno)
where accs.custcd = #custcd# and cust.acctst<>'2' and accs.status <>'2'
]]></sql>
        <sql type="mysql"><![CDATA[select cust.* from kna_cust cust
left join cif_cust_accs accs on(accs.custno = cust.custno)
where accs.custcd = #custcd# and cust.acctst<>'2' and accs.status <>'2'
]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custcd" ref="BaseDict.Comm.custcd" jdbcType="VARCHAR" javaType="BaseType.U_CHAR20" mode="in" longname="客户内码" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KnaCust"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnbOpbtByCuacst" longname="根据电子账号查询批量开户登记簿">
        <sql type="db2"><![CDATA[select * from knb_opbt where custac = #custac#]]></sql>
        <sql type="oracle"><![CDATA[select * from knb_opbt where custac = #custac#]]></sql>
        <sql type="mysql"><![CDATA[select * from knb_opbt where custac = #custac#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" ref="CaDict.Eacct.custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KnbOpbt"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnaCuadByCustac" longname="根据电子账号查询电子账户信息附加表">
        <sql type="db2"><![CDATA[select count(*) from kna_cuad where custac = #custac#]]></sql>
        <sql type="oracle"><![CDATA[select * from kna_cuad where custac = #custac#]]></sql>
        <sql type="mysql"><![CDATA[select * from kna_cuad where custac = #custac#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" ref="BaseDict.Comm.custac" jdbcType="VARCHAR" javaType="BaseType.U_CHAR32" mode="in" longname="客户账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KnaCuad"/>
    </select>
    <update method="update" id="updKnaAcalStatusByCustac" longname="根据电子账号更新账户别名状态">
        <sql type="db2"><![CDATA[update kna_acal a set a.ACALST = #acalst# ,a.a.tmstmp=#tmstmp# where a.custac = #custac# and a.corpno=#corpno#]]></sql>
        <sql type="oracle"><![CDATA[update kna_acal a set a.ACALST = #acalst# ,a.a.tmstmp=#tmstmp# where a.custac = #custac# and a.corpno=#corpno#]]></sql>
        <sql type="mysql"><![CDATA[update kna_acal a set a.ACALST = #acalst# ,a.a.tmstmp=#tmstmp# where a.custac = #custac# and a.corpno=#corpno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acalst" ref="CaDict.Eacct.acalst" jdbcType="VARCHAR" javaType="CaEnumType.E_ACALST" mode="in" longname="关联状态" parameterType="condition"/>
            <parameter property="custac" ref="CaDict.Eacct.custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="tmstmp" ref="ApDict.Aplt.tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
            <parameter property="corpno" ref="BaseDict.Comm.corpno" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
        </parameterMap>
    </update>
    <update method="update" id="updCifCustAccsStatusByCustac" longname="根据电子账号更新客户信息关联状态">
        <sql type="db2"><![CDATA[update cif_cust_accs a set a.status = #status#
		where a.custno = #custno#
		and a.status = '1']]></sql>
        <sql type="oracle"><![CDATA[update cif_cust_accs a set a.status = #status#
		where a.custno = #custno#
		and a.status = '1']]></sql>
        <sql type="mysql"><![CDATA[update cif_cust_accs a set a.status = #status#
		where a.custno = #custno#
		and a.status = '1']]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="status" jdbcType="VARCHAR" javaType="BaseEnumType.E_STATUS" mode="in" longname="关联状态" parameterType="condition"/>
            <parameter property="custno" ref="BaseDict.Comm.custno" jdbcType="VARCHAR" javaType="BaseType.U_CUSTNO" mode="in" longname="客户号" parameterType="condition"/>
        </parameterMap>
    </update>
    <select cache="none" method="selectAll" type="sql" id="selCustAllInfoByCustid" longname="根据用户ID查询电子账户全部信息">
        <sql type="db2"><![CDATA[select cust.* from kna_cust cust
left join cif_cust_accs accs on(accs.custno = cust.custno)
where accs.custid = #custid#
]]></sql>
        <sql type="oracle"><![CDATA[select cust.* from kna_cust cust
left join cif_cust_accs accs on(accs.custno = cust.custno)
where accs.custid = #custid#
]]></sql>
        <sql type="mysql"><![CDATA[select cust.* from kna_cust cust
left join cif_cust_accs accs on(accs.custno = cust.custno)
where accs.custid = #custid#
]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custid" ref="BaseDict.Comm.custid" jdbcType="VARCHAR" javaType="BaseType.U_CUSTID" mode="in" longname="用户ID" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KnaCust"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selKnaAcalInfoByAcalno" longname="根据手机号查询账户信息别名表信息">
        <sql type="db2"><![CDATA[select * from kna_acal where acalno = #acalno# and acaltp = #acaltp#]]></sql>
        <sql type="oracle"><![CDATA[select * from kna_acal where acalno = #acalno# and acaltp = #acaltp#]]></sql>
        <sql type="mysql"><![CDATA[select * from kna_acal where acalno = #acalno# and acaltp = #acaltp#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acalno" ref="CaDict.Eacct.acalno" jdbcType="VARCHAR" javaType="BaseType.U_CHAR30" mode="in" longname="账户别名" parameterType="condition"/>
            <parameter property="acaltp" ref="CaDict.Eacct.acaltp" jdbcType="VARCHAR" javaType="CaEnumType.E_ACALTP" mode="in" longname="账户别名类型" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KnaAcal"/>
    </select>
    <select cache="none" method="selectFirst" type="sql" id="selKappJioybwByMtrasq" longname="查询交易报文表流水状态">
        <sql type="db2"><![CDATA[select  case when a.errocd ='00000000' then '1' else '0' end as  status ,a.mtrasq,a.TRANDT from kapp_jioybw a where  a.mtrasq =#retraq# and a.errocd ='00000000' ]]></sql>
        <sql type="oracle"><![CDATA[select  case when a.errocd ='00000000' then '1' else '0' end as  status ,a.mtrasq,a.TRANDT from kapp_jioybw a where  a.mtrasq =#retraq# and a.errocd ='00000000' ]]></sql>
        <sql type="mysql"><![CDATA[select  case when a.errocd ='00000000' then '1' else '0' end as  status ,a.mtrasq,a.TRANDT from kapp_jioybw a where  a.mtrasq =#retraq# and a.errocd ='00000000' ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="retraq" jdbcType="VARCHAR" javaType="BaseType.U_CHAR32" mode="in" longname="原交易流水号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTypGenEAccountInfo.IoCaInfoOut"/>
    </select>
    <update method="update" id="updCifCustAccsByCustno" longname="根据客户号更新app推送ID">
        <sql type="db2"><![CDATA[update cif_cust_accs set appsid = #appsid# where custno = #custno# and status=#status#]]></sql>
        <sql type="oracle"><![CDATA[update cif_cust_accs set appsid = #appsid# where custno = #custno# and status=#status#]]></sql>
        <sql type="mysql"><![CDATA[update cif_cust_accs set appsid = #appsid# where custno = #custno# and status=#status#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="appsid" jdbcType="VARCHAR" javaType="BaseType.U_CHAR32" mode="in" longname="app推送ID" parameterType="condition"/>
            <parameter property="custno" ref="BaseDict.Comm.custno" jdbcType="VARCHAR" javaType="BaseType.U_CUSTNO" mode="in" longname="客户号" parameterType="condition"/>
            <parameter property="status" jdbcType="VARCHAR" javaType="BaseEnumType.E_STATUS" mode="in" longname="状态" parameterType="condition"/>
        </parameterMap>
    </update>
    <select cache="none" method="selectOne" type="sql" id="selKnareltiInfos" longname="检查未关闭亲情钱包关系">
        <sql type="db2"><![CDATA[select count(1) from kna_relt a where a.elacct = #custno# and a.reltst <> '2']]></sql>
        <sql type="oracle"><![CDATA[select count(1) from kna_relt a where a.elacct = #custno# and a.reltst <> '2']]></sql>
        <sql type="mysql"><![CDATA[select count(1) from kna_relt a where a.elacct = #custno# and a.reltst <> '2']]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custno" ref="BaseDict.Comm.custno" jdbcType="VARCHAR" javaType="BaseType.U_CUSTNO" mode="in" longname="客户号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="int"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selknacustbyaccst" longname="查询某状态下的电子账户信息">
        <sql type="db2"><![CDATA[select a.* from kna_cust a where a.acctst = #acctst# and a.corpno=#corpno#]]></sql>
        <sql type="oracle"><![CDATA[select a.* from kna_cust a where a.acctst = #acctst# and a.corpno=#corpno#]]></sql>
        <sql type="mysql"><![CDATA[select a.* from kna_cust a where a.acctst = #acctst# and a.corpno=#corpno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctst" jdbcType="VARCHAR" javaType="BaseEnumType.E_ACCTST" mode="in" longname="账户状态" parameterType="condition"/>
            <parameter property="corpno" ref="BaseDict.Comm.corpno" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KnaCust"/>
    </select>
    <update method="update" id="updateknbclacstatu" longname="更新销户登记簿中状态">
        <sql type="db2"><![CDATA[update knb_clac set status = #status# ,tmstmp=#tmstmp#,closdt = #closdt# where custac = #custac# and status = #clstat#]]></sql>
        <sql type="oracle"><![CDATA[update knb_clac set status = #status# ,tmstmp=#tmstmp#,closdt = #closdt# where custac = #custac# and status = #clstat#]]></sql>
        <sql type="mysql"><![CDATA[update knb_clac set status = #status# ,tmstmp=#tmstmp#,closdt = #closdt# where custac = #custac# and status = #clstat#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="status" jdbcType="VARCHAR" javaType="DpEnumType.E_CLSTAT" mode="in" longname="销户状态" parameterType="condition"/>
            <parameter property="tmstmp" ref="ApDict.Aplt.tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
            <parameter property="closdt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="销户日期" parameterType="condition"/>
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUSTAC" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="clstat" jdbcType="VARCHAR" javaType="DpEnumType.E_CLSTAT" mode="in" longname="原销户状态" parameterType="condition"/>
        </parameterMap>
    </update>
    <select cache="none" method="selectOne" type="sql" id="selknaAcctOnbill" longname="查询电子账户余额">
        <sql type="db2"><![CDATA[select sum(onlnbl) from kna_acct where custac = #custac# and acctst = '1']]></sql>
        <sql type="oracle"><![CDATA[select sum(onlnbl) from kna_acct where custac = #custac# and acctst = '1']]></sql>
        <sql type="mysql"><![CDATA[select sum(onlnbl) from kna_acct where custac = #custac# and acctst = '1']]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUSTAC" mode="in" longname="电子账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.math.BigDecimal"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selTransResultByIobl" longname="交易是否成功查证出入金查询">
        <sql type="db2"><![CDATA[select  case when a.status ='2' then '1' else '0' end as  status ,a.transq,a.TRANDT from knl_iobl  a where  a.transq =#mtrasq# ]]></sql>
        <sql type="oracle"><![CDATA[select  case when a.status ='2' then '1' else '0' end as  status ,a.transq,a.TRANDT from knl_iobl  a where  a.transq =#mtrasq# ]]></sql>
        <sql type="mysql"><![CDATA[select  case when a.status ='2' then '1' else '0' end as  status ,a.transq,a.TRANDT from knl_iobl  a where  a.transq =#mtrasq# ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="mtrasq" jdbcType="VARCHAR" javaType="PbBaseType.U_TRNSEQ" mode="in" longname="原交易流水" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTypGenEAccountInfo.IoCaInfoOut"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selknacustbyopendt" longname="根据开户日期查询电子账户信息">
        <sql type="db2"><![CDATA[select a.* from kna_cust a where a.opendt = #opendt# and a.corpno=#corpno#]]></sql>
        <sql type="oracle"><![CDATA[select a.* from kna_cust a where a.opendt = #opendt# and a.corpno=#corpno#]]></sql>
        <sql type="mysql"><![CDATA[select a.* from kna_cust a where a.opendt = #opendt# and a.corpno=#corpno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="opendt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="开户日期" parameterType="condition"/>
            <parameter property="corpno" ref="BaseDict.Comm.corpno" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KnaCust"/>
    </select>
    <select cache="none" method="selectFirst" type="sql" id="selknlbillbycustac" longname="根据电子账号查询账单表">
        <sql type="db2"><![CDATA[select a.* from knl_bill a where a.custac = #custac#]]></sql>
        <sql type="oracle"><![CDATA[select a.* from knl_bill a where a.custac = #custac#]]></sql>
        <sql type="mysql"><![CDATA[select a.* from knl_bill a where a.custac = #custac#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUSTAC" mode="in" longname="电子账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoDpTable.IoDpKnlBill"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selKnaCustAllbyCustno" longname="根据客户号查询已开户一类户数量">
        <sql type="db2"><![CDATA[select * from kna_cust where custno = #custno# and acctst <> '2' and brchno = #brchno#]]></sql>
        <sql type="oracle"><![CDATA[select * from kna_cust where custno = #custno# and acctst <> '2' and brchno = #brchno#]]></sql>
        <sql type="mysql"><![CDATA[select * from kna_cust where custno = #custno# and acctst <> '2' and brchno = #brchno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custno" jdbcType="VARCHAR" javaType="BaseType.U_CUSTNO" mode="in" longname="客户号" parameterType="condition"/>
            <parameter property="brchno" ref="DpDict.Acct.brchno" jdbcType="VARCHAR" javaType="BaseType.U_BRCHNO" mode="in" longname="账户所属机构" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KnaCust"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnbClacByClossq" longname="根据销户流水查询销户登记簿记录">
        <sql type="db2"><![CDATA[select a.* from knb_clac a where a.CLOSSQ=#clossq# ]]></sql>
        <sql type="oracle"><![CDATA[select a.* from knb_clac a where a.CLOSSQ=#clossq# ]]></sql>
        <sql type="mysql"><![CDATA[select a.* from knb_clac a where a.CLOSSQ=#clossq# ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="clossq" ref="DpDict.Acct.clossq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="销户流水" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KnbClac"/>
    </select>
    <update method="update" id="updKnbProm" longname="升级成功更新升级登记簿信息">
        <sql type="db2"><![CDATA[update knb_prom set idckrt = #idckrt#,mpckrt = #mpckrt#,promst = #promst#,promdt = #promdt#,transq = #transq#, tmstmp=#tmstmp# where custac = #custac# and promst = #promst1#]]></sql>
        <sql type="oracle"><![CDATA[update knb_prom set idckrt = #idckrt#,mpckrt = #mpckrt#,promst = #promst#,promdt = #promdt#,transq = #transq#, tmstmp=#tmstmp# where custac = #custac# and promst = #promst1#]]></sql>
        <sql type="mysql"><![CDATA[update knb_prom set idckrt = #idckrt#,mpckrt = #mpckrt#,promst = #promst#,promdt = #promdt#,transq = #transq#, tmstmp=#tmstmp# where custac = #custac# and promst = #promst1#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="idckrt" ref="CaDict.Eacct.idckrt" jdbcType="VARCHAR" javaType="CaEnumType.E_IDCKRT" mode="in" longname="身份核查结果" parameterType="condition"/>
            <parameter property="mpckrt" ref="CaDict.Eacct.mpckrt" jdbcType="VARCHAR" javaType="CaEnumType.E_MPCKRT" mode="in" longname="人脸识别结果" parameterType="condition"/>
            <parameter property="promst" ref="CaDict.Eacct.promst" jdbcType="VARCHAR" javaType="CaEnumType.E_PROMST" mode="in" longname="升级状态" parameterType="condition"/>
            <parameter property="promdt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" parameterType="condition"/>
            <parameter property="transq" ref="BaseDict.Comm.transq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="交易流水" parameterType="condition"/>
            <parameter property="custac" ref="CaDict.Eacct.custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="promst1" jdbcType="VARCHAR" javaType="CaEnumType.E_PROMST" mode="in" parameterType="condition"/>
            <parameter property="tmstmp" ref="ApDict.Aplt.tmstmp" jdbcType="VARCHAR" javaType="ApBaseType.U_TMSTMP" mode="in" longname="时间戳" parameterType="condition"/>
        </parameterMap>
    </update>
    <select cache="none" method="selectAll" type="sql" id="selKnbclacByCus" longname="查询销户登记簿">
        <sql type="db2"><![CDATA[select * from knb_clac where custac = #custac# order by tmstmp desc]]></sql>
        <sql type="oracle"><![CDATA[select * from knb_clac where custac = #custac# order by tmstmp desc]]></sql>
        <sql type="mysql"><![CDATA[select * from knb_clac where custac = #custac# order by tmstmp desc]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" ref="CaDict.Eacct.custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTable.IoCaKnbClac"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnaCacdByCcs" longname="通过条件查询卡与客户绑定表">
        <sql type="db2"><![CDATA[select a.* from kna_cacd a where a.CUSTAC = #custac# and a.CARDNO = #cardno# and a.STATUS = #status#]]></sql>
        <sql type="oracle"><![CDATA[select a.* from kna_cacd a where a.CUSTAC = #custac# and a.CARDNO = #cardno# and a.STATUS = #status#]]></sql>
        <sql type="mysql"><![CDATA[select a.* from kna_cacd a where a.CUSTAC = #custac# and a.CARDNO = #cardno# and a.STATUS = #status#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="cardno" jdbcType="VARCHAR" javaType="BaseType.U_CARDNO" mode="in" longname="交易卡号" parameterType="condition"/>
            <parameter property="status" jdbcType="VARCHAR" javaType="BaseEnumType.E_DPACST" mode="in" longname="状态" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KnaCacd"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKcdCardByCardno" longname="根据交易卡号查询卡信息表">
        <sql><![CDATA[select * from kcd_card where cardno = #cardno#]]></sql>
        <sql type="oracle"><![CDATA[select * from kcd_card where cardno = #cardno#]]></sql>
        <sql type="mysql"><![CDATA[select * from kcd_card where cardno = #cardno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="cardno" ref="BaseDict.Comm.cardno" jdbcType="VARCHAR" javaType="BaseType.U_CARDNO" mode="in" longname="交易卡号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KcdCard"/>
    </select>
    <select cache="none" method="selectFirst" type="sql" id="selKnsreduTranByInpusqdt" longname="核心交易查证通用接口根据上送系统编号和日期">
        <sql><![CDATA[select r.transq,r.trandt,r.txnsts from kns_redu r where r.inpusq = #inpusq# and r.inpudt = #inpudt#]]></sql>
        <sql type="oracle"><![CDATA[select r.transq,r.trandt,r.txnsts from kns_redu r where r.inpusq = #inpusq# and r.inpudt = #inpudt#]]></sql>
        <sql type="mysql"><![CDATA[select r.transq,r.trandt,r.txnsts from kns_redu r where r.inpusq = #inpusq# and r.inpudt = #inpudt#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="inpusq" ref="BaseDict.Comm.inpusq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="上送系统流水" parameterType="condition"/>
            <parameter property="inpudt" ref="BaseDict.Comm.inpudt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="上送系统日期" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTypGenEAccountInfo.IoCaInfoOut"/>
    </select>
    <select cache="none" method="selectFirst" type="sql" id="selKnsTranreduBytransqdt" longname="核心交易查证通用接口根据核心交易流水和核心交易日期">
        <sql><![CDATA[select r.transq,r.trandt,r.txnsts from kns_redu r where r.transq = #transq# and r.trandt = #trandt#]]></sql>
        <sql type="oracle"><![CDATA[select r.transq,r.trandt,r.txnsts from kns_redu r where r.transq = #transq# and r.trandt = #trandt#]]></sql>
        <sql type="mysql"><![CDATA[select r.transq,r.trandt,r.txnsts from kns_redu r where r.transq = #transq# and r.trandt = #trandt#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="transq" ref="BaseDict.Comm.transq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="交易流水" parameterType="condition"/>
            <parameter property="trandt" ref="BaseDict.Comm.trandt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="交易日期" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTypGenEAccountInfo.IoCaInfoOut"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selCustidByCustac" longname="根据电子账户查询客户ID">
        <sql type="mysql"><![CDATA[select a.custid from cif_cust_accs a , kna_cust b where a.custno = b.custno and b.custac= #custac#]]></sql>
        <sql type="oracle"><![CDATA[select a.custid from cif_cust_accs a , kna_cust b where a.custno = b.custno and b.custac= #custac#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" ref="CaDict.Eacct.custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.lang.String"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selknsacsq" longname="查询会计流水">
        <sql><![CDATA[	select *  from
		(select * from kns_acsq  union select * from h_kns_acsq  ) a 
		where a.acctno=#acctno# and a.mntrsq=#prtrsq#]]></sql>
        <sql type="oracle"><![CDATA[	select *  from
		(select * from kns_acsq  union select * from h_kns_acsq  ) a 
		where a.acctno=#acctno# and a.mntrsq=#prtrsq#]]></sql>
        <sql type="mysql"><![CDATA[	select *  from
		(select * from kns_acsq  union select * from h_kns_acsq  ) a 
		where a.acctno=#acctno# and a.mntrsq=#prtrsq#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="prtrsq" jdbcType="VARCHAR" javaType="string" mode="in" longname="会计流水" parameterType="condition"/>
            <parameter property="acctno" jdbcType="VARCHAR" javaType="string" mode="in" longname="客户账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTable.IoCaHknsAcsq"/>
    </select>
    <select cache="none" method="selectFirst" type="sql" id="selMntrsqByTransq" longname="根据交易流水查询主交易流水">
        <sql><![CDATA[select mntrsq from kns_redu where transq = #transq#]]></sql>
        <sql type="oracle"><![CDATA[select mntrsq from kns_redu where transq = #transq#]]></sql>
        <sql type="mysql"><![CDATA[select mntrsq from kns_redu where transq = #transq#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="transq" jdbcType="VARCHAR" javaType="string" mode="in" longname="交易流水" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.lang.String"/>
    </select>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selCustnaListInfo" longname="根据客户名称查询客户信息">
        <parameterMap class="java.util.Map">
            <parameter property="custna" ref="DpDict.Acct.custna" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNA" mode="in" longname="客户名称" parameterType="condition"/>
        </parameterMap>
        <resultMap class="CaCustInfo.CustNaInfo"/>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[select a.custac,a.custna,a.acctst,a.opendt,b.cardno from kna_cust a left join kna_acdc b on a.custac = b.custac]]></str>
            <where type="Where">
                <if test="custna!=null&amp;&amp;custna!=&quot;&quot;" type="If">
                    <str type="Str"><![CDATA[a.custna like concat('%',#custna#,'%')]]></str>
                </if>
            </where>
        </dynamicSql>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select a.custac,a.custna,a.acctst,a.opendt,b.cardno from kna_cust a left join kna_acdc b on a.custac = b.custac]]></str>
            <where type="Where">
                <if test="custna!=null&amp;&amp;custna!=&quot;&quot;" type="If">
                    <str type="Str"><![CDATA[a.custna like concat('%',#custna#,'%')]]></str>
                </if>
            </where>
        </dynamicSql>
    </dynamicSelect>
    <select cache="none" method="selectAll" type="sql" id="selKnaCustAByCustno" longname="根据客户号查询客户信息">
        <sql type="mysql"><![CDATA[select a.* from kna_cust a where a.custno=#custno#]]></sql>
        <sql type="oracle"><![CDATA[select a.* from kna_cust a where a.custno=#custno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custno" ref="BaseDict.Comm.custno" jdbcType="VARCHAR" javaType="BaseType.U_CUSTNO" mode="in" longname="客户号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTable.IoCaKnaCust"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selkupdppbprotbyprod" longname="根据产品号查询文本协议">
        <sql><![CDATA[select protno,'1' from kup_dppb_prot where prodcd = #prodcd#]]></sql>
        <sql type="oracle"><![CDATA[select protno,'1' from kup_dppb_prot where prodcd = #prodcd#]]></sql>
        <sql type="mysql"><![CDATA[select protno,'1' from kup_dppb_prot where prodcd = #prodcd#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="prodcd" ref="DpDict.Prod.prodcd" jdbcType="VARCHAR" javaType="BaseType.U_PRODCD" mode="in" longname="产品编号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoDpTable.IoDpKupDppbProtn"/>
    </select>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selKnsacsqcoll" longname="查询清算流水状态">
        <parameterMap class="java.util.Map">
            <parameter property="clerdt" ref="BaseDict.Comm.clerdt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="清算日期" parameterType="condition"/>
            <parameter property="status" jdbcType="VARCHAR" javaType="InEnumType.E_CLERST" mode="in" longname="状态" parameterType="condition"/>
        </parameterMap>
        <resultMap class="CustInfoCountType.LituqrTurnoverStatus"/>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select  bathid,clerdt,clenum,trandt,brchno,crcycd,acctno,prodcd,clactp,toacct,dranam,drcunt,cranam,crcunt,status,corest,transq,failrs from kns_acsq_coll]]></str>
            <where type="Where">
                <and type="And">
                    <if test="clerdt!=null &amp;&amp; clerdt!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[clerdt=#clerdt#]]></str>
                    </if>
                    <if test="status!=null" type="If">
                        <str type="Str"><![CDATA[status=#status#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by clerdt desc,status desc]]></str>
        </dynamicSql>
    </dynamicSelect>
    <select cache="none" method="selectOne" type="sql" id="selCountKnaCacd" longname="查询电子账户绑卡数量">
        <sql type="oracle"><![CDATA[select count(*) from kna_cacd a where a.custac = #custac#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CHAR35" mode="in" longname="电子账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="long"/>
    </select>
    <select cache="none" method="selectFirst" type="sql" id="selCifCustByCardInfo" longname="根据电子账号查询客户相关信息">
        <sql><![CDATA[select d.* from cif_cust d where d.custno = ( select c.custno from kna_cust c where c.custac = (select b.custac from Kna_acdc b where b.cardno = #cardno#))]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="cardno" ref="BaseDict.Comm.cardno" jdbcType="VARCHAR" javaType="BaseType.U_CARDNO" mode="in" longname="交易卡号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCuTable.IoCucifCust"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selKnlBillByDate" longname="根据日期查询当天都金额变动的负债子账户">
        <sql type="oracle"><![CDATA[select b.acctno from knl_bill b where b.trandt = #lastdt# group by b.acctno having b.acctno not in (select c.acctno from kna_acct c where c.debttp = '020401' or c.debttp = '020402')
]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="lastdt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="上次交易日期" parameterType="condition"/>
        </parameterMap>
        <resultMap class="DpYhtType.DpAcctno"/>
    </select>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selJfCaList" longname="查询电子主账户列表信息">
        <parameterMap class="java.util.Map">
            <parameter property="cardno" ref="DpDict.Acct.cardno" jdbcType="VARCHAR" javaType="BaseType.U_CARDNO" mode="in" longname="客户账号" parameterType="condition"/>
            <parameter property="idtftp" ref="BaseDict.Comm.idtftp" jdbcType="VARCHAR" javaType="BaseEnumType.E_IDTFTP" mode="in" longname="证件类型" parameterType="condition"/>
            <parameter property="idtfno" ref="BaseDict.Comm.idtfno" jdbcType="VARCHAR" javaType="BaseType.U_IDTFNO" mode="in" longname="证件号" parameterType="condition"/>
            <parameter property="tlphno" ref="DpDict.Acct.tlphno" jdbcType="VARCHAR" javaType="BaseType.U_CHAR50" mode="in" longname="手机号码" parameterType="condition"/>
            <parameter property="custno" ref="DpDict.Acct.custno" jdbcType="VARCHAR" javaType="BaseType.U_CUSTNO" mode="in" longname="客户号" parameterType="condition"/>
            <parameter property="custna" ref="DpDict.Acct.custna" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNA" mode="in" longname="客户名称" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTypGenEAccountInfo.IoCaMainAcctInfo"/>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[SELECT D.CARDNO, A.MACTID,  B.CUSTNO, B.CUSTNA, B.TMCUSTNA, A.USERTP, DECODE(A.USERTP,01,0,02,1,03,2,9) as ACBDTP, A.IDTFTP, A.IDTFNO, A.TMIDTFNO, C.TLPHNO, C.TMTLPHNO, B.ACCTTP, B.ACCTST, B.BRCHNO, B.OPENDT, B.OPENSQ, B.USCHNL, B.CLOSDT, B.CLOSSQ, B.CLOSSV, B.IDCKRT 
FROM KNA_MAAD A LEFT JOIN KNA_CUST B ON A.CUSTAC = B.CUSTAC 
LEFT JOIN KNA_ACAL C ON A.CUSTAC = C.CUSTAC LEFT JOIN 
KNA_ACDC D ON A.CUSTAC = D.CUSTAC]]></str>
            <where type="Where">
                <and type="And">
                    <if test="cardno !=null &amp;&amp; cardno != &quot;&quot;" type="If">
                        <str type="Str"><![CDATA[D.CARDNO = #cardno#]]></str>
                    </if>
                    <if test="idtftp != null " type="If">
                        <str type="Str"><![CDATA[A.IDTFTP = #idtftp#]]></str>
                    </if>
                    <if test="idtfno != null &amp;&amp; idtfno != &quot;&quot;" type="If">
                        <str type="Str"><![CDATA[A.IDTFNO = #idtfno#]]></str>
                    </if>
                    <if test="tlphno!=null&amp;&amp;tlphno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[C.TLPHNO = #tlphno#]]></str>
                    </if>
                    <if test="custno != null &amp;&amp; custno!= &quot;&quot;" type="If">
                        <str type="Str"><![CDATA[A.CUSTNO = #custno#]]></str>
                    </if>
                    <if test="custna != null &amp;&amp; custna != &quot;&quot;" type="If">
                        <str type="Str"><![CDATA[A.CUSTNA = #custna#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
    </dynamicSelect>
    <select cache="none" method="selectPageWithCount" type="sql" id="selBindCardList" longname="查询绑卡列表信息">
        <sql type="oracle"><![CDATA[SELECT a.cardno, a.acctna, a.brchna, a.brchno, a.binddt, a.cardtp, a.bdcatp, a.status, a.dgdsfg
FROM kna_cacd a WHERE a.custac = #custac#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" ref="BaseDict.Comm.custac" jdbcType="VARCHAR" javaType="BaseType.U_CHAR32" mode="in" longname="客户账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KnaCacd"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selBoundCardTotalNo" longname="查询客户对公对私有效绑卡总数">
        <sql type="oracle"><![CDATA[select nvl(count(1), 0) from kna_cacd where acbdno= #acbdno#  and copefg= #copefg# and status in ('1', '4')]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acbdno" ref="DpDict.Acct.acbdno" jdbcType="VARCHAR" javaType="BaseType.U_CHAR40" mode="in" longname="绑定账户账号" parameterType="condition"/>
            <parameter property="copefg" ref="BaseDict.Comm.copefg" jdbcType="VARCHAR" javaType="ApBaseEnumType.E_COPEFG" mode="in" longname="对公对私标志" parameterType="condition"/>
        </parameterMap>
        <resultMap class="long"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selAllCards" longname="查询客户有效绑卡总数">
        <sql type="oracle"><![CDATA[select * from kna_cacd where acbdno = #acbdno#  and status in ('1', '4')]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acbdno" ref="DpDict.Acct.acbdno" jdbcType="VARCHAR" javaType="BaseType.U_CHAR40" mode="in" longname="绑定账户账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ElectronicAccount.KnaCacd"/>
    </select>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selMssTranInfo" longname="查询交易流水相关信息">
        <parameterMap class="java.util.Map">
            <parameter property="trxn_seq" ref="MsDict.Comm.trxn_seq" jdbcType="VARCHAR" javaType="MsType.U_SEQNO" mode="in" longname="transaction sequence" parameterType="condition"/>
            <parameter property="trxn_date" ref="MsDict.Comm.trxn_date" jdbcType="VARCHAR" javaType="MsType.U_DATE" mode="in" longname="transaction date" parameterType="condition"/>
        </parameterMap>
        <resultMap class="MsOnlTable.MssTransaction"/>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select a.* from mss_transaction a]]></str>
            <where type="Where">
                <and type="And">
                    <if test="trxn_seq!=null&amp;&amp;trxn_seq!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trxn_seq = #trxn_seq#]]></str>
                    </if>
                    <if test="trxn_date!=null&amp;&amp;trxn_date!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trxn_date = #trxn_date#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by a.trxn_date desc]]></str>
        </dynamicSql>
    </dynamicSelect>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selBindCardInfoList" longname="根据卡号查询绑卡列表信息">
        <parameterMap class="java.util.Map">
            <parameter property="cardno" jdbcType="VARCHAR" javaType="string" mode="in" parameterType="condition"/>
            <parameter property="teleno" jdbcType="VARCHAR" javaType="string" mode="in" parameterType="condition"/>
            <parameter property="idtfno" jdbcType="VARCHAR" javaType="string" mode="in" parameterType="condition"/>
            <parameter property="acctna" jdbcType="VARCHAR" javaType="string" mode="in" parameterType="condition"/>
            <parameter property="corpno" jdbcType="VARCHAR" javaType="string" mode="in" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTypeGenBindCard.KnaCacdInfo"/>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select * from  kna_cacd]]></str>
            <where type="Where">
                <and type="And">
                    <if test="teleno !=null &amp;&amp; teleno !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[teleno =#teleno#]]></str>
                    </if>
                    <if test="acctna !=null &amp;&amp; acctna !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[acctna =#acctna#]]></str>
                    </if>
                    <if test="cardno !=null &amp;&amp; cardno !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[cardno=#cardno#]]></str>
                    </if>
                    <if test="idtfno !=null &amp;&amp; idtfno !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[idtfno= #idtfno#]]></str>
                    </if>
                    <if test="corpno !=null &amp;&amp; corpno !=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[corpno =#corpno#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
    </dynamicSelect>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="selAllBoundCards" longname="查询客户绑卡列表信息">
        <parameterMap class="java.util.Map">
            <parameter property="idtftp" ref="DpDict.Acct.idtftp" jdbcType="VARCHAR" javaType="BaseEnumType.E_IDTFTP" mode="in" longname="证件类型" parameterType="condition"/>
            <parameter property="idtfno" ref="DpDict.Acct.idtfno" jdbcType="VARCHAR" javaType="BaseType.U_IDTFNO" mode="in" longname="证件号码" parameterType="condition"/>
            <parameter property="cardno" ref="DpDict.Acct.cardno" jdbcType="VARCHAR" javaType="BaseType.U_CARDNO" mode="in" longname="客户账号" parameterType="condition"/>
            <parameter property="cdopac" ref="DpDict.Acct.cdopac" jdbcType="VARCHAR" javaType="BaseType.U_CHAR80" mode="in" longname="结算卡账号" parameterType="condition"/>
            <parameter property="acctna" ref="DpDict.Acct.acctna" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNA" mode="in" longname="子账户名称" parameterType="condition"/>
            <parameter property="tlphno" ref="DpDict.Acct.tlphno" jdbcType="VARCHAR" javaType="BaseType.U_CHAR50" mode="in" longname="手机号码" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTypeGenBindCard.KnaCacdInfo"/>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[SELECT a.cardno, b.acbdno, b.cdopac, b.tmcdopac, b.opbrch, b.acctna as cdopna,b.tmacctna as tmcdopna, b.brchna, b.status, b.binddt, b.cardtp, b.bdcatp, b.copefg, b.idtfna, b.tmidtfna, b.idtftp, b.idtfno, b.bankph as tlphno, b.tmbankph as tmtlphno, b.acbdtp 
FROM  KNA_CACD b left join KNA_ACDC a on a.custac = b.custac ]]></str>
            <where type="Where">
                <and type="And">
                    <if test="cardno!=null&amp;&amp;cardno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.cardno = #cardno# ]]></str>
                    </if>
                    <if test="cdopac!=null&amp;&amp;cdopac!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[b.cdopac = #cdopac#]]></str>
                    </if>
                    <if test="acctna!=null&amp;&amp;acctna!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[b.acctna = #acctna#]]></str>
                    </if>
                    <if test="tlphno!=null&amp;&amp;tlphno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[b.bankph = #tlphno# ]]></str>
                    </if>
                    <if test="idtftp!=null" type="If">
                        <str type="Str"><![CDATA[b.idtftp = #idtftp#]]></str>
                    </if>
                    <if test="idtfno!=null&amp;&amp;idtfno!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[b.idtfno = #idtfno#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
    </dynamicSelect>
    <select cache="none" method="selectOne" type="sql" id="selDeBank" longname="查询默认结算卡">
        <sql><![CDATA[SELECT  b.acbdno, b.cdopac, b.opbrch,  b.brchna, b.status
FROM  KNA_CACD b, kna_sbad s
WHERE b.ACBDNO =  s.ACCTNO AND STATUS = '4' AND  s.ACCTID = #inmeid#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="inmeid" jdbcType="VARCHAR" javaType="string" mode="in" longname="内部商户号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.util.Map"/>
    </select>
</sqls>
